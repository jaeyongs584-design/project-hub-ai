[{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\actions\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":3,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":34,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useMemo"},"fix":{"range":[41,50],"text":""},"desc":"Remove unused variable \"useMemo\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":110,"column":146,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":149,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7200,7203],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7200,7203],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":308,"column":175,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":308,"endColumn":178,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22825,22828],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22825,22828],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":308,"column":274,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":308,"endColumn":277,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22924,22927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22924,22927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useMemo } from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Card } from '@/app/components/ui/Card';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Modal } from '@/app/components/ui/Modal';\r\nimport { Plus, Trash2, Pencil, ChevronRight, CheckSquare, Lightbulb, Calendar, MessageSquare } from 'lucide-react';\r\nimport { generateId, cn } from '@/lib/utils';\r\nimport { ActionItem, ActionStatus, Decision, Meeting, MeetingStatus, Communication, CommType } from '@/types';\r\nimport styles from './page.module.css';\r\n\r\ntype TabType = 'actions' | 'decisions' | 'meetings' | 'communications';\r\n\r\nconst ACTION_STATUS_CYCLE: ActionStatus[] = ['Open', 'In Progress', 'Done', 'Blocked'];\r\nconst MEETING_STATUS_CYCLE: MeetingStatus[] = ['Planned', 'Completed', 'Cancelled'];\r\n\r\nexport default function ActionsPage() {\r\n    const {\r\n        actionItems, decisions, meetings, communications, members,\r\n        addActionItem, updateActionItem, deleteActionItem,\r\n        addDecision, updateDecision, deleteDecision,\r\n        addMeeting, updateMeeting, deleteMeeting,\r\n        addCommunication, updateCommunication, deleteCommunication,\r\n        addActivity,\r\n    } = useProject();\r\n\r\n    const [activeTab, setActiveTab] = useState<TabType>('actions');\r\n\r\n    // ‚îÄ‚îÄ Action Item state ‚îÄ‚îÄ\r\n    const [isActionAddOpen, setIsActionAddOpen] = useState(false);\r\n    const [editAction, setEditAction] = useState<ActionItem | null>(null);\r\n    const [newAction, setNewAction] = useState({ title: '', ownerId: '', dueDate: '', priority: 'Medium' as ActionItem['priority'], sourceType: 'Manual' as ActionItem['sourceType'] });\r\n\r\n    // ‚îÄ‚îÄ Decision state ‚îÄ‚îÄ\r\n    const [isDecisionAddOpen, setIsDecisionAddOpen] = useState(false);\r\n    const [editDecisionItem, setEditDecisionItem] = useState<Decision | null>(null);\r\n    const [newDecision, setNewDecision] = useState({ summary: '', decidedBy: '', impactAreas: [] as Decision['impactAreas'], date: '', sourceLink: '' });\r\n\r\n    // ‚îÄ‚îÄ Meeting state ‚îÄ‚îÄ\r\n    const [isMeetingAddOpen, setIsMeetingAddOpen] = useState(false);\r\n    const [editMeetingItem, setEditMeetingItem] = useState<Meeting | null>(null);\r\n    const [newMeeting, setNewMeeting] = useState({ title: '', meetingDate: '', participants: '', meetingType: 'Internal' as Meeting['meetingType'] });\r\n\r\n    // ‚îÄ‚îÄ Communication state ‚îÄ‚îÄ\r\n    const [isCommAddOpen, setIsCommAddOpen] = useState(false);\r\n    const [editCommItem, setEditCommItem] = useState<Communication | null>(null);\r\n    const [newComm, setNewComm] = useState({ type: 'Email' as CommType, subject: '', date: '', summary: '', linkUrl: '' });\r\n\r\n    const [actionFilter, setActionFilter] = useState<'All' | 'Overdue'>('All');\r\n\r\n\r\n    const findMember = (id?: string) => members.find(m => m.id === id)?.name || '‚Äî';\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    const actionStatusClass = (s: ActionStatus) => {\r\n        const map: Record<ActionStatus, string> = { 'Open': styles.statusOpen, 'In Progress': styles.statusInProgress, 'Done': styles.statusDone, 'Blocked': styles.statusBlocked };\r\n        return map[s];\r\n    };\r\n    const meetingStatusClass = (s: MeetingStatus) => {\r\n        const map: Record<MeetingStatus, string> = { 'Planned': styles.statusPlanned, 'Completed': styles.statusCompleted, 'Cancelled': styles.statusCancelled };\r\n        return map[s];\r\n    };\r\n    const priorityClass = (p: string) => {\r\n        const map: Record<string, string> = { 'Low': styles.priorityLow, 'Medium': styles.priorityMedium, 'High': styles.priorityHigh };\r\n        return map[p];\r\n    };\r\n\r\n    // ‚îÄ‚îÄ Handlers ‚îÄ‚îÄ\r\n    const handleAddAction = () => {\r\n        if (!newAction.title) return;\r\n        const now = new Date().toISOString();\r\n        addActionItem({ id: generateId('act-i'), title: newAction.title, ownerId: newAction.ownerId || undefined, dueDate: newAction.dueDate || undefined, status: 'Open', priority: newAction.priority, sourceType: newAction.sourceType, createdAt: now });\r\n        addActivity({ id: generateId('act'), timestamp: now, action: 'Action created', detail: `\"${newAction.title}\"`, category: 'action' });\r\n        setNewAction({ title: '', ownerId: '', dueDate: '', priority: 'Medium', sourceType: 'Manual' }); setIsActionAddOpen(false);\r\n    };\r\n    const handleEditActionSave = () => {\r\n        if (!editAction) return;\r\n        updateActionItem(editAction.id, { title: editAction.title, ownerId: editAction.ownerId, dueDate: editAction.dueDate, priority: editAction.priority, sourceType: editAction.sourceType, description: editAction.description }); setEditAction(null);\r\n    };\r\n\r\n    const handleAddDecision = () => {\r\n        if (!newDecision.summary) return;\r\n        const now = new Date().toISOString();\r\n        addDecision({ id: generateId('dec'), date: newDecision.date || today, summary: newDecision.summary, decidedBy: newDecision.decidedBy, impactAreas: newDecision.impactAreas.length > 0 ? newDecision.impactAreas : ['Technical'], sourceLink: newDecision.sourceLink, createdAt: now });\r\n        addActivity({ id: generateId('act'), timestamp: now, action: 'Decision recorded', detail: `\"${newDecision.summary.slice(0, 50)}...\"`, category: 'decision' });\r\n        setNewDecision({ summary: '', decidedBy: '', impactAreas: [], date: '', sourceLink: '' }); setIsDecisionAddOpen(false);\r\n    };\r\n    const handleEditDecisionSave = () => {\r\n        if (!editDecisionItem) return;\r\n        updateDecision(editDecisionItem.id, { summary: editDecisionItem.summary, decidedBy: editDecisionItem.decidedBy, impactAreas: editDecisionItem.impactAreas, sourceLink: editDecisionItem.sourceLink }); setEditDecisionItem(null);\r\n    };\r\n\r\n    const handleAddMeeting = () => {\r\n        if (!newMeeting.title) return;\r\n        const now = new Date().toISOString();\r\n        addMeeting({ id: generateId('mtg'), title: newMeeting.title, meetingDate: newMeeting.meetingDate || today, participants: newMeeting.participants, meetingType: newMeeting.meetingType, status: 'Planned', createdAt: now });\r\n        addActivity({ id: generateId('act'), timestamp: now, action: 'Meeting planned', detail: `\"${newMeeting.title}\"`, category: 'meeting' });\r\n        setNewMeeting({ title: '', meetingDate: '', participants: '', meetingType: 'Internal' }); setIsMeetingAddOpen(false);\r\n    };\r\n    const handleEditMeetingSave = () => {\r\n        if (!editMeetingItem) return;\r\n        updateMeeting(editMeetingItem.id, { title: editMeetingItem.title, meetingDate: editMeetingItem.meetingDate, participants: editMeetingItem.participants, meetingType: editMeetingItem.meetingType, notes: editMeetingItem.notes, minutes: editMeetingItem.minutes }); setEditMeetingItem(null);\r\n    };\r\n\r\n    const handleAddComm = () => {\r\n        if (!newComm.subject) return;\r\n        const now = new Date().toISOString();\r\n        addCommunication({ id: generateId('com'), type: newComm.type, subject: newComm.subject, date: newComm.date || today, summary: newComm.summary, linkUrl: newComm.linkUrl, createdAt: now });\r\n        addActivity({ id: generateId('act'), timestamp: now, action: 'Comm logged', detail: `\"${newComm.subject}\"`, category: 'communication' as any });\r\n        setNewComm({ type: 'Email', subject: '', date: '', summary: '', linkUrl: '' }); setIsCommAddOpen(false);\r\n    };\r\n    const handleEditCommSave = () => {\r\n        if (!editCommItem) return;\r\n        updateCommunication(editCommItem.id, { type: editCommItem.type, subject: editCommItem.subject, date: editCommItem.date, summary: editCommItem.summary, linkUrl: editCommItem.linkUrl }); setEditCommItem(null);\r\n    };\r\n\r\n\r\n    const safeActions = actionItems || [];\r\n    const safeDecisions = decisions || [];\r\n    const safeMeetings = meetings || [];\r\n    const safeComms = communications || [];\r\n\r\n    const tabConfig = {\r\n        actions: { title: 'Action Items', subtitle: `${safeActions.length} items`, addLabel: 'Add Action', onAdd: () => setIsActionAddOpen(true) },\r\n        decisions: { title: 'Decisions', subtitle: `${safeDecisions.length} decisions`, addLabel: 'Record Decision', onAdd: () => setIsDecisionAddOpen(true) },\r\n        meetings: { title: 'Meetings', subtitle: `${safeMeetings.length} meetings`, addLabel: 'Add Meeting', onAdd: () => setIsMeetingAddOpen(true) },\r\n        communications: { title: 'Communications', subtitle: `${safeComms.length} records`, addLabel: 'Log Comms', onAdd: () => setIsCommAddOpen(true) },\r\n    };\r\n    const tc = tabConfig[activeTab];\r\n\r\n    // Overdue count\r\n    const overdueCount = safeActions.filter(a => a.dueDate && a.dueDate < today && a.status !== 'Done').length;\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <header className={styles.header}>\r\n                <div><h1 className={styles.title}>{tc.title}</h1><p className={styles.subtitle}>{tc.subtitle}</p></div>\r\n                <Button size=\"sm\" onClick={tc.onAdd}><Plus size={14} /> {tc.addLabel}</Button>\r\n            </header>\r\n\r\n            {/* Tabs */}\r\n            <div className={styles.tabBar}>\r\n                <button className={cn(styles.tabBtn, activeTab === 'actions' && styles.tabActive)} onClick={() => setActiveTab('actions')}>\r\n                    <CheckSquare size={14} /> Actions <span className={styles.tabCount}>{safeActions.length}</span>\r\n                    {overdueCount > 0 && <span style={{ fontSize: '0.625rem', background: 'rgba(214,48,49,0.2)', color: '#ff6b6b', padding: '0 0.3rem', borderRadius: '9999px' }}>{overdueCount} overdue</span>}\r\n                </button>\r\n                <button className={cn(styles.tabBtn, activeTab === 'decisions' && styles.tabActive)} onClick={() => setActiveTab('decisions')}>\r\n                    <Lightbulb size={14} /> Decisions <span className={styles.tabCount}>{safeDecisions.length}</span>\r\n                </button>\r\n                <button className={cn(styles.tabBtn, activeTab === 'meetings' && styles.tabActive)} onClick={() => setActiveTab('meetings')}>\r\n                    <Calendar size={14} /> Meetings <span className={styles.tabCount}>{safeMeetings.length}</span>\r\n                </button>\r\n                <button className={cn(styles.tabBtn, activeTab === 'communications' && styles.tabActive)} onClick={() => setActiveTab('communications')}>\r\n                    <MessageSquare size={14} /> Communications <span className={styles.tabCount}>{safeComms.length}</span>\r\n                </button>\r\n            </div>\r\n\r\n            {/* ‚ïê‚ïê‚ïê ACTION ITEMS TAB ‚ïê‚ïê‚ïê */}\r\n            {activeTab === 'actions' && (\r\n                <>\r\n                    <div className={styles.filterBar} style={{ marginBottom: '1rem' }}>\r\n                        <button className={cn(styles.filterBtn, actionFilter === 'All' && styles.filterActive)} onClick={() => setActionFilter('All')}>All actions</button>\r\n                        <button className={cn(styles.filterBtn, actionFilter === 'Overdue' && styles.filterActive)} onClick={() => setActionFilter('Overdue')}>Overdue</button>\r\n                    </div>\r\n                    {safeActions.filter(a => actionFilter === 'All' ? true : (a.dueDate && a.dueDate < today && a.status !== 'Done')).length === 0 ? (\r\n                        <Card><div className={styles.emptyState}>No action items found. <Button variant=\"ghost\" size=\"sm\" onClick={() => setIsActionAddOpen(true)} style={{ marginTop: '0.5rem' }}>Add first action</Button></div></Card>\r\n                    ) : (\r\n                        <div className={styles.itemList}>\r\n                            {safeActions.filter(a => actionFilter === 'All' ? true : (a.dueDate && a.dueDate < today && a.status !== 'Done')).map(item => (\r\n                                <Card key={item.id} className={styles.itemCard}>\r\n                                    <div className={styles.itemTop}>\r\n                                        <div className={styles.itemLeft}>\r\n                                            <span className={cn(styles.statusPill, priorityClass(item.priority))} style={{ fontSize: '0.6875rem' }}>{item.priority}</span>\r\n                                            <h3 className={styles.itemTitle} onClick={() => setEditAction(item)}>{item.title}</h3>\r\n                                        </div>\r\n                                        <div className={styles.itemRight}>\r\n                                            <span className={cn(styles.statusPill, actionStatusClass(item.status))} onClick={() => { const idx = ACTION_STATUS_CYCLE.indexOf(item.status); updateActionItem(item.id, { status: ACTION_STATUS_CYCLE[(idx + 1) % ACTION_STATUS_CYCLE.length] }); }} title=\"Click to change\">\r\n                                                {item.status}<ChevronRight size={10} className={styles.chevron} />\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                    {item.description && <p className={styles.itemDesc}>{item.description}</p>}\r\n                                    <div className={styles.itemMeta}>\r\n                                        <span>Owner: {findMember(item.ownerId)}</span>\r\n                                        {item.dueDate && <span style={{ color: item.dueDate < today && item.status !== 'Done' ? '#ff6b6b' : undefined }}>Due: {item.dueDate}</span>}\r\n                                        {item.sourceType && item.sourceType !== 'Manual' && <span className={styles.sourceBadge}>{item.sourceType}</span>}\r\n                                        <div className={styles.itemActions}>\r\n                                            <button className={styles.actionBtn} onClick={() => setEditAction(item)}><Pencil size={13} /></button>\r\n                                            <button className={cn(styles.actionBtn, styles.deleteBtn)} onClick={() => deleteActionItem(item.id)}><Trash2 size={13} /></button>\r\n                                        </div>\r\n                                    </div>\r\n                                </Card>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n\r\n            {/* ‚ïê‚ïê‚ïê DECISIONS TAB ‚ïê‚ïê‚ïê */}\r\n            {activeTab === 'decisions' && (\r\n                safeDecisions.length === 0 ? (\r\n                    <Card><div className={styles.emptyState}>No decisions recorded yet.</div></Card>\r\n                ) : (\r\n                    <div className={styles.itemList}>\r\n                        {safeDecisions.map(d => (\r\n                            <Card key={d.id} className={styles.itemCard}>\r\n                                <div className={styles.itemTop}>\r\n                                    <div className={styles.itemLeft}>\r\n                                        {d.impactAreas?.map(a => <span key={a} className={styles.impactBadge}>{a}</span>)}\r\n                                        <h3 className={styles.itemTitle} onClick={() => setEditDecisionItem(d)}>{d.summary}</h3>\r\n                                    </div>\r\n                                </div>\r\n                                <div className={styles.itemMeta}>\r\n                                    <span>By: {d.decidedBy || '‚Äî'}</span>\r\n                                    <span>Date: {d.date}</span>\r\n                                    {d.reason && <span>Reason: {d.reason}</span>}\r\n                                    <div className={styles.itemActions}>\r\n                                        <button className={styles.actionBtn} onClick={() => setEditDecisionItem(d)}><Pencil size={13} /></button>\r\n                                        <button className={cn(styles.actionBtn, styles.deleteBtn)} onClick={() => deleteDecision(d.id)}><Trash2 size={13} /></button>\r\n                                    </div>\r\n                                </div>\r\n                            </Card>\r\n                        ))}\r\n                    </div>\r\n                )\r\n            )}\r\n\r\n            {/* ‚ïê‚ïê‚ïê MEETINGS TAB ‚ïê‚ïê‚ïê */}\r\n            {activeTab === 'meetings' && (\r\n                safeMeetings.length === 0 ? (\r\n                    <Card><div className={styles.emptyState}>No meetings yet.</div></Card>\r\n                ) : (\r\n                    <div className={styles.itemList}>\r\n                        {safeMeetings.map(m => (\r\n                            <Card key={m.id} className={styles.itemCard}>\r\n                                <div className={styles.itemTop}>\r\n                                    <div className={styles.itemLeft}>\r\n                                        <span className={styles.typeBadge}>{m.meetingType}</span>\r\n                                        <h3 className={styles.itemTitle} onClick={() => setEditMeetingItem(m)}>{m.title}</h3>\r\n                                    </div>\r\n                                    <div className={styles.itemRight}>\r\n                                        <span className={cn(styles.statusPill, meetingStatusClass(m.status))} onClick={() => { const idx = MEETING_STATUS_CYCLE.indexOf(m.status); updateMeeting(m.id, { status: MEETING_STATUS_CYCLE[(idx + 1) % MEETING_STATUS_CYCLE.length] }); }} title=\"Click to change\">\r\n                                            {m.status}<ChevronRight size={10} className={styles.chevron} />\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                                {m.notes && <p className={styles.itemDesc}>{m.notes}</p>}\r\n                                {m.minutes && <p className={styles.itemDesc} style={{ borderLeft: '2px solid var(--primary)', paddingLeft: '0.5rem', marginTop: '0.25rem' }}>üìã Minutes: {m.minutes.slice(0, 100)}{m.minutes.length > 100 ? '...' : ''}</p>}\r\n                                <div className={styles.itemMeta}>\r\n                                    <span>Date: {m.meetingDate}</span>\r\n                                    <span>Participants: {m.participants || '‚Äî'}</span>\r\n                                    <div className={styles.itemActions}>\r\n                                        <button className={styles.actionBtn} onClick={() => setEditMeetingItem(m)}><Pencil size={13} /></button>\r\n                                        <button className={cn(styles.actionBtn, styles.deleteBtn)} onClick={() => deleteMeeting(m.id)}><Trash2 size={13} /></button>\r\n                                    </div>\r\n                                </div>\r\n                            </Card>\r\n                        ))}\r\n                    </div>\r\n                )\r\n            )}\r\n\r\n            {/* ‚ïê‚ïê‚ïê COMMUNICATIONS TAB ‚ïê‚ïê‚ïê */}\r\n            {activeTab === 'communications' && (\r\n                safeComms.length === 0 ? (\r\n                    <Card><div className={styles.emptyState}>No communications logged.</div></Card>\r\n                ) : (\r\n                    <div className={styles.itemList}>\r\n                        {safeComms.map(c => (\r\n                            <Card key={c.id} className={styles.itemCard}>\r\n                                <div className={styles.itemTop}>\r\n                                    <div className={styles.itemLeft}>\r\n                                        <span className={styles.typeBadge}>{c.type}</span>\r\n                                        <h3 className={styles.itemTitle} onClick={() => setEditCommItem(c)}>{c.subject}</h3>\r\n                                    </div>\r\n                                </div>\r\n                                {c.summary && <p className={styles.itemDesc}>{c.summary}</p>}\r\n                                <div className={styles.itemMeta}>\r\n                                    <span>Date: {c.date}</span>\r\n                                    {c.linkUrl && <a href={c.linkUrl} target=\"_blank\" rel=\"noreferrer\" style={{ color: 'var(--primary)', textDecoration: 'underline' }}>View Link</a>}\r\n                                    <div className={styles.itemActions}>\r\n                                        <button className={styles.actionBtn} onClick={() => setEditCommItem(c)}><Pencil size={13} /></button>\r\n                                        <button className={cn(styles.actionBtn, styles.deleteBtn)} onClick={() => deleteCommunication(c.id)}><Trash2 size={13} /></button>\r\n                                    </div>\r\n                                </div>\r\n                            </Card>\r\n                        ))}\r\n                    </div>\r\n                )\r\n            )}\r\n\r\n            {/* ‚ïê‚ïê‚ïê MODALS ‚ïê‚ïê‚ïê */}\r\n            {/* Add Action */}\r\n            <Modal isOpen={isActionAddOpen} onClose={() => setIsActionAddOpen(false)} title=\"Quick Add Action Item\">\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}><label>Title *</label><input className={styles.input} value={newAction.title} onChange={e => setNewAction({ ...newAction, title: e.target.value })} placeholder=\"Action item title\" autoFocus /></div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Owner</label><select className={styles.select} value={newAction.ownerId} onChange={e => setNewAction({ ...newAction, ownerId: e.target.value })}><option value=\"\">‚Äî</option>{members.map(m => <option key={m.id} value={m.id}>{m.name}</option>)}</select></div>\r\n                        <div className={styles.formGroup}><label>Due Date</label><input type=\"date\" className={styles.input} value={newAction.dueDate} onChange={e => setNewAction({ ...newAction, dueDate: e.target.value })} /></div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Priority</label><select className={styles.select} value={newAction.priority} onChange={e => setNewAction({ ...newAction, priority: e.target.value as ActionItem['priority'] })}><option>Low</option><option>Medium</option><option>High</option></select></div>\r\n                        <div className={styles.formGroup}><label>Source Type</label><select className={styles.select} value={newAction.sourceType} onChange={e => setNewAction({ ...newAction, sourceType: e.target.value as ActionItem['sourceType'] })}><option>Manual</option><option>Meeting</option><option>Communication</option><option>Issue</option><option>Deployment</option></select></div>\r\n                    </div>\r\n                    <details style={{ marginTop: '0.5rem' }}>\r\n                        <summary style={{ fontSize: '0.75rem', color: 'var(--text-muted)', cursor: 'pointer', userSelect: 'none' }}>Advanced options...</summary>\r\n                        <div className={styles.formGroup} style={{ marginTop: '0.5rem' }}><label>Source Link / ID</label><input className={styles.input} value={(newAction as any).sourceLink || ''} onChange={e => setNewAction({ ...newAction, sourceLink: e.target.value } as any)} placeholder=\"URL or Reference\" /></div>\r\n                    </details>\r\n                    <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setIsActionAddOpen(false)}>Cancel</Button><Button onClick={handleAddAction}>Add Action</Button></div>\r\n                </div>\r\n            </Modal>\r\n            {/* Edit Action */}\r\n            <Modal isOpen={!!editAction} onClose={() => setEditAction(null)} title=\"Edit Action Item\">\r\n                {editAction && (\r\n                    <div className={styles.form}>\r\n                        <div className={styles.formGroup}><label>Title</label><input className={styles.input} value={editAction.title} onChange={e => setEditAction({ ...editAction, title: e.target.value })} /></div>\r\n                        <div className={styles.formGroup}><label>Description</label><textarea className={styles.textarea} value={editAction.description || ''} onChange={e => setEditAction({ ...editAction, description: e.target.value })} placeholder=\"Optional details...\" /></div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Priority</label><select className={styles.select} value={editAction.priority} onChange={e => setEditAction({ ...editAction, priority: e.target.value as ActionItem['priority'] })}><option>Low</option><option>Medium</option><option>High</option></select></div>\r\n                            <div className={styles.formGroup}><label>Due Date</label><input type=\"date\" className={styles.input} value={editAction.dueDate || ''} onChange={e => setEditAction({ ...editAction, dueDate: e.target.value })} /></div>\r\n                        </div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Source Type</label><select className={styles.select} value={editAction.sourceType} onChange={e => setEditAction({ ...editAction, sourceType: e.target.value as ActionItem['sourceType'] })}><option>Manual</option><option>Meeting</option><option>Communication</option><option>Issue</option><option>Deployment</option></select></div>\r\n                            <div className={styles.formGroup}><label>Source Link</label><input className={styles.input} value={editAction.sourceLink || ''} onChange={e => setEditAction({ ...editAction, sourceLink: e.target.value })} placeholder=\"URL or ID...\" /></div>\r\n                        </div>\r\n                        <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setEditAction(null)}>Cancel</Button><Button onClick={handleEditActionSave}>Save</Button></div>\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n\r\n            {/* Add Decision */}\r\n            <Modal isOpen={isDecisionAddOpen} onClose={() => setIsDecisionAddOpen(false)} title=\"Record Decision\">\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}><label>Decision Summary *</label><textarea className={styles.textarea} value={newDecision.summary} onChange={e => setNewDecision({ ...newDecision, summary: e.target.value })} placeholder=\"What was decided?\" autoFocus /></div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Decided By</label><input className={styles.input} value={newDecision.decidedBy} onChange={e => setNewDecision({ ...newDecision, decidedBy: e.target.value })} placeholder=\"Who decided?\" /></div>\r\n                        <div className={styles.formGroup}><label>Date</label><input type=\"date\" className={styles.input} value={newDecision.date} onChange={e => setNewDecision({ ...newDecision, date: e.target.value })} /></div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Impact Area</label><select className={styles.select} onChange={e => { const v = e.target.value as Decision['impactAreas'][number]; setNewDecision({ ...newDecision, impactAreas: [v] }); }}><option>Technical</option><option>Schedule</option><option>Budget</option></select></div>\r\n                        <div className={styles.formGroup}><label>Source Link</label><input className={styles.input} value={newDecision.sourceLink} onChange={e => setNewDecision({ ...newDecision, sourceLink: e.target.value })} placeholder=\"URL or Document ID\" /></div>\r\n                    </div>\r\n                    <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setIsDecisionAddOpen(false)}>Cancel</Button><Button onClick={handleAddDecision}>Record</Button></div>\r\n                </div>\r\n            </Modal>\r\n            <Modal isOpen={!!editDecisionItem} onClose={() => setEditDecisionItem(null)} title=\"Edit Decision\">\r\n                {editDecisionItem && (\r\n                    <div className={styles.form}>\r\n                        <div className={styles.formGroup}><label>Summary</label><textarea className={styles.textarea} value={editDecisionItem.summary} onChange={e => setEditDecisionItem({ ...editDecisionItem, summary: e.target.value })} /></div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Decided By</label><input className={styles.input} value={editDecisionItem.decidedBy} onChange={e => setEditDecisionItem({ ...editDecisionItem, decidedBy: e.target.value })} /></div>\r\n                            <div className={styles.formGroup}><label>Source Link</label><input className={styles.input} value={editDecisionItem.sourceLink || ''} onChange={e => setEditDecisionItem({ ...editDecisionItem, sourceLink: e.target.value })} placeholder=\"URL\" /></div>\r\n                        </div>\r\n                        <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setEditDecisionItem(null)}>Cancel</Button><Button onClick={handleEditDecisionSave}>Save</Button></div>\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n\r\n            {/* Add Meeting */}\r\n            <Modal isOpen={isMeetingAddOpen} onClose={() => setIsMeetingAddOpen(false)} title=\"Add Meeting\">\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}><label>Title *</label><input className={styles.input} value={newMeeting.title} onChange={e => setNewMeeting({ ...newMeeting, title: e.target.value })} placeholder=\"Meeting title\" autoFocus /></div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Date</label><input type=\"date\" className={styles.input} value={newMeeting.meetingDate} onChange={e => setNewMeeting({ ...newMeeting, meetingDate: e.target.value })} /></div>\r\n                        <div className={styles.formGroup}><label>Type</label><select className={styles.select} value={newMeeting.meetingType} onChange={e => setNewMeeting({ ...newMeeting, meetingType: e.target.value as Meeting['meetingType'] })}><option>Internal</option><option>Vendor</option><option>Terminal</option><option>Technical</option><option>Weekly</option></select></div>\r\n                    </div>\r\n                    <div className={styles.formGroup}><label>Participants</label><input className={styles.input} value={newMeeting.participants} onChange={e => setNewMeeting({ ...newMeeting, participants: e.target.value })} placeholder=\"e.g. John, Alice, Bob\" /></div>\r\n                    <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setIsMeetingAddOpen(false)}>Cancel</Button><Button onClick={handleAddMeeting}>Add Meeting</Button></div>\r\n                </div>\r\n            </Modal>\r\n            <Modal isOpen={!!editMeetingItem} onClose={() => setEditMeetingItem(null)} title=\"Edit Meeting\">\r\n                {editMeetingItem && (\r\n                    <div className={styles.form}>\r\n                        <div className={styles.formGroup}><label>Title</label><input className={styles.input} value={editMeetingItem.title} onChange={e => setEditMeetingItem({ ...editMeetingItem, title: e.target.value })} /></div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Date</label><input type=\"date\" className={styles.input} value={editMeetingItem.meetingDate} onChange={e => setEditMeetingItem({ ...editMeetingItem, meetingDate: e.target.value })} /></div>\r\n                            <div className={styles.formGroup}><label>Type</label><select className={styles.select} value={editMeetingItem.meetingType} onChange={e => setEditMeetingItem({ ...editMeetingItem, meetingType: e.target.value as Meeting['meetingType'] })}><option>Internal</option><option>Vendor</option><option>Terminal</option><option>Technical</option><option>Weekly</option></select></div>\r\n                        </div>\r\n                        <div className={styles.formGroup}><label>Participants</label><input className={styles.input} value={editMeetingItem.participants} onChange={e => setEditMeetingItem({ ...editMeetingItem, participants: e.target.value })} /></div>\r\n                        <div className={styles.formGroup}><label>Notes</label><textarea className={styles.textarea} value={editMeetingItem.notes || ''} onChange={e => setEditMeetingItem({ ...editMeetingItem, notes: e.target.value })} placeholder=\"Meeting notes...\" rows={2} /></div>\r\n                        <div className={styles.formGroup}><label>üìã Meeting Minutes</label><textarea className={styles.textarea} value={editMeetingItem.minutes || ''} onChange={e => setEditMeetingItem({ ...editMeetingItem, minutes: e.target.value })} placeholder=\"Detailed meeting minutes, decisions, action items...\" rows={6} style={{ borderColor: 'rgba(108,92,231,0.3)' }} /></div>\r\n                        <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setEditMeetingItem(null)}>Cancel</Button><Button onClick={handleEditMeetingSave}>Save</Button></div>\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n\r\n            {/* Add Communication */}\r\n            <Modal isOpen={isCommAddOpen} onClose={() => setIsCommAddOpen(false)} title=\"Log Communication\">\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}><label>Subject *</label><input className={styles.input} value={newComm.subject} onChange={e => setNewComm({ ...newComm, subject: e.target.value })} placeholder=\"Email subject, call topic...\" autoFocus /></div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Type</label><select className={styles.select} value={newComm.type} onChange={e => setNewComm({ ...newComm, type: e.target.value as CommType })}><option>Email</option><option>Call Note</option><option>Chat Summary</option><option>Vendor Update</option></select></div>\r\n                        <div className={styles.formGroup}><label>Date</label><input type=\"date\" className={styles.input} value={newComm.date} onChange={e => setNewComm({ ...newComm, date: e.target.value })} /></div>\r\n                    </div>\r\n                    <div className={styles.formGroup}><label>Summary</label><textarea className={styles.textarea} value={newComm.summary} onChange={e => setNewComm({ ...newComm, summary: e.target.value })} placeholder=\"Brief summary...\" rows={3} /></div>\r\n                    <div className={styles.formGroup}><label>Link / Reference (Optional)</label><input className={styles.input} value={newComm.linkUrl} onChange={e => setNewComm({ ...newComm, linkUrl: e.target.value })} placeholder=\"URL to thread, doc, etc.\" /></div>\r\n                    <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setIsCommAddOpen(false)}>Cancel</Button><Button onClick={handleAddComm}>Log Comm</Button></div>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* Edit Communication */}\r\n            <Modal isOpen={!!editCommItem} onClose={() => setEditCommItem(null)} title=\"Edit Communication\">\r\n                {editCommItem && (\r\n                    <div className={styles.form}>\r\n                        <div className={styles.formGroup}><label>Subject</label><input className={styles.input} value={editCommItem.subject} onChange={e => setEditCommItem({ ...editCommItem, subject: e.target.value })} /></div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Type</label><select className={styles.select} value={editCommItem.type} onChange={e => setEditCommItem({ ...editCommItem, type: e.target.value as CommType })}><option>Email</option><option>Call Note</option><option>Chat Summary</option><option>Vendor Update</option></select></div>\r\n                            <div className={styles.formGroup}><label>Date</label><input type=\"date\" className={styles.input} value={editCommItem.date} onChange={e => setEditCommItem({ ...editCommItem, date: e.target.value })} /></div>\r\n                        </div>\r\n                        <div className={styles.formGroup}><label>Summary</label><textarea className={styles.textarea} value={editCommItem.summary} onChange={e => setEditCommItem({ ...editCommItem, summary: e.target.value })} rows={3} /></div>\r\n                        <div className={styles.formGroup}><label>Link / Reference</label><input className={styles.input} value={editCommItem.linkUrl || ''} onChange={e => setEditCommItem({ ...editCommItem, linkUrl: e.target.value })} /></div>\r\n                        <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setEditCommItem(null)}>Cancel</Button><Button onClick={handleEditCommSave}>Save</Button></div>\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\api\\auth\\[...nextauth]\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1575,1578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1575,1578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1789,1792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1789,1792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1847,1850],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1847,1850],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import NextAuth, { NextAuthOptions } from \"next-auth\";\r\nimport CredentialsProvider from \"next-auth/providers/credentials\";\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n    providers: [\r\n        CredentialsProvider({\r\n            name: \"Credentials\",\r\n            credentials: {\r\n                email: { label: \"Email\", type: \"text\", placeholder: \"admin@ags.com\" },\r\n                password: { label: \"Password\", type: \"password\" }\r\n            },\r\n            async authorize(credentials) {\r\n                // Mock DB lookup for MVP\r\n                if (!credentials?.email || !credentials?.password) return null;\r\n\r\n                const users = [\r\n                    { id: \"u1\", name: \"Alice (Admin)\", email: \"admin@ags.com\", role: \"Admin\" },\r\n                    { id: \"u2\", name: \"Bob (PM)\", email: \"pm@ags.com\", role: \"PM\" },\r\n                    { id: \"u3\", name: \"Charlie (Member)\", email: \"member@ags.com\", role: \"Member\" },\r\n                    { id: \"u4\", name: \"Dave (Client)\", email: \"client@acme.com\", role: \"Client\" },\r\n                ];\r\n\r\n                // In MVP, we accept any password as long as the email matches our mock list\r\n                const user = users.find(u => u.email === credentials.email);\r\n\r\n                if (user) {\r\n                    return user;\r\n                }\r\n\r\n                // Return null if user data could not be retrieved\r\n                return null;\r\n            }\r\n        })\r\n    ],\r\n    callbacks: {\r\n        async jwt({ token, user }) {\r\n            if (user) {\r\n                token.role = (user as any).role;\r\n                token.id = user.id;\r\n            }\r\n            return token;\r\n        },\r\n        async session({ session, token }) {\r\n            if (session.user) {\r\n                (session.user as any).role = token.role;\r\n                (session.user as any).id = token.id;\r\n            }\r\n            return session;\r\n        }\r\n    },\r\n    pages: {\r\n        signIn: '/login', // We'll create a custom login page\r\n    },\r\n    session: {\r\n        strategy: \"jwt\",\r\n    },\r\n};\r\n\r\nconst handler = NextAuth(authOptions);\r\n\r\nexport { handler as GET, handler as POST };\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\api\\chat\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\api\\generate-action\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\assets\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarIcon' is defined but never used.","line":9,"column":73,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":85,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CalendarIcon"},"fix":{"range":[375,401],"text":""},"desc":"Remove unused variable \"CalendarIcon\"."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":209,"column":83,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8749,8880],"text":"\r\n                            No physical assets found matching the criteria. Click &quot;Add Asset\" to start.\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8749,8880],"text":"\r\n                            No physical assets found matching the criteria. Click &ldquo;Add Asset\" to start.\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8749,8880],"text":"\r\n                            No physical assets found matching the criteria. Click &#34;Add Asset\" to start.\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8749,8880],"text":"\r\n                            No physical assets found matching the criteria. Click &rdquo;Add Asset\" to start.\r\n                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":209,"column":93,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8749,8880],"text":"\r\n                            No physical assets found matching the criteria. Click \"Add Asset&quot; to start.\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8749,8880],"text":"\r\n                            No physical assets found matching the criteria. Click \"Add Asset&ldquo; to start.\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8749,8880],"text":"\r\n                            No physical assets found matching the criteria. Click \"Add Asset&#34; to start.\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8749,8880],"text":"\r\n                            No physical assets found matching the criteria. Click \"Add Asset&rdquo; to start.\r\n                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":261,"column":58,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12336,12448],"text":"\r\n                            No systems registered. Click &quot;New System\" to define one.\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12336,12448],"text":"\r\n                            No systems registered. Click &ldquo;New System\" to define one.\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12336,12448],"text":"\r\n                            No systems registered. Click &#34;New System\" to define one.\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12336,12448],"text":"\r\n                            No systems registered. Click &rdquo;New System\" to define one.\r\n                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":261,"column":69,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12336,12448],"text":"\r\n                            No systems registered. Click \"New System&quot; to define one.\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12336,12448],"text":"\r\n                            No systems registered. Click \"New System&ldquo; to define one.\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12336,12448],"text":"\r\n                            No systems registered. Click \"New System&#34; to define one.\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12336,12448],"text":"\r\n                            No systems registered. Click \"New System&rdquo; to define one.\r\n                        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Card } from '@/app/components/ui/Card';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Modal } from '@/app/components/ui/Modal';\r\nimport { Badge } from '@/app/components/ui/Badge';\r\nimport { Server, Package, Plus, MapPin, Hash, ExternalLink, Calendar as CalendarIcon, Edit2, Trash2, Clock, Wrench } from 'lucide-react';\r\nimport styles from './page.module.css';\r\nimport { cn, generateId } from '@/lib/utils';\r\nimport { Asset, SystemRegister, AssetStatus, SystemStatus } from '@/types';\r\n\r\ntype TabView = 'assets' | 'systems';\r\n\r\nexport default function AssetsPage() {\r\n    const {\r\n        assets = [],\r\n        systems = [],\r\n        members = [],\r\n        vendors = [],\r\n        addAsset,\r\n        updateAsset,\r\n        deleteAsset,\r\n        addSystem,\r\n        updateSystem,\r\n        deleteSystem\r\n    } = useProject();\r\n\r\n    const [activeTab, setActiveTab] = useState<TabView>('assets');\r\n\r\n    // Filters\r\n    const [statusFilter, setStatusFilter] = useState<string>('All');\r\n\r\n    // Asset Modal\r\n    const [isAssetModalOpen, setIsAssetModalOpen] = useState(false);\r\n    const [editAssetId, setEditAssetId] = useState<string | null>(null);\r\n    const [assetForm, setAssetForm] = useState<Partial<Asset>>({\r\n        tag: '', name: '', model: '', serialNumber: '', location: '', ownerId: '', status: 'Active', purchaseDate: '', notes: ''\r\n    });\r\n\r\n    // System Modal\r\n    const [isSystemModalOpen, setIsSystemModalOpen] = useState(false);\r\n    const [editSystemId, setEditSystemId] = useState<string | null>(null);\r\n    const [systemForm, setSystemForm] = useState<Partial<SystemRegister>>({\r\n        name: '', version: '', environment: 'Production', status: 'Online', vendorId: '', url: '', notes: ''\r\n    });\r\n\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    // --- Asset Handlers ---\r\n    const openAssetModal = (asset?: Asset) => {\r\n        if (asset) {\r\n            setEditAssetId(asset.id);\r\n            setAssetForm(asset);\r\n        } else {\r\n            setEditAssetId(null);\r\n            setAssetForm({ tag: '', name: '', model: '', serialNumber: '', location: '', ownerId: '', status: 'Active', purchaseDate: '', notes: '' });\r\n        }\r\n        setIsAssetModalOpen(true);\r\n    };\r\n\r\n    const handleSaveAsset = () => {\r\n        if (!assetForm.tag || !assetForm.name || !assetForm.location) return;\r\n        if (editAssetId) {\r\n            updateAsset(editAssetId, { ...assetForm, updatedAt: today });\r\n        } else {\r\n            addAsset({\r\n                id: generateId('ast'),\r\n                tag: assetForm.tag,\r\n                name: assetForm.name,\r\n                model: assetForm.model,\r\n                serialNumber: assetForm.serialNumber,\r\n                location: assetForm.location,\r\n                ownerId: assetForm.ownerId,\r\n                status: assetForm.status as AssetStatus || 'Active',\r\n                purchaseDate: assetForm.purchaseDate,\r\n                notes: assetForm.notes,\r\n                createdAt: today,\r\n                updatedAt: today\r\n            });\r\n        }\r\n        setIsAssetModalOpen(false);\r\n    };\r\n\r\n    // --- System Handlers ---\r\n    const openSystemModal = (system?: SystemRegister) => {\r\n        if (system) {\r\n            setEditSystemId(system.id);\r\n            setSystemForm(system);\r\n        } else {\r\n            setEditSystemId(null);\r\n            setSystemForm({ name: '', version: '', environment: 'Production', status: 'Online', vendorId: '', url: '', notes: '' });\r\n        }\r\n        setIsSystemModalOpen(true);\r\n    };\r\n\r\n    const handleSaveSystem = () => {\r\n        if (!systemForm.name || !systemForm.environment) return;\r\n        if (editSystemId) {\r\n            updateSystem(editSystemId, { ...systemForm, updatedAt: today, lastChecked: today });\r\n        } else {\r\n            addSystem({\r\n                id: generateId('sys'),\r\n                name: systemForm.name,\r\n                version: systemForm.version,\r\n                environment: systemForm.environment as 'Production' | 'Staging' | 'Test' | 'Development',\r\n                status: systemForm.status as SystemStatus || 'Online',\r\n                vendorId: systemForm.vendorId,\r\n                url: systemForm.url,\r\n                notes: systemForm.notes,\r\n                lastChecked: today,\r\n                createdAt: today,\r\n                updatedAt: today\r\n            });\r\n        }\r\n        setIsSystemModalOpen(false);\r\n    };\r\n\r\n    // --- Filtering ---\r\n    const filteredAssets = assets.filter(a => statusFilter === 'All' || a.status === statusFilter);\r\n    const filteredSystems = systems.filter(s => statusFilter === 'All' || s.status === statusFilter);\r\n\r\n    // --- Render Helpers ---\r\n    const getBadgeVariant = (status: string) => {\r\n        switch (status) {\r\n            case 'Active':\r\n            case 'Online':\r\n                return 'success';\r\n            case 'Under Maintenance':\r\n            case 'Maintenance':\r\n            case 'Degraded':\r\n                return 'warning';\r\n            case 'Lost':\r\n            case 'Offline':\r\n            case 'Retired':\r\n                return 'neutral';\r\n            default:\r\n                return 'primary';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <header className={styles.header}>\r\n                <div>\r\n                    <h1 className={styles.title}>Asset & System Register</h1>\r\n                    <p className={styles.subtitle}>Track physical hardware and software system environments</p>\r\n                </div>\r\n                <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                    <Button onClick={() => openAssetModal()}>\r\n                        <Plus size={16} /> Add Asset\r\n                    </Button>\r\n                    <Button variant=\"outline\" onClick={() => openSystemModal()}>\r\n                        <Plus size={16} /> New System\r\n                    </Button>\r\n                </div>\r\n            </header>\r\n\r\n            <div className={styles.tabs} style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                    <button\r\n                        className={cn(styles.tabBtn, activeTab === 'assets' && styles.tabActive)}\r\n                        onClick={() => { setActiveTab('assets'); setStatusFilter('All'); }}\r\n                    >\r\n                        <Package size={14} style={{ display: 'inline', marginRight: '6px' }} />\r\n                        Physical Assets ({assets.length})\r\n                    </button>\r\n                    <button\r\n                        className={cn(styles.tabBtn, activeTab === 'systems' && styles.tabActive)}\r\n                        onClick={() => { setActiveTab('systems'); setStatusFilter('All'); }}\r\n                    >\r\n                        <Server size={14} style={{ display: 'inline', marginRight: '6px' }} />\r\n                        System Environments ({systems.length})\r\n                    </button>\r\n                </div>\r\n                <div>\r\n                    <select\r\n                        className={styles.select}\r\n                        style={{ padding: '0.25rem 0.5rem', width: '150px' }}\r\n                        value={statusFilter}\r\n                        onChange={(e) => setStatusFilter(e.target.value)}\r\n                    >\r\n                        <option value=\"All\">All Statuses</option>\r\n                        {activeTab === 'assets' ? (\r\n                            <>\r\n                                <option value=\"Active\">Active</option>\r\n                                <option value=\"Under Maintenance\">Under Maintenance</option>\r\n                                <option value=\"Retired\">Retired</option>\r\n                                <option value=\"Lost\">Lost</option>\r\n                            </>\r\n                        ) : (\r\n                            <>\r\n                                <option value=\"Online\">Online</option>\r\n                                <option value=\"Degraded\">Degraded</option>\r\n                                <option value=\"Maintenance\">Maintenance</option>\r\n                                <option value=\"Offline\">Offline</option>\r\n                            </>\r\n                        )}\r\n                    </select>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Constraints Display */}\r\n            <div className={styles.list}>\r\n                {activeTab === 'assets' && (\r\n                    filteredAssets.length === 0 ? (\r\n                        <div className={styles.emptyState}>\r\n                            No physical assets found matching the criteria. Click \"Add Asset\" to start.\r\n                        </div>\r\n                    ) : (\r\n                        filteredAssets.map(a => {\r\n                            const owner = members.find(m => m.id === a.ownerId);\r\n                            return (\r\n                                <Card key={a.id} className={styles.card}>\r\n                                    <div className={styles.cardHeader}>\r\n                                        <div>\r\n                                            <h3 className={styles.cardTitle}>\r\n                                                <span className={styles.tagBadge}>{a.tag}</span>\r\n                                                {a.name}\r\n                                                <span style={{ marginLeft: '0.5rem' }}>\r\n                                                    <Badge variant={getBadgeVariant(a.status)}>{a.status}</Badge>\r\n                                                </span>\r\n                                            </h3>\r\n                                            <div className={styles.cardMeta}>\r\n                                                <div className={styles.cardMetaRow}>\r\n                                                    <MapPin size={14} /> <span>{a.location}</span>\r\n                                                </div>\r\n                                                {(a.model || a.serialNumber) && (\r\n                                                    <div className={styles.cardMetaRow}>\r\n                                                        {a.model && <span><Package size={14} /> {a.model}</span>}\r\n                                                        {a.serialNumber && <span><Hash size={14} /> SN: {a.serialNumber}</span>}\r\n                                                    </div>\r\n                                                )}\r\n                                                {owner && (\r\n                                                    <div className={styles.cardMetaRow}>\r\n                                                        <Wrench size={14} /> <span>Custodian: {owner.name}</span>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className={styles.actions}>\r\n                                            <button className={styles.iconBtn} onClick={() => openAssetModal(a)} title=\"Edit Asset\">\r\n                                                <Edit2 size={16} />\r\n                                            </button>\r\n                                            <button className={cn(styles.iconBtn, styles.deleteBtn)} onClick={() => deleteAsset(a.id)} title=\"Delete Asset\">\r\n                                                <Trash2 size={16} />\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                    {a.notes && <p style={{ fontSize: '0.875rem', color: 'var(--foreground-muted)', margin: 0, marginTop: '0.25rem' }}>{a.notes}</p>}\r\n                                </Card>\r\n                            )\r\n                        })\r\n                    )\r\n                )}\r\n\r\n                {activeTab === 'systems' && (\r\n                    filteredSystems.length === 0 ? (\r\n                        <div className={styles.emptyState}>\r\n                            No systems registered. Click \"New System\" to define one.\r\n                        </div>\r\n                    ) : (\r\n                        filteredSystems.map(s => {\r\n                            const vendor = vendors.find(v => v.id === s.vendorId);\r\n                            return (\r\n                                <Card key={s.id} className={styles.card}>\r\n                                    <div className={styles.cardHeader}>\r\n                                        <div>\r\n                                            <h3 className={styles.cardTitle}>\r\n                                                {s.name}\r\n                                                <span style={{ marginLeft: '0.5rem', display: 'flex', gap: '0.25rem' }}>\r\n                                                    <Badge variant={s.environment === 'Production' ? 'primary' : 'neutral'}>{s.environment}</Badge>\r\n                                                    <Badge variant={getBadgeVariant(s.status)}>{s.status}</Badge>\r\n                                                </span>\r\n                                            </h3>\r\n                                            <div className={styles.cardMeta}>\r\n                                                {s.version && (\r\n                                                    <div className={styles.cardMetaRow}>\r\n                                                        <Hash size={14} /> <span>v{s.version}</span>\r\n                                                    </div>\r\n                                                )}\r\n                                                {vendor && (\r\n                                                    <div className={styles.cardMetaRow}>\r\n                                                        <Server size={14} /> <span>Provided by: {vendor.name}</span>\r\n                                                    </div>\r\n                                                )}\r\n                                                {s.url && (\r\n                                                    <div className={styles.cardMetaRow}>\r\n                                                        <ExternalLink size={14} /> <a href={s.url} target=\"_blank\" rel=\"noreferrer\" style={{ color: 'var(--primary)', textDecoration: 'none' }}>{s.url}</a>\r\n                                                    </div>\r\n                                                )}\r\n                                                <div className={styles.cardMetaRow}>\r\n                                                    <Clock size={14} /> <span>Last Check: {s.lastChecked}</span>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className={styles.actions}>\r\n                                            <button className={styles.iconBtn} onClick={() => {\r\n                                                updateSystem(s.id, { lastChecked: today });\r\n                                            }} title=\"Update Last Check Time\">\r\n                                                <Clock size={16} />\r\n                                            </button>\r\n                                            <button className={styles.iconBtn} onClick={() => openSystemModal(s)} title=\"Edit System\">\r\n                                                <Edit2 size={16} />\r\n                                            </button>\r\n                                            <button className={cn(styles.iconBtn, styles.deleteBtn)} onClick={() => deleteSystem(s.id)} title=\"Delete System\">\r\n                                                <Trash2 size={16} />\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                    {s.notes && <p style={{ fontSize: '0.875rem', color: 'var(--foreground-muted)', margin: 0, marginTop: '0.25rem' }}>{s.notes}</p>}\r\n                                </Card>\r\n                            )\r\n                        })\r\n                    )\r\n                )}\r\n            </div>\r\n\r\n            {/* Asset Modal */}\r\n            <Modal isOpen={isAssetModalOpen} onClose={() => setIsAssetModalOpen(false)} title={editAssetId ? \"Edit Asset\" : \"Add Physical Asset\"}>\r\n                <div className={styles.form}>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Asset Tag *</label>\r\n                            <input className={styles.input} value={assetForm.tag} onChange={e => setAssetForm({ ...assetForm, tag: e.target.value })} placeholder=\"AST-1001\" />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Name / Title *</label>\r\n                            <input className={styles.input} value={assetForm.name} onChange={e => setAssetForm({ ...assetForm, name: e.target.value })} placeholder=\"Surveying Station\" />\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Location *</label>\r\n                            <input className={styles.input} value={assetForm.location} onChange={e => setAssetForm({ ...assetForm, location: e.target.value })} placeholder=\"Zone A Storage\" />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Assigned To</label>\r\n                            <select className={styles.select} value={assetForm.ownerId || ''} onChange={e => setAssetForm({ ...assetForm, ownerId: e.target.value })}>\r\n                                <option value=\"\">‚Äî Unassigned ‚Äî</option>\r\n                                {members.map(m => <option key={m.id} value={m.id}>{m.name}</option>)}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Status</label>\r\n                            <select className={styles.select} value={assetForm.status} onChange={e => setAssetForm({ ...assetForm, status: e.target.value as AssetStatus })}>\r\n                                <option value=\"Active\">Active</option>\r\n                                <option value=\"Under Maintenance\">Under Maintenance</option>\r\n                                <option value=\"Retired\">Retired</option>\r\n                                <option value=\"Lost\">Lost</option>\r\n                            </select>\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Purchase Date</label>\r\n                            <input className={styles.input} type=\"date\" value={assetForm.purchaseDate} onChange={e => setAssetForm({ ...assetForm, purchaseDate: e.target.value })} />\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Hardware Model</label>\r\n                            <input className={styles.input} value={assetForm.model} onChange={e => setAssetForm({ ...assetForm, model: e.target.value })} placeholder=\"e.g. Leica TS16\" />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Serial Number</label>\r\n                            <input className={styles.input} value={assetForm.serialNumber} onChange={e => setAssetForm({ ...assetForm, serialNumber: e.target.value })} placeholder=\"SN...\" />\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Notes</label>\r\n                        <textarea className={styles.textarea} value={assetForm.notes} onChange={e => setAssetForm({ ...assetForm, notes: e.target.value })} placeholder=\"Condition reports, warranty info...\" />\r\n                    </div>\r\n                    <div className={styles.formActions}>\r\n                        <Button variant=\"ghost\" onClick={() => setIsAssetModalOpen(false)}>Cancel</Button>\r\n                        <Button onClick={handleSaveAsset}>Save Asset</Button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* System Modal */}\r\n            <Modal isOpen={isSystemModalOpen} onClose={() => setIsSystemModalOpen(false)} title={editSystemId ? \"Edit System\" : \"Register System\"}>\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}>\r\n                        <label>System Name *</label>\r\n                        <input className={styles.input} value={systemForm.name} onChange={e => setSystemForm({ ...systemForm, name: e.target.value })} placeholder=\"Access Control API\" />\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Environment *</label>\r\n                            <select className={styles.select} value={systemForm.environment} onChange={e => setSystemForm({ ...systemForm, environment: e.target.value as 'Production' | 'Staging' | 'Test' | 'Development' })}>\r\n                                <option value=\"Production\">Production</option>\r\n                                <option value=\"Staging\">Staging</option>\r\n                                <option value=\"Test\">Test</option>\r\n                                <option value=\"Development\">Development</option>\r\n                            </select>\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Status</label>\r\n                            <select className={styles.select} value={systemForm.status} onChange={e => setSystemForm({ ...systemForm, status: e.target.value as SystemStatus })}>\r\n                                <option value=\"Online\">Online</option>\r\n                                <option value=\"Degraded\">Degraded</option>\r\n                                <option value=\"Maintenance\">Maintenance</option>\r\n                                <option value=\"Offline\">Offline</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Version</label>\r\n                            <input className={styles.input} value={systemForm.version} onChange={e => setSystemForm({ ...systemForm, version: e.target.value })} placeholder=\"e.g. 2.4.1\" />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Associated Vendor</label>\r\n                            <select className={styles.select} value={systemForm.vendorId || ''} onChange={e => setSystemForm({ ...systemForm, vendorId: e.target.value })}>\r\n                                <option value=\"\">‚Äî None (Internal) ‚Äî</option>\r\n                                {vendors.map(v => <option key={v.id} value={v.id}>{v.name}</option>)}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formGroup}>\r\n                        <label>URL / Access Endpoint</label>\r\n                        <input className={styles.input} type=\"url\" value={systemForm.url} onChange={e => setSystemForm({ ...systemForm, url: e.target.value })} placeholder=\"https://\" />\r\n                    </div>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Notes</label>\r\n                        <textarea className={styles.textarea} value={systemForm.notes} onChange={e => setSystemForm({ ...systemForm, notes: e.target.value })} placeholder=\"Credentials hint, architecture notes...\" />\r\n                    </div>\r\n                    <div className={styles.formActions}>\r\n                        <Button variant=\"ghost\" onClick={() => setIsSystemModalOpen(false)}>Cancel</Button>\r\n                        <Button onClick={handleSaveSystem}>Register</Button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\budget\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingDown' is defined but never used.","line":8,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":48,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendingDown"},"fix":{"range":[343,357],"text":""},"desc":"Remove unused variable \"TrendingDown\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useMemo } from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/app/components/ui/Card';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Modal } from '@/app/components/ui/Modal';\r\nimport { Plus, Trash2, DollarSign, TrendingDown, Wallet, PieChart } from 'lucide-react';\r\nimport { generateId } from '@/lib/utils';\r\nimport { BudgetEntry } from '@/types';\r\nimport styles from './page.module.css';\r\n\r\nconst CATEGORIES: BudgetEntry['category'][] = ['Labor', 'Hardware', 'Software', 'Travel', 'Training', 'Consulting', 'Other'];\r\n\r\nconst CATEGORY_COLORS: Record<string, string> = {\r\n    Labor: '#6c5ce7',\r\n    Hardware: '#0984e3',\r\n    Software: '#00cec9',\r\n    Travel: '#e17055',\r\n    Training: '#fdcb6e',\r\n    Consulting: '#e84393',\r\n    Other: '#636e72',\r\n};\r\n\r\nexport default function BudgetPage() {\r\n    const { budget, setContractAmount, addBudgetEntry, deleteBudgetEntry, addActivity } = useProject();\r\n    const [isAddOpen, setIsAddOpen] = useState(false);\r\n    const [localContract, setLocalContract] = useState('');\r\n    const [editingContract, setEditingContract] = useState(false);\r\n\r\n    // Form state\r\n    const [formDate, setFormDate] = useState(() => new Date().toISOString().split('T')[0]);\r\n    const [formCategory, setFormCategory] = useState<BudgetEntry['category']>('Labor');\r\n    const [formDesc, setFormDesc] = useState('');\r\n    const [formAmount, setFormAmount] = useState('');\r\n\r\n    // Computed\r\n    const spent = useMemo(() => budget.entries.reduce((s, e) => s + e.amount, 0), [budget.entries]);\r\n    const remaining = budget.contractAmount - spent;\r\n    const usedPercent = budget.contractAmount > 0 ? Math.round((spent / budget.contractAmount) * 100) : 0;\r\n\r\n    const categoryBreakdown = useMemo(() => {\r\n        const map: Record<string, number> = {};\r\n        budget.entries.forEach(e => {\r\n            map[e.category] = (map[e.category] || 0) + e.amount;\r\n        });\r\n        return CATEGORIES.map(cat => ({\r\n            name: cat,\r\n            amount: map[cat] || 0,\r\n            percent: spent > 0 ? Math.round(((map[cat] || 0) / spent) * 100) : 0,\r\n        })).filter(c => c.amount > 0).sort((a, b) => b.amount - a.amount);\r\n    }, [budget.entries, spent]);\r\n\r\n    const handleSaveContract = () => {\r\n        const val = parseFloat(localContract);\r\n        if (!isNaN(val) && val >= 0) {\r\n            setContractAmount(val);\r\n            addActivity({\r\n                id: generateId('act'),\r\n                timestamp: new Date().toISOString(),\r\n                action: 'Budget updated',\r\n                detail: `Contract amount set to $${val.toLocaleString()}`,\r\n                category: 'budget',\r\n            });\r\n        }\r\n        setEditingContract(false);\r\n    };\r\n\r\n    const handleAddEntry = () => {\r\n        const amount = parseFloat(formAmount);\r\n        if (!formDesc.trim() || isNaN(amount) || amount <= 0) return;\r\n        const entry: BudgetEntry = {\r\n            id: generateId('bud'),\r\n            date: formDate,\r\n            category: formCategory,\r\n            description: formDesc.trim(),\r\n            amount,\r\n        };\r\n        addBudgetEntry(entry);\r\n        addActivity({\r\n            id: generateId('act'),\r\n            timestamp: new Date().toISOString(),\r\n            action: 'Expense added',\r\n            detail: `$${amount.toLocaleString()} ‚Äî ${formDesc.trim()} (${formCategory})`,\r\n            category: 'budget',\r\n        });\r\n        // Reset\r\n        setFormDesc('');\r\n        setFormAmount('');\r\n        setIsAddOpen(false);\r\n    };\r\n\r\n    const handleDelete = (entry: BudgetEntry) => {\r\n        deleteBudgetEntry(entry.id);\r\n        addActivity({\r\n            id: generateId('act'),\r\n            timestamp: new Date().toISOString(),\r\n            action: 'Expense removed',\r\n            detail: `$${entry.amount.toLocaleString()} ‚Äî ${entry.description}`,\r\n            category: 'budget',\r\n        });\r\n    };\r\n\r\n    const sortedEntries = useMemo(() =>\r\n        [...budget.entries].sort((a, b) => b.date.localeCompare(a.date)),\r\n        [budget.entries]);\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <header className={styles.header}>\r\n                <div className={styles.headerLeft}>\r\n                    <h1 className={styles.title}>Budget</h1>\r\n                    <p className={styles.subtitle}>Track project spending & cost breakdown</p>\r\n                </div>\r\n                <Button size=\"sm\" onClick={() => setIsAddOpen(true)}>\r\n                    <Plus size={14} /> Add Expense\r\n                </Button>\r\n            </header>\r\n\r\n            {/* Contract Amount */}\r\n            <div className={styles.contractSection}>\r\n                <span className={styles.contractLabel}>Contract Amount ($)</span>\r\n                {editingContract ? (\r\n                    <>\r\n                        <input\r\n                            className={styles.contractInput}\r\n                            type=\"number\"\r\n                            min={0}\r\n                            value={localContract}\r\n                            onChange={(e) => setLocalContract(e.target.value)}\r\n                            onKeyDown={(e) => e.key === 'Enter' && handleSaveContract()}\r\n                            autoFocus\r\n                        />\r\n                        <Button size=\"sm\" onClick={handleSaveContract}>Save</Button>\r\n                        <Button size=\"sm\" variant=\"ghost\" onClick={() => setEditingContract(false)}>Cancel</Button>\r\n                    </>\r\n                ) : (\r\n                    <>\r\n                        <span style={{ fontSize: '1.125rem', fontWeight: 700 }}>\r\n                            {budget.contractAmount > 0 ? `$${budget.contractAmount.toLocaleString()}` : 'Not set'}\r\n                        </span>\r\n                        <Button size=\"sm\" variant=\"ghost\" onClick={() => { setLocalContract(String(budget.contractAmount)); setEditingContract(true); }}>\r\n                            Edit\r\n                        </Button>\r\n                    </>\r\n                )}\r\n            </div>\r\n\r\n            {/* Summary Cards */}\r\n            <div className={styles.summaryGrid}>\r\n                <Card glass glow className={styles.summaryCard}>\r\n                    <CardContent>\r\n                        <div className={styles.summaryLabel}>Total Budget</div>\r\n                        <div className={styles.summaryValue}>\r\n                            ${budget.contractAmount.toLocaleString()}\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                <Card glass glow className={styles.summaryCard}>\r\n                    <CardContent>\r\n                        <div className={styles.summaryLabel}>Spent</div>\r\n                        <div className={`${styles.summaryValue} ${usedPercent > 90 ? styles.textRed : usedPercent > 70 ? styles.textYellow : ''}`}>\r\n                            ${spent.toLocaleString()}\r\n                        </div>\r\n                        <div className={styles.usageBar}>\r\n                            <div\r\n                                className={styles.usageFill}\r\n                                style={{\r\n                                    width: `${Math.min(usedPercent, 100)}%`,\r\n                                    background: usedPercent > 90 ? 'var(--danger)' : usedPercent > 70 ? 'var(--warning)' : 'var(--primary)',\r\n                                }}\r\n                            />\r\n                        </div>\r\n                        <div className={styles.summaryMeta}>{usedPercent}% of budget</div>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                <Card glass glow className={styles.summaryCard}>\r\n                    <CardContent>\r\n                        <div className={styles.summaryLabel}>Remaining</div>\r\n                        <div className={`${styles.summaryValue} ${remaining < 0 ? styles.textRed : styles.textGreen}`}>\r\n                            ${Math.abs(remaining).toLocaleString()}\r\n                            {remaining < 0 && <span className={styles.summaryUnit}> over</span>}\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                <Card glass glow className={styles.summaryCard}>\r\n                    <CardContent>\r\n                        <div className={styles.summaryLabel}>Expenses</div>\r\n                        <div className={styles.summaryValue}>{budget.entries.length}</div>\r\n                        <div className={styles.summaryMeta}>{categoryBreakdown.length} categories</div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* Category Breakdown */}\r\n            {categoryBreakdown.length > 0 && (\r\n                <Card>\r\n                    <CardHeader><CardTitle><PieChart size={16} style={{ display: 'inline', marginRight: '0.5rem', verticalAlign: 'text-bottom' }} />Category Breakdown</CardTitle></CardHeader>\r\n                    <CardContent>\r\n                        <div className={styles.breakdownSection}>\r\n                            {categoryBreakdown.map(cat => (\r\n                                <div key={cat.name} className={styles.categoryRow}>\r\n                                    <span className={styles.categoryName}>{cat.name}</span>\r\n                                    <div className={styles.categoryBarWrap}>\r\n                                        <div\r\n                                            className={styles.categoryBarFill}\r\n                                            style={{\r\n                                                width: `${cat.percent}%`,\r\n                                                background: CATEGORY_COLORS[cat.name] || '#636e72',\r\n                                            }}\r\n                                        />\r\n                                    </div>\r\n                                    <span className={styles.categoryAmount}>${cat.amount.toLocaleString()}</span>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            )}\r\n\r\n            {/* Expense Ledger */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <div className={styles.sectionHeader}>\r\n                        <CardTitle><Wallet size={16} style={{ display: 'inline', marginRight: '0.5rem', verticalAlign: 'text-bottom' }} />Expense Ledger</CardTitle>\r\n                    </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    {sortedEntries.length === 0 ? (\r\n                        <div className={styles.emptyState}>\r\n                            <DollarSign size={20} style={{ opacity: 0.5, marginBottom: '0.5rem' }} />\r\n                            <p>No expenses recorded yet. Click &quot;Add Expense&quot; to start tracking.</p>\r\n                        </div>\r\n                    ) : (\r\n                        <table className={styles.ledgerTable}>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Date</th>\r\n                                    <th>Category</th>\r\n                                    <th>Description</th>\r\n                                    <th style={{ textAlign: 'right' }}>Amount</th>\r\n                                    <th style={{ width: 40 }}></th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {sortedEntries.map(entry => (\r\n                                    <tr key={entry.id}>\r\n                                        <td>{entry.date}</td>\r\n                                        <td><span className={styles.categoryBadge}>{entry.category}</span></td>\r\n                                        <td>{entry.description}</td>\r\n                                        <td className={styles.amountCell} style={{ textAlign: 'right' }}>${entry.amount.toLocaleString()}</td>\r\n                                        <td>\r\n                                            <button className={styles.deleteBtn} onClick={() => handleDelete(entry)} title=\"Delete\">\r\n                                                <Trash2 size={14} />\r\n                                            </button>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                                <tr style={{ fontWeight: 700, borderTop: '2px solid var(--border)' }}>\r\n                                    <td colSpan={3} style={{ textAlign: 'right', color: 'var(--foreground-muted)' }}>Total</td>\r\n                                    <td className={styles.amountCell} style={{ textAlign: 'right' }}>${spent.toLocaleString()}</td>\r\n                                    <td></td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    )}\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Add Expense Modal */}\r\n            <Modal isOpen={isAddOpen} onClose={() => setIsAddOpen(false)} title=\"Add Expense\">\r\n                <div className={styles.formGrid}>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formField}>\r\n                            <label className={styles.formLabel}>Date</label>\r\n                            <input\r\n                                type=\"date\"\r\n                                className={styles.formInput}\r\n                                value={formDate}\r\n                                onChange={(e) => setFormDate(e.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className={styles.formField}>\r\n                            <label className={styles.formLabel}>Category</label>\r\n                            <select\r\n                                className={styles.formSelect}\r\n                                value={formCategory}\r\n                                onChange={(e) => setFormCategory(e.target.value as BudgetEntry['category'])}\r\n                            >\r\n                                {CATEGORIES.map(c => <option key={c} value={c}>{c}</option>)}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formField}>\r\n                        <label className={styles.formLabel}>Description</label>\r\n                        <input\r\n                            className={styles.formInput}\r\n                            value={formDesc}\r\n                            onChange={(e) => setFormDesc(e.target.value)}\r\n                            placeholder=\"What was this expense for?\"\r\n                        />\r\n                    </div>\r\n                    <div className={styles.formField}>\r\n                        <label className={styles.formLabel}>Amount ($)</label>\r\n                        <input\r\n                            type=\"number\"\r\n                            min={0}\r\n                            step={0.01}\r\n                            className={styles.formInput}\r\n                            value={formAmount}\r\n                            onChange={(e) => setFormAmount(e.target.value)}\r\n                            placeholder=\"0.00\"\r\n                            onKeyDown={(e) => e.key === 'Enter' && handleAddEntry()}\r\n                        />\r\n                    </div>\r\n                    <div className={styles.formActions}>\r\n                        <Button variant=\"ghost\" onClick={() => setIsAddOpen(false)}>Cancel</Button>\r\n                        <Button onClick={handleAddEntry}>Add Expense</Button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\components\\AuthProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\components\\Copilot.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[961,964],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[961,964],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3001,3004],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3001,3004],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\r\n'use client';\r\n\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport { Bot, X, Send, Sparkles } from 'lucide-react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport styles from './Copilot.module.css';\r\nimport { toast } from 'sonner';\r\n\r\nexport function Copilot() {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const { projectInfo, tasks, issues, members } = useProject();\r\n    const messagesEndRef = useRef<HTMLDivElement>(null);\r\n\r\n    // Build context string dynamically\r\n    const projectContext = `\r\n    Project Name: ${projectInfo.name}\r\n    Description: ${projectInfo.description}\r\n    Total Tasks: ${tasks.length}\r\n    Total Issues: ${issues.length}\r\n    Open Tasks: ${tasks.filter(t => t.status !== 'Done').length}\r\n    Critical Issues: ${issues.filter(i => i.severity === 'S1').length}\r\n    Team Members: ${members.map(m => m.name).join(', ')}\r\n    `;\r\n\r\n    const [messages, setMessages] = useState<any[]>([]);\r\n    const [localInput, setLocalInput] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!localInput.trim() || isLoading) return;\r\n\r\n        const userMsg = { id: Date.now().toString(), role: 'user', content: localInput };\r\n        const newMessages = [...messages, userMsg];\r\n        setMessages(newMessages);\r\n        setLocalInput('');\r\n        setIsLoading(true);\r\n\r\n        try {\r\n            const res = await fetch('/api/chat', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ messages: newMessages, context: projectContext })\r\n            });\r\n\r\n            if (!res.ok) {\r\n                const errText = await res.text();\r\n                throw new Error(errText || 'API ÏóêÎü¨Í∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');\r\n            }\r\n\r\n            const reader = res.body?.getReader();\r\n            if (!reader) throw new Error('Ïä§Ìä∏Î¶ºÏùÑ ÏùΩÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');\r\n\r\n            const decoder = new TextDecoder();\r\n            let assistantContent = '';\r\n\r\n            // Add an empty assistant message to update\r\n            const tempAssistantId = Date.now().toString() + '-ai';\r\n            setMessages(prev => [...prev, { id: tempAssistantId, role: 'assistant', content: '' }]);\r\n\r\n            while (true) {\r\n                const { done, value } = await reader.read();\r\n                if (done) break;\r\n\r\n                const chunk = decoder.decode(value, { stream: true });\r\n                assistantContent += chunk;\r\n\r\n                setMessages(prev => {\r\n                    const latest = [...prev];\r\n                    const lastIdx = latest.length - 1;\r\n                    if (latest[lastIdx].id === tempAssistantId) {\r\n                        latest[lastIdx] = { ...latest[lastIdx], content: assistantContent };\r\n                    }\r\n                    return latest;\r\n                });\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Copilot Chat API Error:', err);\r\n            toast.error(err.message || 'Ï±ÑÌåÖ ÏùëÎãµÏùÑ Î∞õÏïÑÏò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const toggleOpen = () => setIsOpen(!isOpen);\r\n\r\n    useEffect(() => {\r\n        if (messagesEndRef.current) {\r\n            messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\r\n        }\r\n    }, [messages, isOpen]);\r\n\r\n    // Simple markdown-ish rendering for the assistant\r\n    const formatMessage = (content: string) => {\r\n        // Very basic bold and line break parsing\r\n        return content.split('\\n').map((line, i) => (\r\n            <p key={i}>\r\n                {line.split(/\\\\*\\\\*(.*?)\\\\*\\\\*/g).map((part, j) =>\r\n                    j % 2 === 1 ? <strong key={j}>{part}</strong> : part\r\n                )}\r\n            </p>\r\n        ));\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <button\r\n                className={styles.fab}\r\n                onClick={toggleOpen}\r\n                aria-label=\"Open AI Copilot\"\r\n            >\r\n                {isOpen ? <X size={24} /> : <Sparkles size={24} />}\r\n            </button>\r\n\r\n            {isOpen && (\r\n                <div className={styles.panel}>\r\n                    <div className={styles.header}>\r\n                        <div className={styles.headerTitle}>\r\n                            <Bot size={20} color=\"var(--brand-primary)\" />\r\n                            <span>ProjectHub Copilot</span>\r\n                        </div>\r\n                        <button className={styles.closeBtn} onClick={toggleOpen}>\r\n                            <X size={18} />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className={styles.chatArea}>\r\n                        {messages.length === 0 && (\r\n                            <div className={styles.messageAssistant} style={{ opacity: 0.8, backgroundColor: 'transparent', border: 'none', fontStyle: 'italic' }}>\r\n                                ÏïàÎÖïÌïòÏÑ∏Ïöî! <b>{projectInfo.name}</b> ÌîÑÎ°úÏ†ùÌä∏Ïùò AI Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏ÏûÖÎãàÎã§.\r\n                                ÌîÑÎ°úÏ†ùÌä∏ ÏùºÏ†ï, ÎÇ®ÏùÄ Ïù¥Ïäà, ÏúÑÌóò ÏÇ¨Ìï≠Ïù¥ÎÇò ÏöîÏïΩÏù¥ ÌïÑÏöîÌïòÏãúÎ©¥ Î¨¥ÏóáÏù¥Îì† Î¨ºÏñ¥Î≥¥ÏÑ∏Ïöî!\r\n                            </div>\r\n                        )}\r\n                        {messages.map(m => (\r\n                            <div key={m.id} className={m.role === 'user' ? styles.messageUser : styles.messageAssistant}>\r\n                                {m.role === 'user' ? m.content : formatMessage(m.content)}\r\n                            </div>\r\n                        ))}\r\n                        {isLoading && messages.length > 0 && messages[messages.length - 1]?.role === 'user' && (\r\n                            <div className={styles.messageAssistant}>\r\n                                <div className={styles.loadingDot} />\r\n                                <div className={styles.loadingDot} />\r\n                                <div className={styles.loadingDot} />\r\n                            </div>\r\n                        )}\r\n                        <div ref={messagesEndRef} />\r\n                    </div>\r\n\r\n                    <div className={styles.inputArea}>\r\n                        <form onSubmit={handleSubmit} className={styles.form}>\r\n                            <input\r\n                                className={styles.input}\r\n                                value={localInput}\r\n                                onChange={(e) => setLocalInput(e.target.value)}\r\n                                placeholder=\"ÌîÑÎ°úÏ†ùÌä∏Ïóê ÎåÄÌï¥ ÏßàÎ¨∏ÌïòÏÑ∏Ïöî...\"\r\n                                disabled={isLoading}\r\n                            />\r\n                            <button type=\"submit\" className={styles.sendBtn} disabled={isLoading || !localInput.trim()}>\r\n                                <Send size={16} />\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\components\\HydrationGuard.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\components\\HydrationGuard.tsx:15:9\n  13 |\n  14 |     useEffect(() => {\n> 15 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  16 |     }, []);\n  17 |\n  18 |     if (!mounted) {","line":15,"column":9,"nodeType":null,"endLine":15,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\n\r\n/**\r\n * Defer rendering children until the client has mounted.\r\n * This prevents Zustand persist hydration mismatches where\r\n * the server renders with default state but the client loads\r\n * from localStorage.\r\n */\r\nexport default function HydrationGuard({ children }: { children: React.ReactNode }) {\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n    }, []);\r\n\r\n    if (!mounted) {\r\n        return (\r\n            <div style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                height: '100vh',\r\n                background: 'var(--background)',\r\n                color: 'var(--foreground-muted)',\r\n                fontSize: '0.875rem',\r\n            }}>\r\n                Loading...\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return <>{children}</>;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\components\\Sidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":190,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7112,7115],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7112,7115],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":327,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":327,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14382,14385],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14382,14385],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport Link from 'next/link';\r\nimport { usePathname } from 'next/navigation';\r\nimport { useSession, signOut } from 'next-auth/react';\r\nimport { LayoutDashboard, Calendar, AlertCircle, Users, FileText, Shield, Menu, X, BarChart3, DollarSign, ChevronDown, Plus, Settings, Trash2, CheckSquare, Rocket, Briefcase, Server, ClipboardList, LogOut, Bell } from 'lucide-react';\r\nimport { cn, generateId } from '@/lib/utils';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Modal } from '@/app/components/ui/Modal';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Project } from '@/types';\r\nimport styles from './Sidebar.module.css';\r\nimport { getInitialTasks, getDefaultPolicies } from '@/lib/templates';\r\nimport { useSupabaseSync } from '@/hooks/useSupabaseSync';\r\nimport { toast } from 'sonner';\r\n\r\nconst getNavGroups = (role: string) => {\r\n    const isAdminOrPM = role === 'Admin' || role === 'PM';\r\n\r\n    if (role === 'Client') {\r\n        return [\r\n            {\r\n                label: 'Core',\r\n                items: [\r\n                    { href: '/', label: 'Overview', icon: LayoutDashboard },\r\n                    { href: '/schedule', label: 'Schedule', icon: Calendar },\r\n                ],\r\n            },\r\n            {\r\n                label: 'Resources',\r\n                items: [\r\n                    { href: '/documents', label: 'Documents', icon: FileText },\r\n                ],\r\n            },\r\n            {\r\n                label: 'Analytics',\r\n                items: [\r\n                    { href: '/reports', label: 'Reports', icon: BarChart3 },\r\n                ],\r\n            },\r\n        ];\r\n    }\r\n\r\n    return [\r\n        {\r\n            label: 'Core',\r\n            items: [\r\n                { href: '/', label: 'Overview', icon: LayoutDashboard },\r\n                { href: '/schedule', label: 'Schedule', icon: Calendar },\r\n                { href: '/issues', label: 'Issues', icon: AlertCircle },\r\n            ],\r\n        },\r\n        {\r\n            label: 'Operations',\r\n            items: [\r\n                { href: '/actions', label: 'Actions & Decisions', icon: CheckSquare },\r\n                { href: '/releases', label: 'Releases', icon: Rocket },\r\n                ...(isAdminOrPM ? [{ href: '/assets', label: 'Assets & Systems', icon: Server }] : []),\r\n                { href: '/field-logs', label: 'Field Logs', icon: ClipboardList },\r\n            ],\r\n        },\r\n        {\r\n            label: 'Resources',\r\n            items: [\r\n                { href: '/team', label: 'Team', icon: Users },\r\n                ...(isAdminOrPM ? [\r\n                    { href: '/budget', label: 'Budget', icon: DollarSign },\r\n                    { href: '/vendors', label: 'Vendors', icon: Briefcase },\r\n                ] : []),\r\n                { href: '/documents', label: 'Documents', icon: FileText },\r\n                ...(isAdminOrPM ? [{ href: '/policies', label: 'Policies', icon: Shield }] : []),\r\n            ],\r\n        },\r\n        {\r\n            label: 'Analytics',\r\n            items: [\r\n                { href: '/reports', label: 'Reports', icon: BarChart3 },\r\n            ],\r\n        },\r\n    ];\r\n};\r\n\r\nconst inputStyle: React.CSSProperties = {\r\n    background: 'var(--input-bg)', border: '1px solid var(--input-border)',\r\n    borderRadius: 'var(--radius-sm)', padding: '0.5rem 0.75rem',\r\n    color: 'var(--foreground)', fontSize: '0.875rem', fontFamily: 'inherit', outline: 'none', width: '100%',\r\n};\r\n\r\nconst labelStyle: React.CSSProperties = {\r\n    fontSize: '0.8125rem', fontWeight: 500, color: 'var(--foreground-muted)',\r\n};\r\n\r\nexport const Sidebar = () => {\r\n    const pathname = usePathname();\r\n    const { data: session } = useSession();\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [projDropdown, setProjDropdown] = useState(false);\r\n    const [isNewProjOpen, setIsNewProjOpen] = useState(false);\r\n    const [newProjName, setNewProjName] = useState('');\r\n    const [newProjStart, setNewProjStart] = useState('');\r\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\r\n    const [isNotifOpen, setIsNotifOpen] = useState(false);\r\n\r\n    const { projects, activeProjectId, switchProject, addProject, deleteProject, projectInfo, updateProjectInfo, addActivity, fetchSupabaseData, notifications, markNotificationAsRead, markAllNotificationsAsRead } = useProject();\r\n\r\n    // Fetch initial data from Supabase once on mount\r\n    React.useEffect(() => {\r\n        if (session) {\r\n            fetchSupabaseData();\r\n        }\r\n    }, [session, fetchSupabaseData]);\r\n\r\n    // Setup real-time subscriptions\r\n    useSupabaseSync();\r\n\r\n    // Settings form state\r\n    const [sName, setSName] = useState('');\r\n    const [sDesc, setSDesc] = useState('');\r\n    const [sClient, setSClient] = useState('');\r\n    const [sManager, setSManager] = useState('');\r\n    const [sStart, setSStart] = useState('');\r\n    const [sEnd, setSEnd] = useState('');\r\n\r\n    const openSettings = () => {\r\n        setSName(projectInfo.name);\r\n        setSDesc(projectInfo.description);\r\n        setSClient(projectInfo.client);\r\n        setSManager(projectInfo.manager);\r\n        setSStart(projectInfo.startDate);\r\n        setSEnd(projectInfo.endDate);\r\n        setIsSettingsOpen(true);\r\n    };\r\n\r\n    const handleSaveSettings = () => {\r\n        updateProjectInfo({\r\n            name: sName.trim(),\r\n            description: sDesc.trim(),\r\n            client: sClient.trim(),\r\n            manager: sManager.trim(),\r\n            startDate: sStart,\r\n            endDate: sEnd,\r\n        });\r\n        addActivity({\r\n            id: generateId('act'),\r\n            timestamp: new Date().toISOString(),\r\n            action: 'Project info updated',\r\n            detail: `\"${sName.trim()}\"`,\r\n            category: 'project',\r\n        });\r\n        setIsSettingsOpen(false);\r\n    };\r\n\r\n    const handleNewProject = () => {\r\n        if (!newProjName.trim()) return;\r\n        const startDate = newProjStart || new Date().toISOString().split('T')[0];\r\n\r\n        const proj: Project = {\r\n            id: generateId('proj'),\r\n            info: { name: newProjName.trim(), description: '', client: '', startDate: startDate, endDate: '', manager: '' },\r\n            tasks: getInitialTasks(startDate),\r\n            issues: [],\r\n            members: [],\r\n            documents: [],\r\n            policies: getDefaultPolicies(),\r\n            budget: { contractAmount: 0, entries: [] },\r\n            activities: [],\r\n            risks: [],\r\n            changeRequests: [],\r\n            actionItems: [],\r\n            decisions: [],\r\n            meetings: [],\r\n            communications: [],\r\n            milestones: [],\r\n            deployments: [],\r\n            vendors: [],\r\n            procurements: [],\r\n            assets: [],\r\n            systems: [],\r\n            siteLogs: [],\r\n            notifications: [],\r\n        };\r\n        addProject(proj);\r\n        setNewProjName('');\r\n        setNewProjStart('');\r\n        setIsNewProjOpen(false);\r\n        setProjDropdown(false);\r\n    };\r\n\r\n    const userRole = (session?.user as any)?.role || 'Admin';\r\n    const navGroups = getNavGroups(userRole);\r\n    const canEditProject = userRole === 'Admin' || userRole === 'PM';\r\n\r\n    const unreadCount = notifications.filter(n => !n.read).length;\r\n\r\n    const prevNotifCount = React.useRef(notifications.length);\r\n    React.useEffect(() => {\r\n        if (notifications.length > prevNotifCount.current) {\r\n            const newNotif = notifications[0];\r\n            if (newNotif && !newNotif.read) {\r\n                toast(newNotif.title, { description: newNotif.message });\r\n            }\r\n        }\r\n        prevNotifCount.current = notifications.length;\r\n    }, [notifications]);\r\n\r\n    if (pathname === '/login') return null;\r\n\r\n    return (\r\n        <>\r\n            <button\r\n                className={styles.mobileToggle}\r\n                onClick={() => setIsOpen(!isOpen)}\r\n                aria-label=\"Toggle menu\"\r\n            >\r\n                {isOpen ? <X size={20} /> : <Menu size={20} />}\r\n            </button>\r\n\r\n            {isOpen && <div className={styles.mobileOverlay} onClick={() => setIsOpen(false)} />}\r\n\r\n            <aside className={cn(styles.sidebar, isOpen && styles.open)}>\r\n                <div className={styles.logoContainer}>\r\n                    <div className={styles.logoIcon}>AG</div>\r\n                    <h1 className={styles.logoText}>AGS ProjectHub</h1>\r\n                </div>\r\n\r\n                {/* Project Selector */}\r\n                <div className={styles.projectSelector}>\r\n                    <div\r\n                        className={styles.projectBtn}\r\n                        onClick={() => setProjDropdown(!projDropdown)}\r\n                        role=\"button\"\r\n                        tabIndex={0}\r\n                    >\r\n                        <span className={styles.projectName}>{projectInfo.name || 'Select Project'}</span>\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                            {canEditProject && (\r\n                                <button\r\n                                    className={styles.settingsBtn}\r\n                                    onClick={(e) => { e.stopPropagation(); openSettings(); }}\r\n                                    title=\"Project Settings\"\r\n                                >\r\n                                    <Settings size={13} />\r\n                                </button>\r\n                            )}\r\n                            <ChevronDown size={14} className={cn(styles.projChevron, projDropdown && styles.projChevronOpen)} />\r\n                        </div>\r\n                    </div>\r\n                    {projDropdown && (\r\n                        <div className={styles.projectDropdown}>\r\n                            {projects.map((proj) => (\r\n                                <div\r\n                                    key={proj.id}\r\n                                    className={cn(styles.projectOption, proj.id === activeProjectId && styles.projectOptionActive)}\r\n                                    onClick={() => { switchProject(proj.id); setProjDropdown(false); }}\r\n                                >\r\n                                    <span>{proj.info.name}</span>\r\n                                    {canEditProject && projects.length > 1 && proj.id !== activeProjectId && (\r\n                                        <button\r\n                                            className={styles.projDeleteBtn}\r\n                                            onClick={(e) => { e.stopPropagation(); deleteProject(proj.id); }}\r\n                                            title=\"Delete project\"\r\n                                        >\r\n                                            <Trash2 size={12} />\r\n                                        </button>\r\n                                    )}\r\n                                </div>\r\n                            ))}\r\n                            {canEditProject && (\r\n                                <button\r\n                                    className={styles.newProjectBtn}\r\n                                    onClick={() => { setIsNewProjOpen(true); setProjDropdown(false); }}\r\n                                >\r\n                                    <Plus size={14} /> New Project\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <nav className={styles.nav}>\r\n                    {navGroups.map((group) => (\r\n                        <div key={group.label} className={styles.navGroup}>\r\n                            <span className={styles.navGroupLabel}>{group.label}</span>\r\n                            {group.items.map((item) => {\r\n                                const isActive = pathname === item.href;\r\n                                const Icon = item.icon;\r\n                                return (\r\n                                    <Link\r\n                                        key={item.href}\r\n                                        href={item.href}\r\n                                        className={cn(styles.navItem, isActive && styles.active)}\r\n                                        onClick={() => setIsOpen(false)}\r\n                                    >\r\n                                        {isActive && <div className={styles.activeIndicator} />}\r\n                                        <Icon size={18} className={styles.icon} />\r\n                                        <span>{item.label}</span>\r\n                                    </Link>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    ))}\r\n                </nav>\r\n\r\n                <div className={styles.footer}>\r\n                    <div style={{ padding: '0 1rem', marginBottom: '0.5rem' }}>\r\n                        <button\r\n                            className={styles.navItem}\r\n                            style={{ width: '100%', display: 'flex', justifyContent: 'space-between', border: 'none', background: 'transparent' }}\r\n                            onClick={() => setIsNotifOpen(true)}\r\n                        >\r\n                            <div style={{ display: 'flex', gap: '0.75rem', alignItems: 'center' }}>\r\n                                <Bell size={18} className={styles.icon} />\r\n                                <span>Notifications</span>\r\n                            </div>\r\n                            {unreadCount > 0 && (\r\n                                <span style={{ background: 'var(--brand-primary)', color: 'white', fontSize: '0.75rem', padding: '0.1rem 0.4rem', borderRadius: '1rem' }}>\r\n                                    {unreadCount}\r\n                                </span>\r\n                            )}\r\n                        </button>\r\n                    </div>\r\n                    <div className={styles.userProfile}>\r\n                        <div className={styles.avatar}>{session?.user?.name?.charAt(0) || 'U'}</div>\r\n                        <div className={styles.userInfo}>\r\n                            <p className={styles.userName}>{session?.user?.name || 'User'}</p>\r\n                            <p className={styles.userRole}>{(session?.user as any)?.role || 'AGS'}</p>\r\n                        </div>\r\n                        <button\r\n                            onClick={() => signOut({ callbackUrl: '/login' })}\r\n                            style={{ background: 'none', border: 'none', color: 'var(--foreground-muted)', cursor: 'pointer', padding: '0.25rem', display: 'flex' }}\r\n                            title=\"Sign Out\"\r\n                        >\r\n                            <LogOut size={16} />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* New Project Modal */}\r\n            <Modal isOpen={isNewProjOpen} onClose={() => setIsNewProjOpen(false)} title=\"Create New Project\">\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.375rem' }}>\r\n                        <label style={labelStyle}>Project Name *</label>\r\n                        <input\r\n                            style={inputStyle}\r\n                            value={newProjName}\r\n                            onChange={(e) => setNewProjName(e.target.value)}\r\n                            placeholder=\"Enter project name\"\r\n                            onKeyDown={(e) => e.key === 'Enter' && handleNewProject()}\r\n                            autoFocus\r\n                        />\r\n                    </div>\r\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.375rem' }}>\r\n                        <label style={labelStyle}>Start Date</label>\r\n                        <input\r\n                            type=\"date\"\r\n                            style={inputStyle}\r\n                            value={newProjStart}\r\n                            onChange={(e) => setNewProjStart(e.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '0.75rem' }}>\r\n                        <Button variant=\"ghost\" onClick={() => setIsNewProjOpen(false)}>Cancel</Button>\r\n                        <Button onClick={handleNewProject}>Create</Button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* Project Settings Modal */}\r\n            <Modal isOpen={isSettingsOpen} onClose={() => setIsSettingsOpen(false)} title=\"Project Settings\">\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.875rem' }}>\r\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\r\n                        <label style={labelStyle}>Project Name</label>\r\n                        <input style={inputStyle} value={sName} onChange={(e) => setSName(e.target.value)} />\r\n                    </div>\r\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\r\n                        <label style={labelStyle}>Description</label>\r\n                        <input style={inputStyle} value={sDesc} onChange={(e) => setSDesc(e.target.value)} placeholder=\"Short project description\" />\r\n                    </div>\r\n                    <div style={{ display: 'flex', gap: '0.75rem' }}>\r\n                        <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\r\n                            <label style={labelStyle}>Client</label>\r\n                            <input style={inputStyle} value={sClient} onChange={(e) => setSClient(e.target.value)} />\r\n                        </div>\r\n                        <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\r\n                            <label style={labelStyle}>Manager</label>\r\n                            <input style={inputStyle} value={sManager} onChange={(e) => setSManager(e.target.value)} />\r\n                        </div>\r\n                    </div>\r\n                    <div style={{ display: 'flex', gap: '0.75rem' }}>\r\n                        <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\r\n                            <label style={labelStyle}>Start Date</label>\r\n                            <input type=\"date\" style={inputStyle} value={sStart} onChange={(e) => setSStart(e.target.value)} />\r\n                        </div>\r\n                        <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\r\n                            <label style={labelStyle}>End Date</label>\r\n                            <input type=\"date\" style={inputStyle} value={sEnd} onChange={(e) => setSEnd(e.target.value)} />\r\n                        </div>\r\n                    </div>\r\n                    <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '0.75rem', marginTop: '0.5rem' }}>\r\n                        <Button variant=\"ghost\" onClick={() => setIsSettingsOpen(false)}>Cancel</Button>\r\n                        <Button onClick={handleSaveSettings}>Save Changes</Button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* Notifications Modal */}\r\n            <Modal isOpen={isNotifOpen} onClose={() => setIsNotifOpen(false)} title=\"Notifications\">\r\n                <div style={{ display: 'flex', justifyContent: 'flex-end', marginBottom: '1rem' }}>\r\n                    <Button variant=\"ghost\" size=\"sm\" onClick={() => markAllNotificationsAsRead()}>\r\n                        Mark all as read\r\n                    </Button>\r\n                </div>\r\n                {notifications.length === 0 ? (\r\n                    <p style={{ color: 'var(--text-muted)' }}>No notifications yet.</p>\r\n                ) : (\r\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', maxHeight: '60vh', overflowY: 'auto' }}>\r\n                        {notifications.map(n => (\r\n                            <div key={n.id} style={{ padding: '0.75rem', background: n.read ? 'transparent' : 'var(--surface-2)', border: '1px solid var(--border-color)', borderRadius: '0.5rem', display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                                <div style={{ flex: 1 }}>\r\n                                    <h4 style={{ margin: '0 0 0.25rem 0', fontSize: '0.875rem', fontWeight: n.read ? 500 : 700, color: 'var(--foreground)' }}>{n.title}</h4>\r\n                                    <p style={{ margin: 0, fontSize: '0.8125rem', color: 'var(--text-muted)' }}>{n.message}</p>\r\n                                    <span style={{ fontSize: '0.7rem', color: 'var(--text-muted)', display: 'block', marginTop: '0.5rem' }}>{new Date(n.timestamp).toLocaleString()}</span>\r\n                                </div>\r\n                                {!n.read && (\r\n                                    <button onClick={() => markNotificationAsRead(n.id)} style={{ background: 'none', border: 'none', color: 'var(--brand-primary)', cursor: 'pointer', fontSize: '0.75rem', padding: '0.25rem' }}>Mark read</button>\r\n                                )}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n        </>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\components\\ui\\Badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\components\\ui\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\components\\ui\\Card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\components\\ui\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\documents\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\field-logs\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":9,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":63,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"FileText"},"fix":{"range":[369,379],"text":""},"desc":"Remove unused variable \"FileText\"."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":99,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[3445,3570],"text":"\r\n                        No field logs recorded yet. Click &quot;New Daily Log\" to create your first entry.\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[3445,3570],"text":"\r\n                        No field logs recorded yet. Click &ldquo;New Daily Log\" to create your first entry.\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[3445,3570],"text":"\r\n                        No field logs recorded yet. Click &#34;New Daily Log\" to create your first entry.\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[3445,3570],"text":"\r\n                        No field logs recorded yet. Click &rdquo;New Daily Log\" to create your first entry.\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":99,"column":73,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[3445,3570],"text":"\r\n                        No field logs recorded yet. Click \"New Daily Log&quot; to create your first entry.\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[3445,3570],"text":"\r\n                        No field logs recorded yet. Click \"New Daily Log&ldquo; to create your first entry.\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[3445,3570],"text":"\r\n                        No field logs recorded yet. Click \"New Daily Log&#34; to create your first entry.\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[3445,3570],"text":"\r\n                        No field logs recorded yet. Click \"New Daily Log&rdquo; to create your first entry.\r\n                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Card } from '@/app/components/ui/Card';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Modal } from '@/app/components/ui/Modal';\r\nimport { Badge } from '@/app/components/ui/Badge';\r\nimport { ClipboardList, Plus, Calendar, Cloud, Users, FileText, AlertCircle, ShieldAlert, Trash2 } from 'lucide-react';\r\nimport styles from './page.module.css';\r\nimport { cn, generateId } from '@/lib/utils';\r\nimport { SiteLog, WeatherCondition } from '@/types';\r\n\r\nexport default function FieldLogsPage() {\r\n    const {\r\n        siteLogs = [],\r\n        issues = [],\r\n        risks = [],\r\n        members = [],\r\n        addSiteLog,\r\n        updateSiteLog,\r\n        deleteSiteLog,\r\n    } = useProject();\r\n\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n    const [editId, setEditId] = useState<string | null>(null);\r\n\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    const [form, setForm] = useState<Partial<SiteLog>>({\r\n        date: today,\r\n        loggerId: '',\r\n        weather: { condition: 'Clear', temperature: undefined },\r\n        personnelCount: 0,\r\n        workSummary: '',\r\n        relatedIssueIds: [],\r\n        relatedRiskIds: []\r\n    });\r\n\r\n    const openModal = (log?: SiteLog) => {\r\n        if (log) {\r\n            setEditId(log.id);\r\n            setForm(log);\r\n        } else {\r\n            setEditId(null);\r\n            setForm({\r\n                date: today,\r\n                loggerId: '',\r\n                weather: { condition: 'Clear', temperature: undefined },\r\n                personnelCount: 0,\r\n                workSummary: '',\r\n                relatedIssueIds: [],\r\n                relatedRiskIds: []\r\n            });\r\n        }\r\n        setIsModalOpen(true);\r\n    };\r\n\r\n    const handleSave = () => {\r\n        if (!form.date || !form.workSummary) return;\r\n\r\n        if (editId) {\r\n            updateSiteLog(editId, { ...form, updatedAt: new Date().toISOString() });\r\n        } else {\r\n            addSiteLog({\r\n                id: generateId('log'),\r\n                date: form.date,\r\n                loggerId: form.loggerId || 'unassigned',\r\n                weather: form.weather,\r\n                personnelCount: form.personnelCount,\r\n                workSummary: form.workSummary,\r\n                relatedIssueIds: form.relatedIssueIds,\r\n                relatedRiskIds: form.relatedRiskIds,\r\n                createdAt: new Date().toISOString(),\r\n                updatedAt: new Date().toISOString()\r\n            });\r\n        }\r\n        setIsModalOpen(false);\r\n    };\r\n\r\n    // Sort logs descending by date\r\n    const sortedLogs = [...siteLogs].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <header className={styles.header}>\r\n                <div>\r\n                    <h1 className={styles.title}>Field & Site Logs</h1>\r\n                    <p className={styles.subtitle}>Daily tracking of site conditions, personnel, and work progress</p>\r\n                </div>\r\n                <Button onClick={() => openModal()}>\r\n                    <Plus size={16} /> New Daily Log\r\n                </Button>\r\n            </header>\r\n\r\n            <div className={styles.list}>\r\n                {sortedLogs.length === 0 ? (\r\n                    <div className={styles.emptyState}>\r\n                        No field logs recorded yet. Click \"New Daily Log\" to create your first entry.\r\n                    </div>\r\n                ) : (\r\n                    sortedLogs.map(log => {\r\n                        const logger = members.find(m => m.id === log.loggerId);\r\n                        const linkedIssues = issues.filter(i => log.relatedIssueIds?.includes(i.id));\r\n                        const linkedRisks = risks.filter(r => log.relatedRiskIds?.includes(r.id));\r\n\r\n                        return (\r\n                            <Card key={log.id} className={styles.card}>\r\n                                <div className={styles.cardHeader}>\r\n                                    <div>\r\n                                        <h3 className={styles.cardTitle}>\r\n                                            <Calendar size={16} /> {log.date}\r\n                                        </h3>\r\n                                        <div className={styles.cardMeta}>\r\n                                            {logger && (\r\n                                                <span><Users size={14} /> Logged by: {logger.name}</span>\r\n                                            )}\r\n                                            {log.personnelCount !== undefined && log.personnelCount > 0 && (\r\n                                                <span><Users size={14} /> Workers on site: {log.personnelCount}</span>\r\n                                            )}\r\n                                            {log.weather && (\r\n                                                <span className={styles.weatherBadge}>\r\n                                                    <Cloud size={12} />\r\n                                                    {log.weather.condition} {log.weather.temperature !== undefined ? `(${log.weather.temperature}¬∞C)` : ''}\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className={styles.actions}>\r\n                                        <button className={styles.iconBtn} onClick={() => openModal(log)} title=\"Edit Log\">\r\n                                            <ClipboardList size={16} />\r\n                                        </button>\r\n                                        <button className={cn(styles.iconBtn, styles.deleteBtn)} onClick={() => deleteSiteLog(log.id)} title=\"Delete Log\">\r\n                                            <Trash2 size={16} />\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className={styles.workSummary}>\r\n                                    {log.workSummary}\r\n                                </div>\r\n\r\n                                {(linkedIssues.length > 0 || linkedRisks.length > 0) && (\r\n                                    <div style={{ marginTop: '0.5rem', display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>\r\n                                        {linkedIssues.map(i => (\r\n                                            <span key={i.id} title={i.title}>\r\n                                                <Badge variant=\"danger\">\r\n                                                    <AlertCircle size={12} style={{ marginRight: '4px', display: 'inline' }} />\r\n                                                    Issue: {i.id}\r\n                                                </Badge>\r\n                                            </span>\r\n                                        ))}\r\n                                        {linkedRisks.map(r => (\r\n                                            <span key={r.id} title={r.title}>\r\n                                                <Badge variant=\"warning\">\r\n                                                    <ShieldAlert size={12} style={{ marginRight: '4px', display: 'inline' }} />\r\n                                                    Risk: {r.id}\r\n                                                </Badge>\r\n                                            </span>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </Card>\r\n                        )\r\n                    })\r\n                )}\r\n            </div>\r\n\r\n            {/* Modal Form */}\r\n            <Modal isOpen={isModalOpen} onClose={() => setIsModalOpen(false)} title={editId ? \"Edit Daily Log\" : \"New Daily Site Log\"}>\r\n                <div className={styles.form}>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Date *</label>\r\n                            <input className={styles.input} type=\"date\" value={form.date} onChange={e => setForm({ ...form, date: e.target.value })} />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Logger (Author)</label>\r\n                            <select className={styles.select} value={form.loggerId || ''} onChange={e => setForm({ ...form, loggerId: e.target.value })}>\r\n                                <option value=\"\">‚Äî Select Member ‚Äî</option>\r\n                                {members.map(m => <option key={m.id} value={m.id}>{m.name}</option>)}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup} style={{ flex: 2 }}>\r\n                            <label>Weather Condition</label>\r\n                            <select\r\n                                className={styles.select}\r\n                                value={form.weather?.condition || 'Clear'}\r\n                                onChange={e => setForm({ ...form, weather: { ...form.weather, condition: e.target.value as WeatherCondition['condition'] } })}\r\n                            >\r\n                                <option value=\"Clear\">Clear</option>\r\n                                <option value=\"Sunny\">Sunny</option>\r\n                                <option value=\"Cloudy\">Cloudy</option>\r\n                                <option value=\"Rain\">Rain</option>\r\n                                <option value=\"Snow\">Snow</option>\r\n                                <option value=\"Windy\">Windy</option>\r\n                                <option value=\"Other\">Other</option>\r\n                            </select>\r\n                        </div>\r\n                        <div className={styles.formGroup} style={{ flex: 1 }}>\r\n                            <label>Temp (¬∞C)</label>\r\n                            <input\r\n                                className={styles.input}\r\n                                type=\"number\"\r\n                                value={form.weather?.temperature ?? ''}\r\n                                onChange={e => setForm({ ...form, weather: { ...form.weather, temperature: e.target.value ? Number(e.target.value) : undefined } as WeatherCondition })}\r\n                                placeholder=\"e.g. 24\"\r\n                            />\r\n                        </div>\r\n                        <div className={styles.formGroup} style={{ flex: 1 }}>\r\n                            <label>Personnel</label>\r\n                            <input\r\n                                className={styles.input}\r\n                                type=\"number\"\r\n                                min=\"0\"\r\n                                value={form.personnelCount ?? 0}\r\n                                onChange={e => setForm({ ...form, personnelCount: Number(e.target.value) })}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={styles.formGroup}>\r\n                        <label>Work Summary *</label>\r\n                        <textarea\r\n                            className={styles.textarea}\r\n                            value={form.workSummary}\r\n                            onChange={e => setForm({ ...form, workSummary: e.target.value })}\r\n                            placeholder=\"Describe the tasks completed, visitors, deliveries, and overall progress...\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className={styles.formGroup}>\r\n                        <label>Related Issues</label>\r\n                        <select\r\n                            className={styles.select}\r\n                            multiple\r\n                            size={3}\r\n                            value={form.relatedIssueIds || []}\r\n                            onChange={e => {\r\n                                const options = Array.from(e.target.selectedOptions, option => option.value);\r\n                                setForm({ ...form, relatedIssueIds: options });\r\n                            }}\r\n                        >\r\n                            {issues.map(i => <option key={i.id} value={i.id}>{i.title}</option>)}\r\n                        </select>\r\n                        <span style={{ fontSize: '0.75rem', color: 'var(--foreground-muted)' }}>Hold Ctrl/Cmd to select multiple</span>\r\n                    </div>\r\n\r\n                    <div className={styles.formGroup}>\r\n                        <label>Related Risks</label>\r\n                        <select\r\n                            className={styles.select}\r\n                            multiple\r\n                            size={3}\r\n                            value={form.relatedRiskIds || []}\r\n                            onChange={e => {\r\n                                const options = Array.from(e.target.selectedOptions, option => option.value);\r\n                                setForm({ ...form, relatedRiskIds: options });\r\n                            }}\r\n                        >\r\n                            {risks.map(r => <option key={r.id} value={r.id}>{r.title}</option>)}\r\n                        </select>\r\n                        <span style={{ fontSize: '0.75rem', color: 'var(--foreground-muted)' }}>Hold Ctrl/Cmd to select multiple</span>\r\n                    </div>\r\n\r\n                    <div className={styles.formActions}>\r\n                        <Button variant=\"ghost\" onClick={() => setIsModalOpen(false)}>Cancel</Button>\r\n                        <Button onClick={handleSave}>Save Log</Button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\issues\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'tasks' is assigned a value but never used.","line":27,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":54},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":160,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9091,9094],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9091,9094],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":185,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10735,10738],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10735,10738],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useMemo } from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Card } from '@/app/components/ui/Card';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Modal } from '@/app/components/ui/Modal';\r\nimport { Badge } from '@/app/components/ui/Badge';\r\nimport { Plus, Trash2, Pencil, ChevronRight, ShieldAlert, GitPullRequest, Bot, Loader2 } from 'lucide-react';\r\nimport { generateId } from '@/lib/utils';\r\nimport { Issue, IssueStatus, Risk, RiskStatus, ChangeRequest, CRStatus } from '@/types';\r\nimport styles from './page.module.css';\r\nimport { cn } from '@/lib/utils';\r\nimport { toast } from 'sonner';\r\n\r\ntype TabType = 'issues' | 'risks' | 'changes';\r\n\r\nconst STATUS_CYCLE: IssueStatus[] = ['New', 'Triaged', 'In Progress', 'Resolved', 'Closed'];\r\nconst RISK_STATUS_CYCLE: RiskStatus[] = ['Open', 'Monitoring', 'Closed'];\r\nconst CR_STATUS_CYCLE: CRStatus[] = ['Pending', 'Approved', 'Rejected', 'Implemented'];\r\nconst FILTERS = ['All', 'Open', 'High Priority', 'Resolved'] as const;\r\nconst RISK_FILTERS = ['All', 'Open', 'High', 'Review Due'] as const;\r\nconst CR_FILTERS = ['All', 'Pending', 'Approved', 'Implemented'] as const;\r\n\r\nexport default function IssuesPage() {\r\n    const {\r\n        issues, risks, changeRequests, members, tasks,\r\n        addIssue, updateIssue, deleteIssue,\r\n        addRisk, updateRisk, deleteRisk,\r\n        addChangeRequest, updateChangeRequest, deleteChangeRequest,\r\n        addActivity,\r\n    } = useProject();\r\n\r\n    const [activeTab, setActiveTab] = useState<TabType>('issues');\r\n    const [filter, setFilter] = useState<typeof FILTERS[number]>('All');\r\n    const [riskFilter, setRiskFilter] = useState<typeof RISK_FILTERS[number]>('All');\r\n    const [crFilter, setCrFilter] = useState<typeof CR_FILTERS[number]>('All');\r\n\r\n    // ‚îÄ‚îÄ Issue state ‚îÄ‚îÄ\r\n    const [isAddOpen, setIsAddOpen] = useState(false);\r\n    const [editIssue, setEditIssue] = useState<Issue | null>(null);\r\n    const defaultNew = { title: '', description: '', severity: 'S3' as Issue['severity'], ownerId: '', relatedTaskId: '', occurredDate: '' };\r\n    const [newIssue, setNewIssue] = useState(defaultNew);\r\n\r\n    // ‚îÄ‚îÄ Risk state ‚îÄ‚îÄ\r\n    const [isRiskAddOpen, setIsRiskAddOpen] = useState(false);\r\n    const [editRisk, setEditRisk] = useState<Risk | null>(null);\r\n    const defaultRisk = { title: '', probability: 'Medium' as Risk['probability'], impact: 'Medium' as Risk['impact'], ownerId: '', mitigation: '', identifiedDate: '' };\r\n    const [newRisk, setNewRisk] = useState(defaultRisk);\r\n\r\n    // ‚îÄ‚îÄ CR state ‚îÄ‚îÄ\r\n    const [isCRAddOpen, setIsCRAddOpen] = useState(false);\r\n    const [editCR, setEditCR] = useState<ChangeRequest | null>(null);\r\n    const defaultCR = { title: '', requester: '', changeType: 'Scope' as ChangeRequest['changeType'], impactSummary: '', requestDate: '', reference: '', status: 'Pending' as ChangeRequest['status'] };\r\n    const [newCR, setNewCR] = useState(defaultCR);\r\n\r\n    // ‚îÄ‚îÄ AI State ‚îÄ‚îÄ\r\n    const [isAILoading, setIsAILoading] = useState(false);\r\n\r\n    // ‚îÄ‚îÄ Issues filtered ‚îÄ‚îÄ\r\n    const filteredIssues = useMemo(() => {\r\n        switch (filter) {\r\n            case 'Open': return issues.filter(i => i.status !== 'Resolved' && i.status !== 'Closed');\r\n            case 'High Priority': return issues.filter(i => i.severity === 'S1' || i.severity === 'S2');\r\n            case 'Resolved': return issues.filter(i => i.status === 'Resolved' || i.status === 'Closed');\r\n            default: return issues;\r\n        }\r\n    }, [issues, filter]);\r\n\r\n    const filteredRisks = useMemo(() => {\r\n        const safeRisks = risks || [];\r\n        switch (riskFilter) {\r\n            case 'Open': return safeRisks.filter(r => r.status === 'Open');\r\n            case 'High': return safeRisks.filter(r => r.probability === 'High' && r.impact === 'High');\r\n            case 'Review Due': return safeRisks.filter(r => r.status === 'Open'); // Simple proxy for Review Due\r\n            default: return safeRisks;\r\n        }\r\n    }, [risks, riskFilter]);\r\n\r\n    const filteredCRs = useMemo(() => {\r\n        const safeCRs = changeRequests || [];\r\n        switch (crFilter) {\r\n            case 'Pending': return safeCRs.filter(c => c.status === 'Pending');\r\n            case 'Approved': return safeCRs.filter(c => c.status === 'Approved');\r\n            case 'Implemented': return safeCRs.filter(c => c.status === 'Implemented');\r\n            default: return safeCRs;\r\n        }\r\n    }, [changeRequests, crFilter]);\r\n\r\n    const findMember = (id?: string) => members.find(m => m.id === id)?.name || '‚Äî';\r\n\r\n    const cycleStatus = (issue: Issue) => {\r\n        const idx = STATUS_CYCLE.indexOf(issue.status);\r\n        updateIssue(issue.id, { status: STATUS_CYCLE[(idx + 1) % STATUS_CYCLE.length] });\r\n    };\r\n    const cycleRiskStatus = (risk: Risk) => {\r\n        const idx = RISK_STATUS_CYCLE.indexOf(risk.status);\r\n        updateRisk(risk.id, { status: RISK_STATUS_CYCLE[(idx + 1) % RISK_STATUS_CYCLE.length] });\r\n    };\r\n    const cycleCRStatus = (cr: ChangeRequest) => {\r\n        const idx = CR_STATUS_CYCLE.indexOf(cr.status);\r\n        updateChangeRequest(cr.id, { status: CR_STATUS_CYCLE[(idx + 1) % CR_STATUS_CYCLE.length] });\r\n    };\r\n\r\n    const statusClass = (s: IssueStatus) => {\r\n        const map: Record<IssueStatus, string> = { 'New': styles.statusNew, 'Triaged': styles.statusTriaged, 'In Progress': styles.statusInProgress, 'Resolved': styles.statusResolved, 'Closed': styles.statusClosed };\r\n        return map[s];\r\n    };\r\n    const riskStatusClass = (s: RiskStatus) => {\r\n        const map: Record<RiskStatus, string> = { 'Open': styles.riskOpen, 'Monitoring': styles.riskMonitoring, 'Closed': styles.riskClosed };\r\n        return map[s];\r\n    };\r\n    const crStatusClass = (s: CRStatus) => {\r\n        const map: Record<CRStatus, string> = { 'Pending': styles.crPending, 'Approved': styles.crApproved, 'Rejected': styles.crRejected, 'Implemented': styles.crImplemented };\r\n        return map[s];\r\n    };\r\n    const probImpactClass = (v: string) => {\r\n        const map: Record<string, string> = { 'Low': styles.probLow, 'Medium': styles.probMedium, 'High': styles.probHigh };\r\n        return map[v];\r\n    };\r\n\r\n    // ‚îÄ‚îÄ Handlers ‚îÄ‚îÄ\r\n    const handleAddIssue = () => {\r\n        if (!newIssue.title) return;\r\n        addIssue({ id: generateId('i'), title: newIssue.title, description: newIssue.description, severity: newIssue.severity, status: 'New', createdAt: newIssue.occurredDate || new Date().toISOString().split('T')[0], ownerId: newIssue.ownerId || undefined, relatedTaskId: newIssue.relatedTaskId || undefined });\r\n        addActivity({ id: generateId('act'), timestamp: new Date().toISOString(), action: 'Issue created', detail: `\"${newIssue.title}\"`, category: 'issue' });\r\n        setNewIssue(defaultNew); setIsAddOpen(false);\r\n    };\r\n    const handleEditSave = () => {\r\n        if (!editIssue) return;\r\n        updateIssue(editIssue.id, { title: editIssue.title, description: editIssue.description, severity: editIssue.severity, ownerId: editIssue.ownerId || undefined });\r\n        setEditIssue(null);\r\n    };\r\n    const handleAddRisk = () => {\r\n        if (!newRisk.title) return;\r\n        const now = new Date().toISOString();\r\n        addRisk({ id: generateId('rsk'), title: newRisk.title, probability: newRisk.probability, impact: newRisk.impact, status: 'Open', ownerId: newRisk.ownerId || undefined, mitigation: newRisk.mitigation || undefined, createdAt: newRisk.identifiedDate || now.split('T')[0], updatedAt: now });\r\n        addActivity({ id: generateId('act'), timestamp: now, action: 'Risk registered', detail: `\"${newRisk.title}\"`, category: 'risk' });\r\n        setNewRisk(defaultRisk); setIsRiskAddOpen(false);\r\n    };\r\n    const handleEditRiskSave = () => {\r\n        if (!editRisk) return;\r\n        updateRisk(editRisk.id, { title: editRisk.title, probability: editRisk.probability, impact: editRisk.impact, ownerId: editRisk.ownerId, mitigation: editRisk.mitigation, updatedAt: new Date().toISOString() });\r\n        setEditRisk(null);\r\n    };\r\n    const handleAddCR = () => {\r\n        if (!newCR.title) return;\r\n        const now = new Date().toISOString();\r\n        addChangeRequest({ id: generateId('cr'), title: newCR.title, requestDate: newCR.requestDate || now.split('T')[0], requester: newCR.requester, changeType: newCR.changeType, impactSummary: newCR.impactSummary || undefined, reference: newCR.reference || undefined, status: newCR.status, createdAt: now });\r\n        addActivity({ id: generateId('act'), timestamp: now, action: 'CR submitted', detail: `\"${newCR.title}\"`, category: 'cr' });\r\n        setNewCR(defaultCR); setIsCRAddOpen(false);\r\n    };\r\n    const handleEditCRSave = () => {\r\n        if (!editCR) return;\r\n        updateChangeRequest(editCR.id, { title: editCR.title, requester: editCR.requester, changeType: editCR.changeType, impactSummary: editCR.impactSummary, status: editCR.status });\r\n        setEditCR(null);\r\n    };\r\n\r\n    // ‚îÄ‚îÄ AI Handlers ‚îÄ‚îÄ\r\n    const handleGenerateAI = async (type: 'issue' | 'risk', entity: any, isEdit: boolean) => {\r\n        setIsAILoading(true);\r\n        try {\r\n            const contextMsg = type === 'issue'\r\n                ? `Issue: ${entity.title}, Severity: ${entity.severity}. Provide a concise 2-sentence resolution plan.`\r\n                : `Risk: ${entity.title}, Probability: ${entity.probability}, Impact: ${entity.impact}. Provide a short mitigation strategy.`;\r\n\r\n            const res = await fetch('/api/generate-action', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ prompt: 'Please recommend an action plan.', context: contextMsg })\r\n            });\r\n            const data = await res.json();\r\n            if (!res.ok) {\r\n                throw new Error(data.error || 'Failed to generate AI action');\r\n            }\r\n            if (data.text) {\r\n                if (type === 'issue') {\r\n                    if (isEdit && editIssue) setEditIssue({ ...editIssue, description: (editIssue.description ? editIssue.description + '\\n\\n' : '') + `[AI Ï†úÏïà]\\n${data.text}` });\r\n                    else setNewIssue({ ...newIssue, description: (newIssue.description ? newIssue.description + '\\n\\n' : '') + `[AI Ï†úÏïà]\\n${data.text}` });\r\n                } else if (type === 'risk') {\r\n                    if (isEdit && editRisk) setEditRisk({ ...editRisk, mitigation: (editRisk.mitigation ? editRisk.mitigation + '\\n\\n' : '') + data.text });\r\n                    else setNewRisk({ ...newRisk, mitigation: (newRisk.mitigation ? newRisk.mitigation + '\\n\\n' : '') + data.text });\r\n                }\r\n            }\r\n        } catch (e: any) {\r\n            console.error(e);\r\n            toast.error(e.message || 'AI Ï†úÏïà ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. API ÌÇ§ ÌÅ¨Î†àÎîßÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî.');\r\n        } finally {\r\n            setIsAILoading(false);\r\n        }\r\n    };\r\n\r\n    // ‚îÄ‚îÄ Risk heatmap calculation ‚îÄ‚îÄ\r\n    const heatmap = useMemo(() => {\r\n        const openRisks = (risks || []).filter(r => r.status !== 'Closed');\r\n        const grid: Record<string, number> = {};\r\n        const probs = ['High', 'Medium', 'Low'] as const;\r\n        const impacts = ['Low', 'Medium', 'High'] as const;\r\n        probs.forEach(p => impacts.forEach(i => { grid[`${p}-${i}`] = 0; }));\r\n        openRisks.forEach(r => { grid[`${r.probability}-${r.impact}`]++; });\r\n        return { grid, probs, impacts };\r\n    }, [risks]);\r\n\r\n    const heatColor = (prob: string, impact: string) => {\r\n        const score = (['Low', 'Medium', 'High'].indexOf(prob)) + (['Low', 'Medium', 'High'].indexOf(impact));\r\n        if (score >= 4) return styles.heatRed;\r\n        if (score >= 3) return styles.heatOrange;\r\n        if (score >= 2) return styles.heatYellow;\r\n        return styles.heatGreen;\r\n    };\r\n\r\n    // ‚îÄ‚îÄ Get add button + header by tab ‚îÄ‚îÄ\r\n    const tabConfig = {\r\n        issues: { title: 'Issues', subtitle: `${issues.length} total issues`, addLabel: 'Report Issue', onAdd: () => setIsAddOpen(true) },\r\n        risks: { title: 'Risks', subtitle: `${(risks || []).length} total risks`, addLabel: 'Add Risk', onAdd: () => setIsRiskAddOpen(true) },\r\n        changes: { title: 'Change Requests', subtitle: `${(changeRequests || []).length} total CRs`, addLabel: 'Submit CR', onAdd: () => setIsCRAddOpen(true) },\r\n    };\r\n    const tc = tabConfig[activeTab];\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <header className={styles.header}>\r\n                <div className={styles.headerLeft}>\r\n                    <h1 className={styles.title}>{tc.title}</h1>\r\n                    <p className={styles.subtitle}>{tc.subtitle}</p>\r\n                </div>\r\n                <Button size=\"sm\" onClick={tc.onAdd}><Plus size={14} /> {tc.addLabel}</Button>\r\n            </header>\r\n\r\n            {/* Tabs */}\r\n            <div className={styles.tabBar}>\r\n                <button className={cn(styles.tabBtn, activeTab === 'issues' && styles.tabActive)} onClick={() => setActiveTab('issues')}>\r\n                    Issues <span className={styles.tabCount}>{issues.length}</span>\r\n                </button>\r\n                <button className={cn(styles.tabBtn, activeTab === 'risks' && styles.tabActive)} onClick={() => setActiveTab('risks')}>\r\n                    <ShieldAlert size={14} /> Risks <span className={styles.tabCount}>{(risks || []).length}</span>\r\n                </button>\r\n                <button className={cn(styles.tabBtn, activeTab === 'changes' && styles.tabActive)} onClick={() => setActiveTab('changes')}>\r\n                    <GitPullRequest size={14} /> Changes <span className={styles.tabCount}>{(changeRequests || []).length}</span>\r\n                </button>\r\n            </div>\r\n\r\n            {/* ‚ïê‚ïê‚ïê ISSUES TAB ‚ïê‚ïê‚ïê */}\r\n            {activeTab === 'issues' && (\r\n                <>\r\n                    <div className={styles.filterBar}>\r\n                        {FILTERS.map(f => (\r\n                            <button key={f} className={cn(styles.filterBtn, filter === f && styles.filterActive)} onClick={() => setFilter(f)}>\r\n                                {f}{f === 'All' && <span className={styles.filterCount}>{issues.length}</span>}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                    {filteredIssues.length === 0 ? (\r\n                        <Card><div className={styles.emptyState}>\r\n                            No issues found. <Button variant=\"ghost\" size=\"sm\" onClick={() => setIsAddOpen(true)} style={{ marginTop: '0.5rem' }}>Report first issue</Button>\r\n                        </div></Card>\r\n                    ) : (\r\n                        <div className={styles.issueList}>\r\n                            {filteredIssues.map(issue => (\r\n                                <Card key={issue.id} className={styles.issueCard}>\r\n                                    <div className={styles.issueTop}>\r\n                                        <div className={styles.issueLeft}>\r\n                                            <Badge variant={issue.severity.toLowerCase() as 's1' | 's2' | 's3' | 's4'}>{issue.severity}</Badge>\r\n                                            <h3 className={styles.issueTitle} onClick={() => setEditIssue(issue)}>{issue.title}</h3>\r\n                                        </div>\r\n                                        <div className={styles.issueRight}>\r\n                                            <span className={cn(styles.statusPill, statusClass(issue.status))} onClick={() => cycleStatus(issue)} title=\"Click to change status\">\r\n                                                {issue.status}<ChevronRight size={10} className={styles.chevron} />\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                    {issue.description && <p className={styles.issueDesc}>{issue.description}</p>}\r\n                                    <div className={styles.issueMeta}>\r\n                                        <span>Owner: {findMember(issue.ownerId)}</span>\r\n                                        <span>Created: {issue.createdAt}</span>\r\n                                        <div className={styles.issueActions}>\r\n                                            <button className={styles.actionBtn} onClick={() => setEditIssue(issue)} title=\"Edit\"><Pencil size={13} /></button>\r\n                                            <button className={cn(styles.actionBtn, styles.deleteBtn)} onClick={() => deleteIssue(issue.id)} title=\"Delete\"><Trash2 size={13} /></button>\r\n                                        </div>\r\n                                    </div>\r\n                                </Card>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n\r\n            {/* ‚ïê‚ïê‚ïê RISKS TAB ‚ïê‚ïê‚ïê */}\r\n            {activeTab === 'risks' && (\r\n                <>\r\n                    {/* Heatmap */}\r\n                    <Card className={styles.issueCard}>\r\n                        <h3 style={{ fontSize: '0.875rem', fontWeight: 600, marginBottom: '0.75rem', color: 'var(--foreground)' }}>Risk Heatmap (Probability √ó Impact)</h3>\r\n                        <div className={styles.heatmapGrid}>\r\n                            <div className={styles.heatmapLabel}></div>\r\n                            <div className={styles.heatmapLabel}>Low</div>\r\n                            <div className={styles.heatmapLabel}>Med</div>\r\n                            <div className={styles.heatmapLabel}>High</div>\r\n                            {heatmap.probs.map(p => (\r\n                                <React.Fragment key={p}>\r\n                                    <div className={styles.heatmapLabel}>{p}</div>\r\n                                    {heatmap.impacts.map(i => (\r\n                                        <div key={`${p}-${i}`} className={cn(styles.heatmapCell, heatColor(p, i))}>\r\n                                            {heatmap.grid[`${p}-${i}`]}\r\n                                        </div>\r\n                                    ))}\r\n                                </React.Fragment>\r\n                            ))}\r\n                        </div>\r\n                    </Card>\r\n\r\n                    <div className={styles.filterBar} style={{ marginTop: '1rem' }}>\r\n                        {RISK_FILTERS.map(f => (\r\n                            <button key={f} className={cn(styles.filterBtn, riskFilter === f && styles.filterActive)} onClick={() => setRiskFilter(f)}>\r\n                                {f}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {filteredRisks.length === 0 ? (\r\n                        <Card><div className={styles.emptyState}>\r\n                            No risks found. <Button variant=\"ghost\" size=\"sm\" onClick={() => setIsRiskAddOpen(true)} style={{ marginTop: '0.5rem' }}>Add first risk</Button>\r\n                        </div></Card>\r\n                    ) : (\r\n                        <div className={styles.issueList}>\r\n                            {filteredRisks.map(risk => (\r\n                                <Card key={risk.id} className={styles.issueCard}>\r\n                                    <div className={styles.issueTop}>\r\n                                        <div className={styles.issueLeft}>\r\n                                            <span className={cn(styles.statusPill, probImpactClass(risk.probability))} style={{ fontSize: '0.6875rem' }}>P:{risk.probability}</span>\r\n                                            <span className={cn(styles.statusPill, probImpactClass(risk.impact))} style={{ fontSize: '0.6875rem' }}>I:{risk.impact}</span>\r\n                                            <h3 className={styles.issueTitle} onClick={() => setEditRisk(risk)}>{risk.title}</h3>\r\n                                        </div>\r\n                                        <div className={styles.issueRight}>\r\n                                            <span className={cn(styles.statusPill, riskStatusClass(risk.status))} onClick={() => cycleRiskStatus(risk)} title=\"Click to change status\">\r\n                                                {risk.status}<ChevronRight size={10} className={styles.chevron} />\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                    {risk.mitigation && <p className={styles.issueDesc}>Mitigation: {risk.mitigation}</p>}\r\n                                    <div className={styles.issueMeta}>\r\n                                        <span>Owner: {findMember(risk.ownerId)}</span>\r\n                                        <span>Created: {risk.createdAt?.split('T')[0]}</span>\r\n                                        <div className={styles.issueActions}>\r\n                                            <button className={styles.actionBtn} onClick={() => setEditRisk(risk)} title=\"Edit\"><Pencil size={13} /></button>\r\n                                            <button className={cn(styles.actionBtn, styles.deleteBtn)} onClick={() => deleteRisk(risk.id)} title=\"Delete\"><Trash2 size={13} /></button>\r\n                                        </div>\r\n                                    </div>\r\n                                </Card>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n\r\n            {/* ‚ïê‚ïê‚ïê CHANGE REQUESTS TAB ‚ïê‚ïê‚ïê */}\r\n            {activeTab === 'changes' && (\r\n                <>\r\n                    <div className={styles.filterBar}>\r\n                        {CR_FILTERS.map(f => (\r\n                            <button key={f} className={cn(styles.filterBtn, crFilter === f && styles.filterActive)} onClick={() => setCrFilter(f)}>\r\n                                {f}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {filteredCRs.length === 0 ? (\r\n                        <Card><div className={styles.emptyState}>\r\n                            No change requests found. <Button variant=\"ghost\" size=\"sm\" onClick={() => setIsCRAddOpen(true)} style={{ marginTop: '0.5rem' }}>Create first CR</Button>\r\n                        </div></Card>\r\n                    ) : (\r\n                        <div className={styles.issueList}>\r\n                            {filteredCRs.map(cr => (\r\n                                <Card key={cr.id} className={styles.issueCard}>\r\n                                    <div className={styles.issueTop}>\r\n                                        <div className={styles.issueLeft}>\r\n                                            <span className={cn(styles.statusPill, probImpactClass(cr.changeType === 'Cost' ? 'High' : cr.changeType === 'Technical' ? 'Medium' : 'Low'))} style={{ fontSize: '0.6875rem' }}>{cr.changeType}</span>\r\n                                            <h3 className={styles.issueTitle} onClick={() => setEditCR(cr)}>{cr.title}</h3>\r\n                                        </div>\r\n                                        <div className={styles.issueRight}>\r\n                                            <span className={cn(styles.statusPill, crStatusClass(cr.status))} onClick={() => cycleCRStatus(cr)} title=\"Click to change status\">\r\n                                                {cr.status}<ChevronRight size={10} className={styles.chevron} />\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                    {cr.impactSummary && <p className={styles.issueDesc}>{cr.impactSummary}</p>}\r\n                                    <div className={styles.issueMeta}>\r\n                                        <span>By: {cr.requester || '‚Äî'}</span>\r\n                                        <span>Requested: {cr.requestDate}</span>\r\n                                        <div className={styles.issueActions}>\r\n                                            <button className={styles.actionBtn} onClick={() => setEditCR(cr)} title=\"Edit\"><Pencil size={13} /></button>\r\n                                            <button className={cn(styles.actionBtn, styles.deleteBtn)} onClick={() => deleteChangeRequest(cr.id)} title=\"Delete\"><Trash2 size={13} /></button>\r\n                                        </div>\r\n                                    </div>\r\n                                </Card>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n\r\n            {/* ‚ïê‚ïê‚ïê MODALS ‚ïê‚ïê‚ïê */}\r\n            {/* Add Issue */}\r\n            <Modal isOpen={isAddOpen} onClose={() => setIsAddOpen(false)} title=\"Report Issue\">\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}><label>Title *</label><input className={styles.input} value={newIssue.title} onChange={e => setNewIssue({ ...newIssue, title: e.target.value })} placeholder=\"Issue title\" autoFocus /></div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Severity</label><select className={styles.select} value={newIssue.severity} onChange={e => setNewIssue({ ...newIssue, severity: e.target.value as Issue['severity'] })}><option value=\"S1\">S1 ‚Äî Critical</option><option value=\"S2\">S2 ‚Äî High</option><option value=\"S3\">S3 ‚Äî Medium</option><option value=\"S4\">S4 ‚Äî Low</option></select></div>\r\n                        <div className={styles.formGroup}><label>Owner (optional)</label><select className={styles.select} value={newIssue.ownerId} onChange={e => setNewIssue({ ...newIssue, ownerId: e.target.value })}><option value=\"\">‚Äî Unassigned ‚Äî</option>{members.map(m => <option key={m.id} value={m.id}>{m.name}</option>)}</select></div>\r\n                    </div>\r\n                    <details style={{ marginTop: '0.5rem' }}>\r\n                        <summary style={{ fontSize: '0.75rem', color: 'var(--text-muted)', cursor: 'pointer', userSelect: 'none' }}>Advanced options...</summary>\r\n                        <div className={styles.formGroup} style={{ marginTop: '0.5rem' }}>\r\n                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                                <label>Description</label>\r\n                                <Button variant=\"ghost\" size=\"sm\" onClick={() => handleGenerateAI('issue', newIssue, false)} disabled={isAILoading || !newIssue.title} style={{ padding: '0 0.5rem', height: '1.5rem', fontSize: '0.75rem', color: 'var(--brand-primary)' }}>\r\n                                    {isAILoading ? <Loader2 size={12} className={styles.spin} style={{ marginRight: '0.25rem' }} /> : <Bot size={12} style={{ marginRight: '0.25rem' }} />}\r\n                                    AI Ïï°ÏÖò Ï†úÏïà\r\n                                </Button>\r\n                            </div>\r\n                            <textarea className={styles.textarea} value={newIssue.description} onChange={e => setNewIssue({ ...newIssue, description: e.target.value })} placeholder=\"Brief description...\" rows={2} />\r\n                        </div>\r\n                        <div className={styles.formGroup}><label>Date Occurred</label><input type=\"date\" className={styles.input} value={newIssue.occurredDate} onChange={e => setNewIssue({ ...newIssue, occurredDate: e.target.value })} /></div>\r\n                    </details>\r\n                    <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setIsAddOpen(false)}>Cancel</Button><Button onClick={handleAddIssue}>Report</Button></div>\r\n                </div>\r\n            </Modal>\r\n            {/* Edit Issue */}\r\n            <Modal isOpen={!!editIssue} onClose={() => setEditIssue(null)} title=\"Edit Issue\">\r\n                {editIssue && (\r\n                    <div className={styles.form}>\r\n                        <div className={styles.formGroup}><label>Title</label><input className={styles.input} value={editIssue.title} onChange={e => setEditIssue({ ...editIssue, title: e.target.value })} /></div>\r\n                        <div className={styles.formGroup}>\r\n                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                                <label>Description</label>\r\n                                <Button variant=\"ghost\" size=\"sm\" onClick={() => handleGenerateAI('issue', editIssue, true)} disabled={isAILoading} style={{ padding: '0 0.5rem', height: '1.5rem', fontSize: '0.75rem', color: 'var(--brand-primary)' }}>\r\n                                    {isAILoading ? <Loader2 size={12} className={styles.spin} style={{ marginRight: '0.25rem' }} /> : <Bot size={12} style={{ marginRight: '0.25rem' }} />}\r\n                                    AI Ïï°ÏÖò Ï†úÏïà\r\n                                </Button>\r\n                            </div>\r\n                            <textarea className={styles.textarea} value={editIssue.description} onChange={e => setEditIssue({ ...editIssue, description: e.target.value })} rows={4} />\r\n                        </div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Severity</label><select className={styles.select} value={editIssue.severity} onChange={e => setEditIssue({ ...editIssue, severity: e.target.value as Issue['severity'] })}><option value=\"S1\">S1</option><option value=\"S2\">S2</option><option value=\"S3\">S3</option><option value=\"S4\">S4</option></select></div>\r\n                            <div className={styles.formGroup}><label>Owner</label><select className={styles.select} value={editIssue.ownerId || ''} onChange={e => setEditIssue({ ...editIssue, ownerId: e.target.value })}><option value=\"\">‚Äî</option>{members.map(m => <option key={m.id} value={m.id}>{m.name}</option>)}</select></div>\r\n                        </div>\r\n                        <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setEditIssue(null)}>Cancel</Button><Button onClick={handleEditSave}>Save</Button></div>\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n\r\n            {/* Add Risk */}\r\n            <Modal isOpen={isRiskAddOpen} onClose={() => setIsRiskAddOpen(false)} title=\"Add Risk\">\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}><label>Title *</label><input className={styles.input} value={newRisk.title} onChange={e => setNewRisk({ ...newRisk, title: e.target.value })} placeholder=\"Risk title\" autoFocus /></div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Probability</label><select className={styles.select} value={newRisk.probability} onChange={e => setNewRisk({ ...newRisk, probability: e.target.value as Risk['probability'] })}><option>Low</option><option>Medium</option><option>High</option></select></div>\r\n                        <div className={styles.formGroup}><label>Impact</label><select className={styles.select} value={newRisk.impact} onChange={e => setNewRisk({ ...newRisk, impact: e.target.value as Risk['impact'] })}><option>Low</option><option>Medium</option><option>High</option></select></div>\r\n                    </div>\r\n                    <details style={{ marginTop: '0.5rem' }}>\r\n                        <summary style={{ fontSize: '0.75rem', color: 'var(--text-muted)', cursor: 'pointer', userSelect: 'none' }}>Advanced options...</summary>\r\n                        <div className={styles.formRow} style={{ marginTop: '0.5rem' }}>\r\n                            <div className={styles.formGroup}><label>Owner</label><select className={styles.select} value={newRisk.ownerId} onChange={e => setNewRisk({ ...newRisk, ownerId: e.target.value })}><option value=\"\">‚Äî Unassigned ‚Äî</option>{members.map(m => <option key={m.id} value={m.id}>{m.name}</option>)}</select></div>\r\n                            <div className={styles.formGroup}><label>Date Identified</label><input type=\"date\" className={styles.input} value={newRisk.identifiedDate} onChange={e => setNewRisk({ ...newRisk, identifiedDate: e.target.value })} /></div>\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                                <label>Mitigation</label>\r\n                                <Button variant=\"ghost\" size=\"sm\" onClick={() => handleGenerateAI('risk', newRisk, false)} disabled={isAILoading || !newRisk.title} style={{ padding: '0 0.5rem', height: '1.5rem', fontSize: '0.75rem', color: 'var(--brand-primary)' }}>\r\n                                    {isAILoading ? <Loader2 size={12} className={styles.spin} style={{ marginRight: '0.25rem' }} /> : <Bot size={12} style={{ marginRight: '0.25rem' }} />}\r\n                                    AI Î∞©Ïñ¥ ÎåÄÏ±Ö\r\n                                </Button>\r\n                            </div>\r\n                            <input className={styles.input} value={newRisk.mitigation} onChange={e => setNewRisk({ ...newRisk, mitigation: e.target.value })} placeholder=\"How to mitigate...\" />\r\n                        </div>\r\n                    </details>\r\n                    <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setIsRiskAddOpen(false)}>Cancel</Button><Button onClick={handleAddRisk}>Add</Button></div>\r\n                </div>\r\n            </Modal>\r\n            {/* Edit Risk */}\r\n            <Modal isOpen={!!editRisk} onClose={() => setEditRisk(null)} title=\"Edit Risk\">\r\n                {editRisk && (\r\n                    <div className={styles.form}>\r\n                        <div className={styles.formGroup}><label>Title</label><input className={styles.input} value={editRisk.title} onChange={e => setEditRisk({ ...editRisk, title: e.target.value })} /></div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Probability</label><select className={styles.select} value={editRisk.probability} onChange={e => setEditRisk({ ...editRisk, probability: e.target.value as Risk['probability'] })}><option>Low</option><option>Medium</option><option>High</option></select></div>\r\n                            <div className={styles.formGroup}><label>Impact</label><select className={styles.select} value={editRisk.impact} onChange={e => setEditRisk({ ...editRisk, impact: e.target.value as Risk['impact'] })}><option>Low</option><option>Medium</option><option>High</option></select></div>\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                                <label>Mitigation</label>\r\n                                <Button variant=\"ghost\" size=\"sm\" onClick={() => handleGenerateAI('risk', editRisk, true)} disabled={isAILoading} style={{ padding: '0 0.5rem', height: '1.5rem', fontSize: '0.75rem', color: 'var(--brand-primary)' }}>\r\n                                    {isAILoading ? <Loader2 size={12} className={styles.spin} style={{ marginRight: '0.25rem' }} /> : <Bot size={12} style={{ marginRight: '0.25rem' }} />}\r\n                                    AI Î∞©Ïñ¥ ÎåÄÏ±Ö\r\n                                </Button>\r\n                            </div>\r\n                            <input className={styles.input} value={editRisk.mitigation || ''} onChange={e => setEditRisk({ ...editRisk, mitigation: e.target.value })} />\r\n                        </div>\r\n                        <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setEditRisk(null)}>Cancel</Button><Button onClick={handleEditRiskSave}>Save</Button></div>\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n\r\n            {/* Add CR */}\r\n            <Modal isOpen={isCRAddOpen} onClose={() => setIsCRAddOpen(false)} title=\"Submit Change Request\">\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}><label>Title *</label><input className={styles.input} value={newCR.title} onChange={e => setNewCR({ ...newCR, title: e.target.value })} placeholder=\"Change request title\" autoFocus /></div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Type</label><select className={styles.select} value={newCR.changeType} onChange={e => setNewCR({ ...newCR, changeType: e.target.value as ChangeRequest['changeType'] })}><option>Scope</option><option>Schedule</option><option>Cost</option><option>Technical</option></select></div>\r\n                        <div className={styles.formGroup}><label>Requester</label><input className={styles.input} value={newCR.requester} onChange={e => setNewCR({ ...newCR, requester: e.target.value })} placeholder=\"Who requested?\" /></div>\r\n                    </div>\r\n                    <details style={{ marginTop: '0.5rem' }}>\r\n                        <summary style={{ fontSize: '0.75rem', color: 'var(--text-muted)', cursor: 'pointer', userSelect: 'none' }}>Advanced options...</summary>\r\n                        <div className={styles.formRow} style={{ marginTop: '0.5rem' }}>\r\n                            <div className={styles.formGroup}><label>Request Date</label><input type=\"date\" className={styles.input} value={newCR.requestDate} onChange={e => setNewCR({ ...newCR, requestDate: e.target.value })} /></div>\r\n                            <div className={styles.formGroup}><label>Status</label><select className={styles.select} value={newCR.status} onChange={e => setNewCR({ ...newCR, status: e.target.value as ChangeRequest['status'] })}><option>Pending</option><option>Approved</option><option>Rejected</option><option>Implemented</option></select></div>\r\n                        </div>\r\n                        <div className={styles.formGroup}><label>Impact Summary</label><input className={styles.input} value={newCR.impactSummary} onChange={e => setNewCR({ ...newCR, impactSummary: e.target.value })} placeholder=\"Brief impact description\" /></div>\r\n                        <div className={styles.formGroup}><label>CR Reference / Related Task</label><input className={styles.input} value={newCR.reference} onChange={e => setNewCR({ ...newCR, reference: e.target.value })} placeholder=\"Email / Doc link / Task ID\" /></div>\r\n                    </details>\r\n                    <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setIsCRAddOpen(false)}>Cancel</Button><Button onClick={handleAddCR}>Submit</Button></div>\r\n                </div>\r\n            </Modal>\r\n            {/* Edit CR */}\r\n            <Modal isOpen={!!editCR} onClose={() => setEditCR(null)} title=\"Edit Change Request\">\r\n                {editCR && (\r\n                    <div className={styles.form}>\r\n                        <div className={styles.formGroup}><label>Title</label><input className={styles.input} value={editCR.title} onChange={e => setEditCR({ ...editCR, title: e.target.value })} /></div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Requester</label><input className={styles.input} value={editCR.requester} onChange={e => setEditCR({ ...editCR, requester: e.target.value })} /></div>\r\n                            <div className={styles.formGroup}><label>Type</label><select className={styles.select} value={editCR.changeType} onChange={e => setEditCR({ ...editCR, changeType: e.target.value as ChangeRequest['changeType'] })}><option>Scope</option><option>Schedule</option><option>Cost</option><option>Technical</option></select></div>\r\n                            <div className={styles.formGroup}><label>Status</label><select className={styles.select} value={editCR.status} onChange={e => setEditCR({ ...editCR, status: e.target.value as ChangeRequest['status'] })}><option>Pending</option><option>Approved</option><option>Rejected</option><option>Implemented</option></select></div>\r\n                        </div>\r\n                        <div className={styles.formGroup}><label>Impact Summary</label><input className={styles.input} value={editCR.impactSummary || ''} onChange={e => setEditCR({ ...editCR, impactSummary: e.target.value })} /></div>\r\n                        <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setEditCR(null)}>Cancel</Button><Button onClick={handleEditCRSave}>Save</Button></div>\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\login\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Brain' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Brain"},"fix":{"range":[296,302],"text":""},"desc":"Remove unused variable \"Brain\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":151,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8523,8526],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8523,8526],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":209,"column":21,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12516,12632],"text":"\n              Click &quot;Generate Analysis\" to get a deep-dive AI assessment of the current project state.\n            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12516,12632],"text":"\n              Click &ldquo;Generate Analysis\" to get a deep-dive AI assessment of the current project state.\n            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12516,12632],"text":"\n              Click &#34;Generate Analysis\" to get a deep-dive AI assessment of the current project state.\n            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12516,12632],"text":"\n              Click &rdquo;Generate Analysis\" to get a deep-dive AI assessment of the current project state.\n            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":209,"column":39,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12516,12632],"text":"\n              Click \"Generate Analysis&quot; to get a deep-dive AI assessment of the current project state.\n            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12516,12632],"text":"\n              Click \"Generate Analysis&ldquo; to get a deep-dive AI assessment of the current project state.\n            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12516,12632],"text":"\n              Click \"Generate Analysis&#34; to get a deep-dive AI assessment of the current project state.\n            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12516,12632],"text":"\n              Click \"Generate Analysis&rdquo; to get a deep-dive AI assessment of the current project state.\n            "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useMemo } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useProject } from '@/hooks/useProject';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/app/components/ui/Card';\nimport { Button } from '@/app/components/ui/Button';\nimport { Brain, TrendingUp, Clock, AlertTriangle, Activity, DollarSign, ShieldAlert, Rocket, Lightbulb, RefreshCw, CheckCircle, Bot, Loader2, Sparkles } from 'lucide-react';\nimport { toast } from 'sonner';\nimport styles from './page.module.css';\nimport { cn } from '@/lib/utils';\n\nexport default function Dashboard() {\n  const { tasks, issues, risks, members, projectInfo, budget, activities, changeRequests, actionItems, deployments, decisions } = useProject();\n  const router = useRouter();\n\n  const [aiSummary, setAiSummary] = React.useState<string | null>(null);\n  const [isAILoading, setIsAILoading] = React.useState(false);\n\n  const today = new Date().toISOString().split('T')[0];\n\n  const metrics = useMemo(() => {\n    const total = tasks.length;\n    const completed = tasks.filter(t => t.status === 'Done').length;\n    const inProgress = tasks.filter(t => t.status === 'In Progress').length;\n    const blocked = tasks.filter(t => t.status === 'Blocked').length;\n    const notStarted = tasks.filter(t => t.status === 'Not Started').length;\n    const progress = total ? Math.round((completed / total) * 100) : 0;\n    const overdue = tasks.filter(t => t.dueDate < today && t.status !== 'Done');\n    const highIssues = issues.filter(i => (i.severity === 'S1' || i.severity === 'S2') && i.status !== 'Resolved' && i.status !== 'Closed');\n    const openIssues = issues.filter(i => i.status !== 'Resolved' && i.status !== 'Closed');\n\n    const pendingCRs = (changeRequests || []).filter(cr => cr.status === 'Pending').length;\n    const overdueActions = (actionItems || []).filter(a => a.dueDate && a.dueDate < today && a.status !== 'Done').length;\n\n    return { total, completed, inProgress, blocked, notStarted, progress, overdue, highIssues, openIssues, pendingCRs, overdueActions };\n  }, [tasks, issues, changeRequests, actionItems, today]);\n\n  // Project Health\n  const health = useMemo(() => {\n    const { overdue, blocked, highIssues, overdueActions, pendingCRs } = metrics;\n    const reasons = [];\n    if (overdue.length > 0) reasons.push(`${overdue.length} overdue tasks`);\n    if (overdueActions > 0) reasons.push(`${overdueActions} overdue actions`);\n    if (highIssues.length > 0) reasons.push(`${highIssues.length} critical issues`);\n    if (pendingCRs > 3) reasons.push(`${pendingCRs} pending CRs`);\n    if (blocked > 0) reasons.push(`${blocked} blocked tasks`);\n\n    const reasonText = reasons.length > 0 ? `Why at risk: ${reasons.join(', ')}` : 'All good';\n\n    if (overdue.length >= 3 || highIssues.length >= 3 || blocked >= 3 || overdueActions >= 3) return { label: 'At Risk', color: '#ff6b6b', emoji: 'üî¥', reasonText };\n    if (overdue.length >= 1 || highIssues.length >= 1 || blocked >= 1 || overdueActions >= 1 || pendingCRs > 0) return { label: 'Caution', color: '#ffeaa7', emoji: 'üü°', reasonText };\n    return { label: 'On Track', color: '#55efc4', emoji: 'üü¢', reasonText };\n  }, [metrics]);\n\n  // Timeline progress\n  const timelineProgress = useMemo(() => {\n    if (!projectInfo.startDate || !projectInfo.endDate) return { elapsed: 0, taskProgress: metrics.progress };\n    const start = new Date(projectInfo.startDate).getTime();\n    const end = new Date(projectInfo.endDate).getTime();\n    const now = Date.now();\n    const total = end - start;\n    if (total <= 0) return { elapsed: 0, taskProgress: metrics.progress };\n    const elapsed = Math.min(100, Math.max(0, Math.round(((now - start) / total) * 100)));\n    return { elapsed, taskProgress: metrics.progress };\n  }, [projectInfo, metrics.progress]);\n\n  // Budget summary\n  const budgetSummary = useMemo(() => {\n    const spent = budget.entries.reduce((sum, e) => sum + e.amount, 0);\n    const remaining = budget.contractAmount - spent;\n    const percent = budget.contractAmount > 0 ? Math.round((spent / budget.contractAmount) * 100) : 0;\n    return { contract: budget.contractAmount, spent, remaining, percent };\n  }, [budget]);\n\n  // What needs attention (prioritized)\n  const attentionItems = useMemo(() => {\n    const items: { icon: string; text: string; severity: number; link: string }[] = [];\n    metrics.overdue.forEach(t => items.push({ icon: 'üî•', text: `Overdue Task: \"${t.title}\" (due ${t.dueDate})`, severity: 1, link: '/schedule' }));\n    metrics.highIssues.forEach(i => items.push({ icon: '‚ö†Ô∏è', text: `${i.severity} Issue: \"${i.title}\"`, severity: 2, link: '/issues' }));\n    if (metrics.overdueActions > 0) items.push({ icon: '‚ö°', text: `${metrics.overdueActions} Action Items are overdue`, severity: 2, link: '/actions' });\n    if (metrics.pendingCRs > 0) items.push({ icon: 'üîÑ', text: `${metrics.pendingCRs} Change Requests pending approval`, severity: 3, link: '/issues' });\n    if (metrics.blocked > 0) items.push({ icon: 'üö´', text: `${metrics.blocked} task(s) are blocked ‚Äî investigate dependencies`, severity: 3, link: '/schedule' });\n    if (budgetSummary.percent > 80 && budgetSummary.contract > 0) items.push({ icon: 'üí∞', text: `Budget usage at ${budgetSummary.percent}% ‚Äî review spending`, severity: 4, link: '/budget' });\n    if (timelineProgress.elapsed > timelineProgress.taskProgress + 15) items.push({ icon: '‚è∞', text: `Timeline: ${timelineProgress.elapsed}% elapsed but only ${timelineProgress.taskProgress}% completed`, severity: 5, link: '/schedule' });\n    if (items.length === 0) items.push({ icon: '‚úÖ', text: 'All clear! Project is on track.', severity: 99, link: '/' });\n    return items.sort((a, b) => a.severity - b.severity).slice(0, 6);\n  }, [metrics, budgetSummary, timelineProgress]);\n\n  // Risk matrix counts (based on actual Risk entities)\n  const riskMatrix = useMemo(() => {\n    const safeRisks = risks || [];\n    const openRisks = safeRisks.filter(r => r.status !== 'Closed');\n    const matrix = { high: 0, medium: 0, low: 0 };\n    openRisks.forEach(r => {\n      // Use combined score: prob+impact\n      const probScore = r.probability === 'High' ? 2 : r.probability === 'Medium' ? 1 : 0;\n      const impScore = r.impact === 'High' ? 2 : r.impact === 'Medium' ? 1 : 0;\n      const combined = probScore + impScore;\n      if (combined >= 3) matrix.high++;\n      else if (combined >= 2) matrix.medium++;\n      else matrix.low++;\n    });\n    return matrix;\n  }, [risks]);\n\n  const upcomingDeploys = useMemo(() => {\n    const nextWeek = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n    return (deployments || []).filter(d =>\n      d.status !== 'Deployed' && d.status !== 'Completed' && d.status !== 'Failed' && d.status !== 'Rolled Back'\n      && (d.deploymentDate || d.plannedDate || '') >= today\n      && (d.deploymentDate || d.plannedDate || '') <= nextWeek\n    ).sort((a, b) => (a.deploymentDate || a.plannedDate || '').localeCompare(b.deploymentDate || b.plannedDate || ''));\n  }, [deployments, today]);\n\n  const recentDecisions = useMemo(() => {\n    return [...(decisions || [])].sort((a, b) => b.createdAt.localeCompare(a.createdAt)).slice(0, 5);\n  }, [decisions]);\n\n  const projectName = projectInfo?.name || 'AGS Project';\n\n  // Format currency\n  const fmtCurrency = (n: number) => `$${n.toLocaleString()}`;\n\n  const handleGenerateSummary = async () => {\n    setIsAILoading(true);\n    try {\n      const summaryContext = `\n        Project: ${projectName}\n        Health: ${health.label} (${health.reasonText})\n        Tasks: ${metrics.progress}%\n        Open Issues: ${metrics.openIssues.length} (High Severity: ${metrics.highIssues.length})\n        Overdue Items: ${metrics.overdue.length} tasks, ${metrics.overdueActions} actions\n        Budget Spent: ${budgetSummary.percent}%\n        Recent Activities: ${activities.slice(0, 5).map(a => a.action).join(', ')}\n      `;\n\n      const res = await fetch('/api/generate-action', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          prompt: 'Write a comprehensive but concise executive summary of the project status, highlighting key risks and next steps. Do not use more than 3 bullet points.',\n          context: summaryContext\n        })\n      });\n      const data = await res.json();\n      if (!res.ok) {\n        throw new Error(data.error || 'Failed to generate summary');\n      }\n      if (data.text) setAiSummary(data.text);\n    } catch (e: any) {\n      console.error(e);\n      toast.error(e.message || 'AI ÏöîÏïΩ ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. API ÌÇ§ ÌÅ¨Î†àÎîßÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');\n    } finally {\n      setIsAILoading(false);\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n      <header className={styles.header}>\n        <div>\n          <h1 className={styles.pageTitle}>{projectName}</h1>\n          <p className={styles.pageSubtitle}>\n            {projectInfo.client && <span>{projectInfo.client} ¬∑ </span>}\n            {projectInfo.startDate} ~ {projectInfo.endDate}\n          </p>\n        </div>\n        <div className={styles.healthBadge} style={{ borderColor: health.color }} title={health.reasonText}>\n          <span>{health.emoji}</span>\n          <span style={{ color: health.color }}>{health.label}</span>\n        </div>\n      </header>\n\n      {/* Unified AI Executive Summary Card */}\n      <Card style={{ marginBottom: '1.5rem', backgroundColor: 'var(--surface-2)', border: '1px solid var(--brand-primary)' }}>\n        <div style={{ padding: '1.5rem', display: 'flex', flexDirection: 'column', gap: '1rem' }}>\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n            <div className={styles.aiTitleGroup}>\n              <h3 style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', fontSize: '1.125rem', fontWeight: 600, color: 'var(--brand-primary)' }}>\n                <Bot size={20} /> AI Executive Summary\n              </h3>\n              <p className={styles.aiSubtitle} style={{ marginTop: '0.25rem', fontSize: '0.875rem' }}>Automated Insights & Real-time Analysis</p>\n            </div>\n            <Button size=\"sm\" variant=\"outline\" onClick={handleGenerateSummary} disabled={isAILoading}>\n              {isAILoading ? <Loader2 size={14} className={styles.spin} style={{ marginRight: '0.5rem' }} /> : <Lightbulb size={14} style={{ marginRight: '0.5rem' }} />}\n              {aiSummary ? 'Regenerate Analysis' : 'Generate Analysis'}\n            </Button>\n          </div>\n\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '1rem', paddingBottom: '1rem', borderBottom: '1px solid var(--border-color)' }}>\n            <div style={{ fontSize: '0.875rem', color: 'var(--foreground)' }}>üöÄ <strong>Progress:</strong> {projectName} is {metrics.progress}% complete ({metrics.completed}/{metrics.total} tasks). {metrics.inProgress > 0 ? `${metrics.inProgress} in progress.` : ''}</div>\n            <div style={{ fontSize: '0.875rem', color: 'var(--foreground)' }}>‚ö†Ô∏è <strong>Risks:</strong> {metrics.overdue.length} overdue, {metrics.blocked} blocked. {metrics.highIssues.length > 0 ? `${metrics.highIssues.length} high-severity issues.` : 'No critical issues.'}</div>\n            {budgetSummary.contract > 0 && (\n              <div style={{ fontSize: '0.875rem', color: 'var(--foreground)' }}>üí∞ <strong>Budget:</strong> {budgetSummary.percent}% spent. {budgetSummary.remaining > 0 ? `$${budgetSummary.remaining.toLocaleString()} remaining.` : 'Budget fully consumed!'}</div>\n            )}\n            <div style={{ fontSize: '0.875rem', color: 'var(--foreground)' }}>üéØ <strong>Team:</strong> {members.length > 0 ? `${members.length} members across ${new Set(members.map(m => m.team)).size} teams.` : 'Register team members to track allocation.'}</div>\n          </div>\n\n          {aiSummary ? (\n            <div style={{ fontSize: '0.9rem', lineHeight: 1.6, color: 'var(--foreground)', whiteSpace: 'pre-wrap', backgroundColor: 'var(--surface-3)', padding: '1rem', borderRadius: '0.5rem' }}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.5rem', color: 'var(--brand-primary)', fontWeight: 600 }}>\n                <Sparkles size={16} /> AI Assessment\n              </div>\n              {aiSummary}\n            </div>\n          ) : (\n            <p style={{ fontSize: '0.875rem', color: 'var(--text-muted)', fontStyle: 'italic', textAlign: 'center', padding: '1rem 0' }}>\n              Click \"Generate Analysis\" to get a deep-dive AI assessment of the current project state.\n            </p>\n          )}\n        </div>\n      </Card>\n\n      {/* Timeline Bar */}\n      <div className={styles.timelineSection}>\n        <div className={styles.timelineLabels}>\n          <span>Time Elapsed: {timelineProgress.elapsed}%</span>\n          <span>Task Progress: {timelineProgress.taskProgress}%</span>\n        </div>\n        <div className={styles.timelineBar}>\n          <div className={styles.timelineElapsed} style={{ width: `${timelineProgress.elapsed}%` }} />\n          <div className={styles.timelineCompleted} style={{ width: `${timelineProgress.taskProgress}%` }} />\n        </div>\n        <div className={styles.timelineLegend}>\n          <span><span className={styles.dot} style={{ background: 'rgba(255,255,255,0.15)' }} /> Time</span>\n          <span><span className={styles.dot} style={{ background: 'var(--primary)' }} /> Progress</span>\n        </div>\n      </div>\n\n      {/* KPI Cards */}\n      <div className={styles.kpiGrid}>\n        <Card glass glow className={cn(styles.kpiCard, styles.kpiClickable)} onClick={() => router.push('/schedule')}>\n          <CardContent>\n            <div className={styles.kpiHeader}>\n              <span className={styles.kpiLabel}>Overall Progress</span>\n              <div className={cn(styles.kpiIconBox, styles.kpiIconBlue)}><TrendingUp size={18} /></div>\n            </div>\n            <div className={styles.bigNumber}>{metrics.progress}<span className={styles.numberUnit}>%</span></div>\n            <div className={styles.progressBar}>\n              <div className={styles.progressFill} style={{ width: `${metrics.progress}%` }} />\n            </div>\n            <div className={styles.metaText}>{metrics.completed} / {metrics.total} tasks</div>\n          </CardContent>\n        </Card>\n\n        <Card glass glow className={cn(styles.kpiCard, styles.kpiClickable)} onClick={() => router.push('/schedule')}>\n          <CardContent>\n            <div className={styles.kpiHeader}>\n              <span className={styles.kpiLabel}>Overdue</span>\n              <div className={cn(styles.kpiIconBox, styles.kpiIconRed)}><Clock size={18} /></div>\n            </div>\n            <div className={cn(styles.bigNumber, metrics.overdue.length > 0 ? styles.textRed : styles.textGreen)}>\n              {metrics.overdue.length}\n            </div>\n            <div className={styles.metaText}>{metrics.overdue.length > 0 ? 'Needs immediate action' : 'All on track ‚úì'}</div>\n          </CardContent>\n        </Card>\n\n        <Card glass glow className={cn(styles.kpiCard, styles.kpiClickable)} onClick={() => router.push('/issues')}>\n          <CardContent>\n            <div className={styles.kpiHeader}>\n              <span className={styles.kpiLabel}>Open Issues</span>\n              <div className={cn(styles.kpiIconBox, styles.kpiIconOrange)}><AlertTriangle size={18} /></div>\n            </div>\n            <div className={styles.bigNumber}>{metrics.openIssues.length}</div>\n            <div className={styles.metaText}>{metrics.highIssues.length} high priority</div>\n          </CardContent>\n        </Card>\n\n        <Card glass glow className={cn(styles.kpiCard, styles.kpiClickable)} onClick={() => router.push('/issues')}>\n          <CardContent>\n            <div className={styles.kpiHeader}>\n              <span className={styles.kpiLabel}>Pending CRs</span>\n              <div className={cn(styles.kpiIconBox, styles.kpiIconBlue)}><RefreshCw size={18} /></div>\n            </div>\n            <div className={styles.bigNumber}>{metrics.pendingCRs}</div>\n            <div className={styles.metaText}>{metrics.pendingCRs > 0 ? \"Awaiting approvals\" : \"All clear\"}</div>\n          </CardContent>\n        </Card>\n\n        <Card glass glow className={cn(styles.kpiCard, styles.kpiClickable)} onClick={() => router.push('/actions')}>\n          <CardContent>\n            <div className={styles.kpiHeader}>\n              <span className={styles.kpiLabel}>Overdue Actions</span>\n              <div className={cn(styles.kpiIconBox, styles.kpiIconRed)}><CheckCircle size={18} /></div>\n            </div>\n            <div className={cn(styles.bigNumber, metrics.overdueActions > 0 ? styles.textRed : styles.textGreen)}>{metrics.overdueActions}</div>\n            <div className={styles.metaText}>{metrics.overdueActions > 0 ? \"Requires follow-up\" : \"All actions on time\"}</div>\n          </CardContent>\n        </Card>\n\n        <Card glass glow className={cn(styles.kpiCard, styles.kpiClickable)} onClick={() => router.push('/budget')}>\n          <CardContent>\n            <div className={styles.kpiHeader}>\n              <span className={styles.kpiLabel}>Budget</span>\n              <div className={cn(styles.kpiIconBox, styles.kpiIconGreen)}><DollarSign size={18} /></div>\n            </div>\n            {budgetSummary.contract > 0 ? (\n              <>\n                <div className={styles.bigNumber}>\n                  {fmtCurrency(budgetSummary.spent)}\n                </div>\n                <div className={styles.progressBar}>\n                  <div className={styles.progressFill} style={{ width: `${budgetSummary.percent}%`, background: budgetSummary.percent > 80 ? 'linear-gradient(90deg, #ff6b6b, #e17055)' : undefined }} />\n                </div>\n                <div className={styles.metaText}>\n                  {budgetSummary.percent}% of {fmtCurrency(budgetSummary.contract)} ¬∑ {fmtCurrency(budgetSummary.remaining)} left\n                </div>\n              </>\n            ) : (\n              <>\n                <div className={styles.bigNumber} style={{ fontSize: '1.125rem', color: 'var(--foreground-muted)' }}>Not Set</div>\n                <div className={styles.metaText}>Go to Budget page to set contract amount</div>\n              </>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Bottom Grid: Attention + Risk + AI */}\n      <div className={styles.bottomGrid}>\n        {/* LEFT COLUMN: Attention & Decisions */}\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\n          {/* What Needs Attention */}\n          <Card className={styles.listCard}>\n            <CardHeader>\n              <CardTitle>\n                <ShieldAlert size={16} style={{ display: 'inline', marginRight: '0.5rem', verticalAlign: 'text-bottom' }} />\n                What Needs Attention\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className={styles.actionsList}>\n                {attentionItems.map((item, i) => (\n                  <div key={i} className={cn(styles.actionItem, styles.kpiClickable)} onClick={() => router.push(item.link)} style={{ cursor: 'pointer' }}>\n                    <span className={styles.actionIcon}>{item.icon}</span>\n                    <span className={styles.actionText}>{item.text}</span>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Recent Decisions */}\n          <Card className={styles.listCard}>\n            <CardHeader>\n              <CardTitle>\n                <Lightbulb size={16} style={{ display: 'inline', marginRight: '0.5rem', verticalAlign: 'text-bottom', color: 'var(--primary-light)' }} />\n                Recent Decisions\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {recentDecisions.length === 0 ? (\n                <div className={styles.emptyState}>No recent decisions</div>\n              ) : (\n                <div className={styles.actionsList}>\n                  {recentDecisions.map(d => (\n                    <div key={d.id} className={styles.actionItem} onClick={() => router.push('/actions')} style={{ cursor: 'pointer' }}>\n                      <span className={styles.actionIcon}>üí°</span>\n                      <span className={styles.actionText}><strong>{d.summary}</strong> <span style={{ color: 'var(--foreground-muted)' }}>(by {d.decidedBy || 'Team'})</span></span>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* RIGHT COLUMN: Risk + Deployments + Activity */}\n        <div className={styles.rightColumn}>\n          {/* Risk Matrix */}\n          <Card className={cn(styles.riskCard, styles.kpiClickable)} onClick={() => router.push('/issues')} style={{ cursor: 'pointer' }}>\n            <CardHeader><CardTitle>Risk Matrix</CardTitle></CardHeader>\n            <CardContent>\n              <div className={styles.riskGrid}>\n                <div className={cn(styles.riskCell, styles.riskS1)}>\n                  <span className={styles.riskCount}>{riskMatrix.high}</span>\n                  <span className={styles.riskLabel}>High</span>\n                </div>\n                <div className={cn(styles.riskCell, styles.riskS3)}>\n                  <span className={styles.riskCount}>{riskMatrix.medium}</span>\n                  <span className={styles.riskLabel}>Medium</span>\n                </div>\n                <div className={cn(styles.riskCell, styles.riskS4)}>\n                  <span className={styles.riskCount}>{riskMatrix.low}</span>\n                  <span className={styles.riskLabel}>Low</span>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Upcoming Deployments */}\n          <Card className={styles.listCard}>\n            <CardHeader>\n              <CardTitle>\n                <Rocket size={16} style={{ display: 'inline', marginRight: '0.5rem', verticalAlign: 'text-bottom', color: 'var(--accent-cyan)' }} />\n                Upcoming Deployments (7 Days)\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {upcomingDeploys.length === 0 ? (\n                <div className={styles.emptyState}>No deployments planned</div>\n              ) : (\n                <div className={styles.actionsList}>\n                  {upcomingDeploys.map(d => (\n                    <div key={d.id} className={styles.actionItem} onClick={() => router.push('/releases')} style={{ cursor: 'pointer', padding: '0.375rem 0' }}>\n                      <span className={cn(styles.envBadge, styles.actionIcon)} style={{ fontSize: '0.65rem', padding: '0.1rem 0.3rem' }}>{d.environment}</span>\n                      <span className={styles.actionText}><strong>v{d.version}</strong> <span style={{ color: 'var(--foreground-muted)' }}>({d.deploymentDate || d.plannedDate})</span></span>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Recent Activity */}\n          <Card className={styles.activityCard}>\n            <CardHeader><CardTitle>Recent Activity</CardTitle></CardHeader>\n            <CardContent>\n              {activities.length === 0 ? (\n                <div className={styles.emptyState}>\n                  <Activity size={20} style={{ color: 'var(--foreground-muted)', opacity: 0.5 }} />\n                  <span>No activity yet</span>\n                </div>\n              ) : (\n                <div className={styles.activityList}>\n                  {activities.slice(0, 5).map((a) => (\n                    <div key={a.id} className={styles.activityItem}>\n                      <div className={styles.activityDot} />\n                      <div>\n                        <p className={styles.activityAction}>{a.action}</p>\n                        <p className={styles.activityDetail}>{a.detail}</p>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      {/* End of content */}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\policies\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\releases\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":90,"column":168,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":171,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4934,4937],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4934,4937],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":96,"column":174,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":177,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5393,5396],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5393,5396],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Card } from '@/app/components/ui/Card';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Modal } from '@/app/components/ui/Modal';\r\nimport { Plus, Trash2, Pencil, ChevronRight, Rocket, Copy } from 'lucide-react';\r\nimport { generateId, cn } from '@/lib/utils';\r\nimport { Deployment, DeploymentStatus, DeployChangeType } from '@/types';\r\nimport styles from './page.module.css';\r\n\r\nconst DEP_STATUS_CYCLE: DeploymentStatus[] = ['Planned', 'In Progress', 'Deployed', 'Rolled Back'];\r\n\r\nexport default function ReleasesPage() {\r\n    const {\r\n        deployments,\r\n        addDeployment, updateDeployment, deleteDeployment,\r\n        addActivity,\r\n    } = useProject();\r\n\r\n    const safeDeployments = deployments || [];\r\n\r\n    // ‚îÄ‚îÄ Deployment state ‚îÄ‚îÄ\r\n    const [isDepAddOpen, setIsDepAddOpen] = useState(false);\r\n    const [editDep, setEditDep] = useState<Deployment | null>(null);\r\n    const [newDep, setNewDep] = useState({\r\n        title: '', version: '', systemModule: 'General', environment: 'Staging' as Deployment['environment'],\r\n        changeType: 'Release' as DeployChangeType, deploymentDate: '', releaseNotes: '',\r\n        laneArea: '', relatedCRId: '', testResultUrl: ''\r\n    });\r\n\r\n    const [filterEnv, setFilterEnv] = useState<'All' | Deployment['environment']>('All');\r\n    const [filterStatus, setFilterStatus] = useState<'All' | DeploymentStatus>('All');\r\n\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    const depStatusClass = (s: DeploymentStatus) => {\r\n        const map: Record<DeploymentStatus, string> = { 'Planned': styles.statusPlanned, 'In Progress': styles.statusInProgress, 'Deployed': styles.statusDeployed, 'Completed': styles.statusDeployed, 'Failed': styles.statusRolledBack, 'Rolled Back': styles.statusRolledBack };\r\n        return map[s];\r\n    };\r\n\r\n    // ‚îÄ‚îÄ Handlers ‚îÄ‚îÄ\r\n    const handleAddDeployment = () => {\r\n        if (!newDep.version) return;\r\n        const now = new Date().toISOString();\r\n        addDeployment({\r\n            id: generateId('dep'),\r\n            title: newDep.title || `Release v${newDep.version}`,\r\n            version: newDep.version,\r\n            systemModule: newDep.systemModule,\r\n            changeType: newDep.changeType,\r\n            deploymentDate: newDep.deploymentDate || today,\r\n            plannedDate: newDep.deploymentDate || today,\r\n            environment: newDep.environment,\r\n            releaseNotes: newDep.releaseNotes || undefined,\r\n            laneArea: newDep.laneArea,\r\n            relatedCRId: newDep.relatedCRId,\r\n            testResultUrl: newDep.testResultUrl,\r\n            status: 'Planned',\r\n            createdAt: now,\r\n            updatedAt: now,\r\n        });\r\n        addActivity({ id: generateId('act'), timestamp: now, action: 'Deployment planned', detail: `v${newDep.version} ‚Üí ${newDep.environment}`, category: 'deployment' });\r\n        setNewDep({ title: '', version: '', systemModule: 'General', environment: 'Staging', changeType: 'Release', deploymentDate: '', releaseNotes: '', laneArea: '', relatedCRId: '', testResultUrl: '' }); setIsDepAddOpen(false);\r\n    };\r\n\r\n    const handleDuplicate = (dep: Deployment) => {\r\n        setNewDep({\r\n            title: dep.title, version: dep.version, systemModule: dep.systemModule, environment: dep.environment,\r\n            changeType: dep.changeType, deploymentDate: dep.deploymentDate, releaseNotes: dep.releaseNotes || '',\r\n            laneArea: dep.laneArea || '', relatedCRId: dep.relatedCRId || '', testResultUrl: dep.testResultUrl || ''\r\n        });\r\n        setIsDepAddOpen(true);\r\n    };\r\n\r\n    const handleEditDepSave = () => {\r\n        if (!editDep) return;\r\n        updateDeployment(editDep.id, { title: editDep.title, version: editDep.version, systemModule: editDep.systemModule, changeType: editDep.changeType, deploymentDate: editDep.deploymentDate, plannedDate: editDep.plannedDate, actualDate: editDep.actualDate, environment: editDep.environment, releaseNotes: editDep.releaseNotes, laneArea: editDep.laneArea, relatedCRId: editDep.relatedCRId, testResultUrl: editDep.testResultUrl }); setEditDep(null);\r\n    };\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <header className={styles.header}>\r\n                <div><h1 className={styles.title}>Releases & Deployments</h1><p className={styles.subtitle}>{safeDeployments.length} deployments</p></div>\r\n                <Button size=\"sm\" onClick={() => setIsDepAddOpen(true)}><Plus size={14} /> Quick Release Log</Button>\r\n            </header>\r\n\r\n            <div className={styles.filterBar} style={{ marginBottom: '1rem', display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>\r\n                <select className={styles.select} style={{ width: 'auto', padding: '0.25rem 0.5rem' }} value={filterEnv} onChange={e => setFilterEnv(e.target.value as any)}>\r\n                    <option value=\"All\">All Environments</option>\r\n                    <option value=\"Staging\">Staging</option>\r\n                    <option value=\"Production\">Production</option>\r\n                    <option value=\"UAT\">UAT</option>\r\n                </select>\r\n                <select className={styles.select} style={{ width: 'auto', padding: '0.25rem 0.5rem' }} value={filterStatus} onChange={e => setFilterStatus(e.target.value as any)}>\r\n                    <option value=\"All\">All Statuses</option>\r\n                    <option value=\"Planned\">Planned</option>\r\n                    <option value=\"In Progress\">In Progress</option>\r\n                    <option value=\"Deployed\">Deployed</option>\r\n                    <option value=\"Rolled Back\">Rolled Back</option>\r\n                </select>\r\n            </div>\r\n\r\n            {/* ‚ïê‚ïê‚ïê DEPLOYMENTS ‚ïê‚ïê‚ïê */}\r\n            {safeDeployments.filter(d => (filterEnv === 'All' || d.environment === filterEnv) && (filterStatus === 'All' || d.status === filterStatus)).length === 0 ? (\r\n                <Card><div className={styles.emptyState}>No deployments match the criteria.</div></Card>\r\n            ) : (\r\n                <div className={styles.itemList}>\r\n                    {safeDeployments.filter(d => (filterEnv === 'All' || d.environment === filterEnv) && (filterStatus === 'All' || d.status === filterStatus)).sort((a, b) => (b.deploymentDate || b.plannedDate || '').localeCompare(a.deploymentDate || a.plannedDate || '')).map(dep => (\r\n                        <Card key={dep.id} className={styles.itemCard}>\r\n                            <div className={styles.itemTop}>\r\n                                <div className={styles.itemLeft}>\r\n                                    <Rocket size={16} style={{ color: 'var(--primary-light)', flexShrink: 0 }} />\r\n                                    <span className={styles.envBadge}>{dep.environment}</span>\r\n                                    {dep.changeType !== 'Release' && <span className={styles.typeBadge} style={{ fontSize: '0.625rem', padding: '0.1rem 0.3rem', background: 'rgba(255,159,67,0.1)', color: '#ff9f43' }}>{dep.changeType}</span>}\r\n                                    <h3 className={styles.itemTitle} onClick={() => setEditDep(dep)}>v{dep.version} {dep.title ? ` - ${dep.title}` : ''}</h3>\r\n                                </div>\r\n                                <div className={styles.itemRight}>\r\n                                    <span className={cn(styles.statusPill, depStatusClass(dep.status))} onClick={() => { const idx = DEP_STATUS_CYCLE.indexOf(dep.status); updateDeployment(dep.id, { status: DEP_STATUS_CYCLE[(idx + 1) % DEP_STATUS_CYCLE.length] }); }} title=\"Click to change\">\r\n                                        {dep.status}<ChevronRight size={10} className={styles.chevron} />\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                            {dep.releaseNotes && <p className={styles.itemDesc}>{dep.releaseNotes}</p>}\r\n                            <div className={styles.itemMeta}>\r\n                                <span>Date: {dep.deploymentDate || dep.plannedDate}</span>\r\n                                <span>Module: {dep.systemModule}</span>\r\n                                {dep.laneArea && <span>Lane: {dep.laneArea}</span>}\r\n                                {dep.relatedCRId && <span style={{ color: 'var(--brand-blue)' }}>CR: {dep.relatedCRId}</span>}\r\n                                <div className={styles.itemActions}>\r\n                                    <button className={styles.actionBtn} onClick={() => handleDuplicate(dep)} title=\"Duplicate\"><Copy size={13} /></button>\r\n                                    <button className={styles.actionBtn} onClick={() => setEditDep(dep)}><Pencil size={13} /></button>\r\n                                    <button className={cn(styles.actionBtn, styles.deleteBtn)} onClick={() => deleteDeployment(dep.id)}><Trash2 size={13} /></button>\r\n                                </div>\r\n                            </div>\r\n                        </Card>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {/* ‚ïê‚ïê‚ïê MODALS ‚ïê‚ïê‚ïê */}\r\n            <Modal isOpen={isDepAddOpen} onClose={() => setIsDepAddOpen(false)} title=\"Quick Release Log\">\r\n                <div className={styles.form}>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Title *</label><input className={styles.input} value={newDep.title} onChange={e => setNewDep({ ...newDep, title: e.target.value })} placeholder=\"Release Name\" autoFocus /></div>\r\n                        <div className={styles.formGroup}><label>Version *</label><input className={styles.input} value={newDep.version} onChange={e => setNewDep({ ...newDep, version: e.target.value })} placeholder=\"e.g. 1.2.0\" /></div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>Change Type</label><select className={styles.select} value={newDep.changeType} onChange={e => setNewDep({ ...newDep, changeType: e.target.value as DeployChangeType })}><option>Release</option><option>Patch</option><option>Hotfix</option><option>Config</option></select></div>\r\n                        <div className={styles.formGroup}><label>Environment</label><select className={styles.select} value={newDep.environment} onChange={e => setNewDep({ ...newDep, environment: e.target.value as Deployment['environment'] })}><option>Staging</option><option>Production</option><option>UAT</option></select></div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}><label>System / Module</label><input className={styles.input} value={newDep.systemModule} onChange={e => setNewDep({ ...newDep, systemModule: e.target.value })} placeholder=\"Core, API, etc.\" /></div>\r\n                        <div className={styles.formGroup}><label>Date</label><input type=\"date\" className={styles.input} value={newDep.deploymentDate} onChange={e => setNewDep({ ...newDep, deploymentDate: e.target.value })} /></div>\r\n                    </div>\r\n                    <div className={styles.formGroup}><label>Release Notes</label><textarea className={styles.textarea} value={newDep.releaseNotes} onChange={e => setNewDep({ ...newDep, releaseNotes: e.target.value })} placeholder=\"Summary of changes...\" rows={3} /></div>\r\n\r\n                    <details style={{ marginTop: '0.5rem' }}>\r\n                        <summary style={{ fontSize: '0.75rem', color: 'var(--text-muted)', cursor: 'pointer', userSelect: 'none' }}>Advanced options...</summary>\r\n                        <div className={styles.formRow} style={{ marginTop: '0.5rem' }}>\r\n                            <div className={styles.formGroup}><label>Lane / Area</label><input className={styles.input} value={newDep.laneArea} onChange={e => setNewDep({ ...newDep, laneArea: e.target.value })} placeholder=\"e.g. Gate 1, Yard B\" /></div>\r\n                            <div className={styles.formGroup}><label>Related CR / Issue</label><input className={styles.input} value={newDep.relatedCRId} onChange={e => setNewDep({ ...newDep, relatedCRId: e.target.value })} placeholder=\"CR-001\" /></div>\r\n                        </div>\r\n                        <div className={styles.formGroup}><label>Test Result Link</label><input className={styles.input} value={newDep.testResultUrl} onChange={e => setNewDep({ ...newDep, testResultUrl: e.target.value })} placeholder=\"URL to test execution...\" /></div>\r\n                    </details>\r\n\r\n                    <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setIsDepAddOpen(false)}>Cancel</Button><Button onClick={handleAddDeployment}>Log Release</Button></div>\r\n                </div>\r\n            </Modal>\r\n\r\n            <Modal isOpen={!!editDep} onClose={() => setEditDep(null)} title=\"Edit Release Log\">\r\n                {editDep && (\r\n                    <div className={styles.form}>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Title *</label><input className={styles.input} value={editDep.title} onChange={e => setEditDep({ ...editDep, title: e.target.value })} /></div>\r\n                            <div className={styles.formGroup}><label>Version *</label><input className={styles.input} value={editDep.version} onChange={e => setEditDep({ ...editDep, version: e.target.value })} /></div>\r\n                        </div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Change Type</label><select className={styles.select} value={editDep.changeType} onChange={e => setEditDep({ ...editDep, changeType: e.target.value as DeployChangeType })}><option>Release</option><option>Patch</option><option>Hotfix</option><option>Config</option></select></div>\r\n                            <div className={styles.formGroup}><label>Environment</label><select className={styles.select} value={editDep.environment} onChange={e => setEditDep({ ...editDep, environment: e.target.value as Deployment['environment'] })}><option>Staging</option><option>Production</option><option>UAT</option></select></div>\r\n                        </div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>System / Module</label><input className={styles.input} value={editDep.systemModule} onChange={e => setEditDep({ ...editDep, systemModule: e.target.value })} /></div>\r\n                            <div className={styles.formGroup}><label>Date</label><input type=\"date\" className={styles.input} value={editDep.deploymentDate} onChange={e => setEditDep({ ...editDep, deploymentDate: e.target.value })} /></div>\r\n                        </div>\r\n                        <div className={styles.formGroup}><label>Release Notes</label><textarea className={styles.textarea} value={editDep.releaseNotes || ''} onChange={e => setEditDep({ ...editDep, releaseNotes: e.target.value })} rows={3} /></div>\r\n\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}><label>Lane / Area</label><input className={styles.input} value={editDep.laneArea || ''} onChange={e => setEditDep({ ...editDep, laneArea: e.target.value })} /></div>\r\n                            <div className={styles.formGroup}><label>Related CR / Issue</label><input className={styles.input} value={editDep.relatedCRId || ''} onChange={e => setEditDep({ ...editDep, relatedCRId: e.target.value })} /></div>\r\n                        </div>\r\n                        <div className={styles.formGroup}><label>Test Result Link</label><input className={styles.input} value={editDep.testResultUrl || ''} onChange={e => setEditDep({ ...editDep, testResultUrl: e.target.value })} /></div>\r\n\r\n                        <div className={styles.formActions}><Button variant=\"ghost\" onClick={() => setEditDep(null)}>Cancel</Button><Button onClick={handleEditDepSave}>Save</Button></div>\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\reports\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":249,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":249,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11649,11652],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11649,11652],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":437,"column":93,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":437,"endColumn":96,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[24048,24051],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[24048,24051],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useMemo } from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Card } from '@/app/components/ui/Card';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Badge } from '@/app/components/ui/Badge';\r\nimport { Mail, Copy, Calendar } from 'lucide-react';\r\nimport styles from './page.module.css';\r\nimport { cn } from '@/lib/utils';\r\n\r\nfunction getWeekRange() {\r\n    const now = new Date();\r\n    const day = now.getDay();\r\n    const start = new Date(now);\r\n    start.setDate(now.getDate() - (day === 0 ? 6 : day - 1));\r\n    const end = new Date(start);\r\n    end.setDate(start.getDate() + 6);\r\n    return { start: start.toISOString().split('T')[0], end: end.toISOString().split('T')[0] };\r\n}\r\n\r\nfunction getMonthRange() {\r\n    const now = new Date();\r\n    const start = new Date(now.getFullYear(), now.getMonth(), 1);\r\n    const end = new Date(now.getFullYear(), now.getMonth() + 1, 0);\r\n    return { start: start.toISOString().split('T')[0], end: end.toISOString().split('T')[0] };\r\n}\r\n\r\nexport default function ReportsPage() {\r\n    const { tasks, issues, members, projectInfo, risks = [], changeRequests = [], deployments = [], milestones = [] } = useProject();\r\n\r\n    const today = new Date().toISOString().split('T')[0];\r\n    const projectName = projectInfo?.name || 'AGS Project';\r\n\r\n    // Date range state\r\n    const [rangeStart, setRangeStart] = useState('');\r\n    const [rangeEnd, setRangeEnd] = useState('');\r\n    const [activePreset, setActivePreset] = useState<string>('all');\r\n\r\n    // Template State\r\n    const [activeTemplate, setActiveTemplate] = useState<'progress' | 'risk' | 'change' | 'weekly'>('progress');\r\n\r\n    const setPreset = (preset: string) => {\r\n        setActivePreset(preset);\r\n        switch (preset) {\r\n            case 'today':\r\n                setRangeStart(today);\r\n                setRangeEnd(today);\r\n                break;\r\n            case 'week': {\r\n                const w = getWeekRange();\r\n                setRangeStart(w.start);\r\n                setRangeEnd(w.end);\r\n                break;\r\n            }\r\n            case 'month': {\r\n                const m = getMonthRange();\r\n                setRangeStart(m.start);\r\n                setRangeEnd(m.end);\r\n                break;\r\n            }\r\n            case 'all':\r\n            default:\r\n                setRangeStart('');\r\n                setRangeEnd('');\r\n                break;\r\n        }\r\n    };\r\n\r\n    // Filter by date range\r\n    const filteredTasks = useMemo(() => {\r\n        if (!rangeStart && !rangeEnd) return tasks;\r\n        return tasks.filter(t => {\r\n            // Task overlaps with range if task.start <= rangeEnd && task.due >= rangeStart\r\n            if (rangeEnd && t.startDate > rangeEnd) return false;\r\n            if (rangeStart && t.dueDate < rangeStart) return false;\r\n            return true;\r\n        });\r\n    }, [tasks, rangeStart, rangeEnd]);\r\n\r\n    const filteredIssues = useMemo(() => {\r\n        if (!rangeStart && !rangeEnd) return issues;\r\n        return issues.filter(i => {\r\n            const created = i.createdAt.split('T')[0];\r\n            if (rangeStart && created < rangeStart) return false;\r\n            if (rangeEnd && created > rangeEnd) return false;\r\n            return true;\r\n        });\r\n    }, [issues, rangeStart, rangeEnd]);\r\n\r\n    const stats = useMemo(() => {\r\n        const total = filteredTasks.length;\r\n        const done = filteredTasks.filter(t => t.status === 'Done').length;\r\n        const inProgress = filteredTasks.filter(t => t.status === 'In Progress').length;\r\n        const blocked = filteredTasks.filter(t => t.status === 'Blocked').length;\r\n        const notStarted = filteredTasks.filter(t => t.status === 'Not Started').length;\r\n        const progress = total ? Math.round((done / total) * 100) : 0;\r\n        const overdue = filteredTasks.filter(t => t.dueDate < today && t.status !== 'Done').length;\r\n        const openIssues = filteredIssues.filter(i => i.status !== 'Resolved' && i.status !== 'Closed').length;\r\n        const highIssues = filteredIssues.filter(i => (i.severity === 'S1' || i.severity === 'S2') && i.status !== 'Resolved' && i.status !== 'Closed').length;\r\n        return { total, done, inProgress, blocked, notStarted, progress, overdue, openIssues, highIssues };\r\n    }, [filteredTasks, filteredIssues, today]);\r\n\r\n    const rangeLabel = rangeStart || rangeEnd\r\n        ? `${rangeStart || '‚Äî'} ~ ${rangeEnd || '‚Äî'}`\r\n        : 'All Time';\r\n\r\n    const generateReportText = () => {\r\n        const titleMap = { progress: 'Progress Report', risk: 'Risk & Issue Summary', change: 'Change & Release Details', weekly: 'Weekly PM Summary' };\r\n        let text = `=== ${projectName} ‚Äî ${titleMap[activeTemplate]} ===\\n`;\r\n        text += `Date: ${today}\\n`;\r\n        text += `Report Period: ${rangeLabel}\\n`;\r\n        if (projectInfo?.manager) text += `Manager: ${projectInfo.manager}\\n`;\r\n        text += `Period: ${projectInfo?.startDate || '-'} ~ ${projectInfo?.endDate || '-'}\\n\\n`;\r\n\r\n        if (activeTemplate === 'progress') {\r\n            text += `## Task Summary\\n`;\r\n            text += `Total: ${stats.total} | Done: ${stats.done} | In Progress: ${stats.inProgress} | Blocked: ${stats.blocked} | Not Started: ${stats.notStarted}\\n`;\r\n            text += `Overall Progress: ${stats.progress}%\\n`;\r\n            if (stats.overdue > 0) text += `‚ö† Overdue: ${stats.overdue} task(s)\\n\\n`;\r\n            text += `## Task Details\\n`;\r\n            filteredTasks.forEach(t => {\r\n                text += `- [${t.status}] ${t.title} (${t.priority}, ${t.startDate} ~ ${t.dueDate})\\n`;\r\n            });\r\n            text += `\\n`;\r\n            if (members.length > 0) {\r\n                text += `## Team (${members.length})\\n`;\r\n                members.forEach(m => {\r\n                    text += `- ${m.name} ‚Äî ${m.role} (${m.team})\\n`;\r\n                });\r\n            }\r\n        } else if (activeTemplate === 'risk') {\r\n            text += `## Risk Summary\\n`;\r\n            const openRisks = risks.filter(r => r.status === 'Open');\r\n            text += `Total Risks: ${risks.length} | Open: ${openRisks.length}\\n\\n`;\r\n            risks.forEach(r => {\r\n                text += `- [${r.status}] [${r.probability}/${r.impact}] ${r.title}\\n`;\r\n            });\r\n            text += `\\n## Issue Summary\\n`;\r\n            text += `Total Issues: ${filteredIssues.length} | Open: ${stats.openIssues} | High: ${stats.highIssues}\\n\\n`;\r\n            filteredIssues.forEach(i => {\r\n                text += `- [${i.status}] [${i.severity}] ${i.title}\\n`;\r\n            });\r\n        } else if (activeTemplate === 'change') {\r\n            text += `## Change Requests\\n`;\r\n            changeRequests.forEach(c => {\r\n                text += `- [${c.status}] ${c.title} (${c.changeType})\\n`;\r\n            });\r\n            text += `\\n## Deployments\\n`;\r\n            deployments.forEach(d => {\r\n                text += `- [${d.status}] ${d.title} (v${d.version}, ${d.environment})\\n`;\r\n            });\r\n        } else if (activeTemplate === 'weekly') {\r\n            text += `## Weekly PM Summary\\n`;\r\n            text += `1. Current Status\\n`;\r\n            text += `   - Schedule Progress: ${stats.progress}%\\n`;\r\n            text += `   - Open High Risks/Issues: ${stats.highIssues}\\n`;\r\n            text += `\\n2. Key Accomplishments\\n`;\r\n            filteredTasks.filter(t => t.status === 'Done').slice(0, 5).forEach(t => text += `   - ${t.title}\\n`);\r\n            text += `\\n3. Upcoming Milestones & Tasks\\n`;\r\n            milestones.filter(m => m.status !== 'Completed').slice(0, 3).forEach(m => text += `   - üèÅ ${m.title} (${m.date})\\n`);\r\n            text += `\\n4. Blockers & Help Needed\\n`;\r\n            filteredTasks.filter(t => t.status === 'Blocked').forEach(t => text += `   - Blocking Task: ${t.title}\\n`);\r\n            risks.filter(r => r.status === 'Open' && r.impact === 'High').forEach(r => text += `   - High Risk: ${r.title}\\n`);\r\n        }\r\n\r\n        return text;\r\n    };\r\n\r\n    const handleCopy = () => {\r\n        navigator.clipboard.writeText(generateReportText());\r\n    };\r\n\r\n    const handleEmail = () => {\r\n        const subject = encodeURIComponent(`${projectName} ‚Äî Progress Report (${rangeLabel})`);\r\n        const body = encodeURIComponent(generateReportText());\r\n        window.open(`mailto:?subject=${subject}&body=${body}`);\r\n    };\r\n\r\n    const statusMiniClass = (s: string) => {\r\n        switch (s) {\r\n            case 'Not Started': return styles.stNotStarted;\r\n            case 'In Progress': return styles.stInProgress;\r\n            case 'Done': return styles.stDone;\r\n            case 'Blocked': return styles.stBlocked;\r\n            default: return '';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <header className={styles.header}>\r\n                <div className={styles.headerLeft}>\r\n                    <h1 className={styles.title}>Reports</h1>\r\n                    <p className={styles.subtitle}>Project progress report</p>\r\n                </div>\r\n                <div className={styles.controls}>\r\n                    <Button variant=\"ghost\" size=\"sm\" onClick={handleCopy}>\r\n                        <Copy size={14} /> Copy\r\n                    </Button>\r\n                    <Button size=\"sm\" onClick={handleEmail}>\r\n                        <Mail size={14} /> Email Report\r\n                    </Button>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Date Range Filter */}\r\n            <div className={styles.dateFilter}>\r\n                <div className={styles.dateInputs}>\r\n                    <Calendar size={14} style={{ color: 'var(--foreground-muted)', flexShrink: 0 }} />\r\n                    <input\r\n                        type=\"date\"\r\n                        className={styles.dateInput}\r\n                        value={rangeStart}\r\n                        onChange={(e) => { setRangeStart(e.target.value); setActivePreset('custom'); }}\r\n                    />\r\n                    <span className={styles.dateSeparator}>~</span>\r\n                    <input\r\n                        type=\"date\"\r\n                        className={styles.dateInput}\r\n                        value={rangeEnd}\r\n                        onChange={(e) => { setRangeEnd(e.target.value); setActivePreset('custom'); }}\r\n                    />\r\n                </div>\r\n                <div className={styles.datePresets}>\r\n                    {['today', 'week', 'month', 'all'].map(p => (\r\n                        <button\r\n                            key={p}\r\n                            className={cn(styles.presetBtn, activePreset === p && styles.presetActive)}\r\n                            onClick={() => setPreset(p)}\r\n                        >\r\n                            {p === 'today' ? 'Today' : p === 'week' ? 'This Week' : p === 'month' ? 'This Month' : 'All'}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Template Selector */}\r\n            <div className={styles.templateTabs}>\r\n                {[\r\n                    { id: 'progress', label: 'Progress Report' },\r\n                    { id: 'risk', label: 'Risk & Issue Summary' },\r\n                    { id: 'change', label: 'Change & Release Details' },\r\n                    { id: 'weekly', label: 'Weekly PM Summary' },\r\n                ].map(t => (\r\n                    <button\r\n                        key={t.id}\r\n                        className={cn(styles.tabBtn, activeTemplate === t.id && styles.tabActive)}\r\n                        onClick={() => setActiveTemplate(t.id as any)}\r\n                    >\r\n                        {t.label}\r\n                    </button>\r\n                ))}\r\n            </div>\r\n\r\n            <Card className={styles.reportCard}>\r\n                {/* Report Header */}\r\n                <div className={styles.reportHeader}>\r\n                    <h2 className={styles.reportTitle}>\r\n                        {projectName} ‚Äî {activeTemplate === 'progress' ? 'Progress Report' : activeTemplate === 'risk' ? 'Risk & Issue Summary' : activeTemplate === 'change' ? 'Change & Release Details' : 'Weekly PM Summary'}\r\n                    </h2>\r\n                    <p className={styles.reportDate}>Generated: {today} ¬∑ Period: {rangeLabel}</p>\r\n                    <div className={styles.reportMeta}>\r\n                        {projectInfo?.manager && (\r\n                            <div className={styles.reportMetaItem}>\r\n                                <span className={styles.reportMetaLabel}>Manager</span>\r\n                                <span className={styles.reportMetaValue}>{projectInfo.manager}</span>\r\n                            </div>\r\n                        )}\r\n                        <div className={styles.reportMetaItem}>\r\n                            <span className={styles.reportMetaLabel}>Period</span>\r\n                            <span className={styles.reportMetaValue}>{projectInfo?.startDate || '‚Äî'} ~ {projectInfo?.endDate || '‚Äî'}</span>\r\n                        </div>\r\n                        <div className={styles.reportMetaItem}>\r\n                            <span className={styles.reportMetaLabel}>Team Size</span>\r\n                            <span className={styles.reportMetaValue}>{members.length}</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* 1. Progress Template */}\r\n                {activeTemplate === 'progress' && (\r\n                    <>\r\n                        {/* Summary Grid */}\r\n                        <div className={styles.section}>\r\n                            <h3 className={styles.sectionTitle}>Task Summary</h3>\r\n                            <div className={styles.summaryGrid}>\r\n                                <div className={styles.summaryItem}>\r\n                                    <div className={styles.summaryNumber}>{stats.total}</div>\r\n                                    <div className={styles.summaryLabel}>Total Tasks</div>\r\n                                </div>\r\n                                <div className={styles.summaryItem}>\r\n                                    <div className={styles.summaryNumber} style={{ color: 'var(--success)' }}>{stats.done}</div>\r\n                                    <div className={styles.summaryLabel}>Completed</div>\r\n                                </div>\r\n                                <div className={styles.summaryItem}>\r\n                                    <div className={styles.summaryNumber} style={{ color: 'var(--primary-light)' }}>{stats.inProgress}</div>\r\n                                    <div className={styles.summaryLabel}>In Progress</div>\r\n                                </div>\r\n                                <div className={styles.summaryItem}>\r\n                                    <div className={styles.summaryNumber} style={{ color: stats.blocked > 0 ? 'var(--danger)' : 'var(--foreground-muted)' }}>{stats.blocked}</div>\r\n                                    <div className={styles.summaryLabel}>Blocked</div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Progress bar */}\r\n                            <div className={styles.progressBarWrapper}>\r\n                                <div className={styles.progressBarOuter}>\r\n                                    {stats.total > 0 && (\r\n                                        <>\r\n                                            <div className={cn(styles.progressBarSeg, styles.segDone)} style={{ width: `${(stats.done / stats.total) * 100}%` }} />\r\n                                            <div className={cn(styles.progressBarSeg, styles.segProgress)} style={{ width: `${(stats.inProgress / stats.total) * 100}%` }} />\r\n                                            <div className={cn(styles.progressBarSeg, styles.segBlocked)} style={{ width: `${(stats.blocked / stats.total) * 100}%` }} />\r\n                                            <div className={cn(styles.progressBarSeg, styles.segNotStarted)} style={{ width: `${(stats.notStarted / stats.total) * 100}%` }} />\r\n                                        </>\r\n                                    )}\r\n                                </div>\r\n                                <div className={styles.progressLegend}>\r\n                                    <div className={styles.legendItem}><div className={styles.legendDot} style={{ background: 'var(--success)' }} /> Done ({stats.done})</div>\r\n                                    <div className={styles.legendItem}><div className={styles.legendDot} style={{ background: 'var(--primary)' }} /> In Progress ({stats.inProgress})</div>\r\n                                    <div className={styles.legendItem}><div className={styles.legendDot} style={{ background: 'var(--danger)' }} /> Blocked ({stats.blocked})</div>\r\n                                    <div className={styles.legendItem}><div className={styles.legendDot} style={{ background: 'rgba(122, 139, 181, 0.3)' }} /> Not Started ({stats.notStarted})</div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Task Details */}\r\n                        <div className={styles.section}>\r\n                            <h3 className={styles.sectionTitle}>Task Details</h3>\r\n                            {filteredTasks.length === 0 ? (\r\n                                <p className={styles.noData}>No tasks in the selected date range.</p>\r\n                            ) : (\r\n                                <table className={styles.taskTable}>\r\n                                    <thead>\r\n                                        <tr>\r\n                                            <th>Task</th>\r\n                                            <th>Status</th>\r\n                                            <th>Priority</th>\r\n                                            <th>Due</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {filteredTasks.map(task => (\r\n                                            <tr key={task.id}>\r\n                                                <td>{task.parentId ? `  ‚Ü≥ ${task.title}` : task.title}</td>\r\n                                                <td><span className={cn(styles.statusMini, statusMiniClass(task.status))}>{task.status}</span></td>\r\n                                                <td>{task.priority}</td>\r\n                                                <td>{task.dueDate}</td>\r\n                                            </tr>\r\n                                        ))}\r\n                                    </tbody>\r\n                                </table>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Issues */}\r\n                        <div className={styles.section}>\r\n                            <h3 className={styles.sectionTitle}>Issues ({filteredIssues.length})</h3>\r\n                            {filteredIssues.length === 0 ? (\r\n                                <p className={styles.noData}>No issues in the selected date range.</p>\r\n                            ) : (\r\n                                filteredIssues.map(issue => (\r\n                                    <div key={issue.id} className={styles.issueLine}>\r\n                                        <span className={styles.issueLineTitle}>\r\n                                            <Badge variant={issue.severity.toLowerCase() as 's1' | 's2' | 's3' | 's4'}>{issue.severity}</Badge>{' '}\r\n                                            {issue.title}\r\n                                        </span>\r\n                                        <span className={cn(styles.statusMini, statusMiniClass(issue.status))}>{issue.status}</span>\r\n                                    </div>\r\n                                ))\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Team */}\r\n                        {members.length > 0 && (\r\n                            <div className={styles.section}>\r\n                                <h3 className={styles.sectionTitle}>Team ({members.length})</h3>\r\n                                <table className={styles.taskTable}>\r\n                                    <thead>\r\n                                        <tr>\r\n                                            <th>Name</th>\r\n                                            <th>Role</th>\r\n                                            <th>Team</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {members.map(m => (\r\n                                            <tr key={m.id}>\r\n                                                <td>{m.name}</td>\r\n                                                <td>{m.role}</td>\r\n                                                <td>{m.team}</td>\r\n                                            </tr>\r\n                                        ))}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        )}\r\n                    </>\r\n                )}\r\n\r\n                {/* 2. Risk & Issue Template */}\r\n                {activeTemplate === 'risk' && (\r\n                    <>\r\n                        <div className={styles.section}>\r\n                            <h3 className={styles.sectionTitle}>Risk Summary</h3>\r\n                            <div className={styles.summaryGrid}>\r\n                                <div className={styles.summaryItem}>\r\n                                    <div className={styles.summaryNumber}>{risks.length}</div>\r\n                                    <div className={styles.summaryLabel}>Total Risks</div>\r\n                                </div>\r\n                                <div className={styles.summaryItem}>\r\n                                    <div className={styles.summaryNumber} style={{ color: 'var(--danger)' }}>{risks.filter(r => r.status === 'Open').length}</div>\r\n                                    <div className={styles.summaryLabel}>Open Risks</div>\r\n                                </div>\r\n                            </div>\r\n                            <table className={styles.taskTable} style={{ marginTop: '1rem' }}>\r\n                                <thead><tr><th>Risk</th><th>Status</th><th>Prob/Impact</th></tr></thead>\r\n                                <tbody>\r\n                                    {risks.map(r => (\r\n                                        <tr key={r.id}>\r\n                                            <td>{r.title}</td>\r\n                                            <td><span className={cn(styles.statusMini, r.status === 'Open' ? styles.stBlocked : styles.stDone)}>{r.status}</span></td>\r\n                                            <td>{r.probability}/{r.impact}</td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                        <div className={styles.section}>\r\n                            <h3 className={styles.sectionTitle}>Issues ({filteredIssues.length})</h3>\r\n                            {filteredIssues.length === 0 ? (\r\n                                <p className={styles.noData}>No issues in the selected date range.</p>\r\n                            ) : (\r\n                                filteredIssues.map(issue => (\r\n                                    <div key={issue.id} className={styles.issueLine}>\r\n                                        <span className={styles.issueLineTitle}>\r\n                                            <Badge variant={issue.severity.toLowerCase() as any}>{issue.severity}</Badge>{' '}\r\n                                            {issue.title}\r\n                                        </span>\r\n                                        <span className={cn(styles.statusMini, statusMiniClass(issue.status))}>{issue.status}</span>\r\n                                    </div>\r\n                                ))\r\n                            )}\r\n                        </div>\r\n                    </>\r\n                )}\r\n\r\n                {/* 3. Change & Release Template */}\r\n                {activeTemplate === 'change' && (\r\n                    <>\r\n                        <div className={styles.section}>\r\n                            <h3 className={styles.sectionTitle}>Change Requests</h3>\r\n                            {changeRequests.length === 0 ? <p className={styles.noData}>No change requests found.</p> : (\r\n                                <table className={styles.taskTable}>\r\n                                    <thead><tr><th>Title</th><th>Status</th><th>Type</th></tr></thead>\r\n                                    <tbody>\r\n                                        {changeRequests.map(c => (\r\n                                            <tr key={c.id}>\r\n                                                <td>{c.title}</td>\r\n                                                <td><span className={cn(styles.statusMini, c.status === 'Pending' ? styles.stNotStarted : styles.stDone)}>{c.status}</span></td>\r\n                                                <td>{c.changeType}</td>\r\n                                            </tr>\r\n                                        ))}\r\n                                    </tbody>\r\n                                </table>\r\n                            )}\r\n                        </div>\r\n                        <div className={styles.section}>\r\n                            <h3 className={styles.sectionTitle}>Deployments</h3>\r\n                            {deployments.length === 0 ? <p className={styles.noData}>No recent deployments.</p> : (\r\n                                <table className={styles.taskTable}>\r\n                                    <thead><tr><th>Title</th><th>Status</th><th>Environment</th><th>Version</th></tr></thead>\r\n                                    <tbody>\r\n                                        {deployments.map(d => (\r\n                                            <tr key={d.id}>\r\n                                                <td>{d.title}</td>\r\n                                                <td><span className={cn(styles.statusMini, d.status === 'Failed' ? styles.stBlocked : styles.stDone)}>{d.status}</span></td>\r\n                                                <td>{d.environment}</td>\r\n                                                <td>v{d.version}</td>\r\n                                            </tr>\r\n                                        ))}\r\n                                    </tbody>\r\n                                </table>\r\n                            )}\r\n                        </div>\r\n                    </>\r\n                )}\r\n\r\n                {/* 4. Weekly PM Summary Template */}\r\n                {activeTemplate === 'weekly' && (\r\n                    <div className={styles.section}>\r\n                        <h3 className={styles.sectionTitle}>Weekly Update</h3>\r\n\r\n                        <h4 style={{ fontSize: '0.875rem', marginTop: '1rem', color: 'var(--foreground)' }}>1. Current Status</h4>\r\n                        <ul style={{ fontSize: '0.8125rem', color: 'var(--foreground)', lineHeight: '1.6', margin: '0.5rem 0', paddingLeft: '1.2rem' }}>\r\n                            <li>Schedule Progress: <strong>{stats.progress}%</strong></li>\r\n                            <li>Open High Risks/Issues: <strong>{stats.highIssues}</strong></li>\r\n                        </ul>\r\n\r\n                        <h4 style={{ fontSize: '0.875rem', marginTop: '1rem', color: 'var(--foreground)' }}>2. Key Accomplishments</h4>\r\n                        <ul style={{ fontSize: '0.8125rem', color: 'var(--foreground)', lineHeight: '1.6', margin: '0.5rem 0', paddingLeft: '1.2rem' }}>\r\n                            {filteredTasks.filter(t => t.status === 'Done').slice(0, 5).map(t => <li key={t.id}>{t.title}</li>)}\r\n                            {filteredTasks.filter(t => t.status === 'Done').length === 0 && <li className={styles.noData} style={{ listStyle: 'none', marginLeft: '-1.2rem' }}>No recent completions.</li>}\r\n                        </ul>\r\n\r\n                        <h4 style={{ fontSize: '0.875rem', marginTop: '1rem', color: 'var(--foreground)' }}>3. Upcoming Milestones</h4>\r\n                        <ul style={{ fontSize: '0.8125rem', color: 'var(--foreground)', lineHeight: '1.6', margin: '0.5rem 0', paddingLeft: '1.2rem' }}>\r\n                            {milestones.filter(m => m.status !== 'Completed').slice(0, 3).map(m => <li key={m.id}>üèÅ {m.title} ({m.date})</li>)}\r\n                            {milestones.length === 0 && <li className={styles.noData} style={{ listStyle: 'none', marginLeft: '-1.2rem' }}>No upcoming milestones.</li>}\r\n                        </ul>\r\n\r\n                        <h4 style={{ fontSize: '0.875rem', marginTop: '1rem', color: 'var(--foreground)' }}>4. Blockers & Help Needed</h4>\r\n                        <ul style={{ fontSize: '0.8125rem', color: 'var(--foreground)', lineHeight: '1.6', margin: '0.5rem 0', paddingLeft: '1.2rem' }}>\r\n                            {filteredTasks.filter(t => t.status === 'Blocked').map(t => <li key={t.id} style={{ color: 'var(--danger)' }}>Blocked Task: {t.title}</li>)}\r\n                            {risks.filter(r => r.status === 'Open' && r.impact === 'High').map(r => <li key={r.id} style={{ color: 'var(--danger)' }}>High Risk: {r.title}</li>)}\r\n                            {filteredTasks.filter(t => t.status === 'Blocked').length === 0 && risks.filter(r => r.status === 'Open' && r.impact === 'High').length === 0 && <li className={styles.noData} style={{ listStyle: 'none', marginLeft: '-1.2rem' }}>None at this time.</li>}\r\n                        </ul>\r\n                    </div>\r\n                )}\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\schedule\\GanttView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\schedule\\ListView.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":141,"column":45,"nodeType":"JSXOpeningElement","endLine":141,"endColumn":136}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Task, TaskStatus } from '@/types';\r\nimport { Pencil, Trash2, CornerDownRight, ChevronRight, Flag } from 'lucide-react';\r\nimport styles from './ListView.module.css';\r\nimport { cn } from '@/lib/utils';\r\n\r\nconst STATUS_CYCLE: TaskStatus[] = ['Not Started', 'In Progress', 'Done', 'Blocked'];\r\n\r\nconst statusClass = (s: TaskStatus) => {\r\n    switch (s) {\r\n        case 'Not Started': return styles.statusNotStarted;\r\n        case 'In Progress': return styles.statusInProgress;\r\n        case 'Done': return styles.statusDone;\r\n        case 'Blocked': return styles.statusBlocked;\r\n    }\r\n};\r\n\r\nconst priorityClass = (p: string) => {\r\n    switch (p) {\r\n        case 'P0': return styles.p0;\r\n        case 'P1': return styles.p1;\r\n        case 'P2': return styles.p2;\r\n        case 'P3': return styles.p3;\r\n        default: return styles.p2;\r\n    }\r\n};\r\n\r\nconst progressColor = (p: number) => {\r\n    if (p >= 80) return '#55efc4';\r\n    if (p >= 50) return '#6c5ce7';\r\n    if (p >= 20) return '#ffeaa7';\r\n    return '#636e72';\r\n};\r\n\r\ninterface Props {\r\n    onEditTask: (task: Task) => void;\r\n    filters?: { overdue: boolean; thisWeek: boolean; blocked: boolean; };\r\n}\r\n\r\nexport default function ListView({ onEditTask, filters }: Props) {\r\n    const { tasks, updateTask, deleteTask, members } = useProject();\r\n\r\n    const cycleStatus = (task: Task) => {\r\n        const idx = STATUS_CYCLE.indexOf(task.status);\r\n        const next = STATUS_CYCLE[(idx + 1) % STATUS_CYCLE.length];\r\n        updateTask(task.id, { status: next });\r\n    };\r\n\r\n    // Build parent ‚Üí children tree\r\n    const parentTasks = tasks.filter(t => !t.parentId);\r\n    const getChildren = (parentId: string) => tasks.filter(t => t.parentId === parentId);\r\n\r\n    // Flatten in order: parent, then its children\r\n    const orderedTasks: { task: Task; isChild: boolean }[] = [];\r\n    parentTasks.forEach(parent => {\r\n        orderedTasks.push({ task: parent, isChild: false });\r\n        getChildren(parent.id).forEach(child => {\r\n            orderedTasks.push({ task: child, isChild: true });\r\n        });\r\n    });\r\n\r\n    let displayTasks = orderedTasks;\r\n    if (filters) {\r\n        if (filters.blocked) {\r\n            displayTasks = displayTasks.filter(t => t.task.status === 'Blocked');\r\n        }\r\n        if (filters.overdue) {\r\n            const today = new Date().toISOString().split('T')[0];\r\n            displayTasks = displayTasks.filter(t => t.task.dueDate < today && t.task.status !== 'Done');\r\n        }\r\n        if (filters.thisWeek) {\r\n            const today = new Date();\r\n            const nextWeek = new Date(today);\r\n            nextWeek.setDate(today.getDate() + 7);\r\n            const todayStr = today.toISOString().split('T')[0];\r\n            const nextWeekStr = nextWeek.toISOString().split('T')[0];\r\n            displayTasks = displayTasks.filter(t => t.task.dueDate >= todayStr && t.task.dueDate <= nextWeekStr);\r\n        }\r\n    }\r\n\r\n    if (displayTasks.length === 0) {\r\n        return <div className={styles.emptyState}>No tasks found. Adjust filters or add a new task.</div>;\r\n    }\r\n\r\n    return (\r\n        <div className={styles.tableWrapper}>\r\n            <table className={styles.table}>\r\n                <thead>\r\n                    <tr>\r\n                        <th style={{ minWidth: '200px' }}>Task</th>\r\n                        <th>Owner</th>\r\n                        <th>Workstream</th>\r\n                        <th>Status</th>\r\n                        <th>Progress</th>\r\n                        <th>Priority</th>\r\n                        <th>Start</th>\r\n                        <th>Due</th>\r\n                        <th>Dependencies</th>\r\n                        <th style={{ width: 80 }}></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {displayTasks.map(({ task, isChild }) => {\r\n                        const owner = members.find(m => m.id === task.ownerId);\r\n                        const depTask = task.dependencies && task.dependencies.length > 0 ? tasks.find(t => t.id === task.dependencies![0]) : null;\r\n                        return (\r\n                            <tr key={task.id} style={task.isMilestone ? { background: 'rgba(108,92,231,0.04)' } : undefined}>\r\n                                <td>\r\n                                    <div className={cn(styles.taskName, isChild && styles.subIndent)}>\r\n                                        {isChild && <CornerDownRight size={14} className={styles.subIcon} />}\r\n                                        {task.isMilestone && <Flag size={13} style={{ color: '#a29bfe', flexShrink: 0 }} />}\r\n                                        <span\r\n                                            className={styles.taskTitle}\r\n                                            onClick={() => onEditTask(task)}\r\n                                            style={task.isMilestone ? { fontWeight: 600 } : undefined}\r\n                                        >\r\n                                            {task.title}\r\n                                        </span>\r\n                                        {task.isMilestone && (\r\n                                            <span style={{\r\n                                                fontSize: '0.5625rem',\r\n                                                background: 'rgba(108,92,231,0.15)',\r\n                                                color: '#a29bfe',\r\n                                                padding: '0.0625rem 0.375rem',\r\n                                                borderRadius: '9999px',\r\n                                                fontWeight: 600,\r\n                                                letterSpacing: '0.03em',\r\n                                                textTransform: 'uppercase' as const,\r\n                                            }}>\r\n                                                Milestone\r\n                                            </span>\r\n                                        )}\r\n                                    </div>\r\n                                </td>\r\n                                <td>\r\n                                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.375rem' }}>\r\n                                        {owner?.avatarUrl ? (\r\n                                            <img src={owner.avatarUrl} alt=\"\" style={{ width: 20, height: 20, borderRadius: '50%' }} />\r\n                                        ) : owner ? (\r\n                                            <div style={{ width: 20, height: 20, borderRadius: '50%', background: 'var(--primary)', color: 'white', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '10px' }}>{owner.name.charAt(0)}</div>\r\n                                        ) : null}\r\n                                        <span style={{ fontSize: '0.8125rem' }}>{owner ? owner.name : <span style={{ color: 'var(--foreground-muted)' }}>-</span>}</span>\r\n                                    </div>\r\n                                </td>\r\n                                <td>\r\n                                    <span style={{ fontSize: '0.75rem', background: task.workstream ? 'var(--secondary)' : 'transparent', padding: task.workstream ? '0.2rem 0.5rem' : '0', borderRadius: '12px', color: task.workstream ? 'var(--foreground)' : 'var(--foreground-muted)' }}>\r\n                                        {task.workstream || '-'}\r\n                                    </span>\r\n                                </td>\r\n                                <td>\r\n                                    <span\r\n                                        className={cn(styles.statusPill, statusClass(task.status))}\r\n                                        onClick={() => cycleStatus(task)}\r\n                                        title=\"Click to change status\"\r\n                                    >\r\n                                        {task.status}\r\n                                        <ChevronRight className={styles.chevron} />\r\n                                    </span>\r\n                                </td>\r\n                                <td>\r\n                                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.375rem', minWidth: '80px' }}>\r\n                                        <div style={{\r\n                                            flex: 1,\r\n                                            height: '6px',\r\n                                            background: 'rgba(122,139,181,0.12)',\r\n                                            borderRadius: '3px',\r\n                                            overflow: 'hidden',\r\n                                        }}>\r\n                                            <div style={{\r\n                                                width: `${task.progress}%`,\r\n                                                height: '100%',\r\n                                                background: progressColor(task.progress),\r\n                                                borderRadius: '3px',\r\n                                                transition: 'width 0.3s',\r\n                                            }} />\r\n                                        </div>\r\n                                        <span style={{\r\n                                            fontSize: '0.6875rem',\r\n                                            color: progressColor(task.progress),\r\n                                            fontWeight: 600,\r\n                                            minWidth: '28px',\r\n                                            textAlign: 'right',\r\n                                        }}>{task.progress}%</span>\r\n                                    </div>\r\n                                </td>\r\n                                <td>\r\n                                    <span className={cn(styles.priority, priorityClass(task.priority))}>\r\n                                        {task.priority}\r\n                                    </span>\r\n                                </td>\r\n                                <td><span className={styles.dateText}>{task.startDate}</span></td>\r\n                                <td><span className={styles.dateText}>{task.dueDate}</span></td>\r\n                                <td>\r\n                                    {depTask ? (\r\n                                        <div style={{ fontSize: '0.7rem', display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n                                            <span style={{ background: 'var(--secondary)', padding: '0.1rem 0.3rem', borderRadius: '4px', maxWidth: '80px', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }} title={depTask.title}>\r\n                                                {depTask.title}\r\n                                            </span>\r\n                                            <span style={{ color: 'var(--foreground-muted)' }}>‚Üí</span>\r\n                                        </div>\r\n                                    ) : <span style={{ color: 'var(--foreground-muted)' }}>-</span>}\r\n                                </td>\r\n                                <td>\r\n                                    <div className={styles.actions}>\r\n                                        <button className={styles.actionBtn} onClick={() => onEditTask(task)} title=\"Edit\">\r\n                                            <Pencil size={14} />\r\n                                        </button>\r\n                                        <button className={cn(styles.actionBtn, styles.delete)} onClick={() => deleteTask(task.id)} title=\"Delete\">\r\n                                            <Trash2 size={14} />\r\n                                        </button>\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                        );\r\n                    })}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\schedule\\MilestonesView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\schedule\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":8,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":24,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"cn"},"fix":{"range":[315,319],"text":""},"desc":"Remove unused variable \"cn\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Milestone' is defined but never used.","line":9,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Milestone"},"fix":{"range":[356,367],"text":""},"desc":"Remove unused variable \"Milestone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'updateMilestone' is assigned a value but never used.","line":18,"column":94,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":109},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'deleteMilestone' is assigned a value but never used.","line":18,"column":111,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":126},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'legacyMilestoneTasks' is assigned a value but never used.","line":29,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Modal } from '@/app/components/ui/Modal';\r\nimport { Plus, Download, List, BarChart3, Target, Filter } from 'lucide-react';\r\nimport { generateId, cn } from '@/lib/utils';\r\nimport { Task, Milestone, MilestoneStatus } from '@/types';\r\nimport ListView from './ListView';\r\nimport GanttView from './GanttView';\r\nimport MilestonesView from './MilestonesView';\r\nimport styles from './page.module.css';\r\n\r\ntype ViewMode = 'list' | 'gantt' | 'milestones';\r\n\r\nexport default function SchedulePage() {\r\n    const { tasks, addTask, updateTask, addActivity, members, milestones = [], addMilestone, updateMilestone, deleteMilestone } = useProject();\r\n    const [view, setView] = useState<ViewMode>('list');\r\n    const [isAddOpen, setIsAddOpen] = useState(false);\r\n    const [editTask, setEditTask] = useState<Task | null>(null);\r\n\r\n    // Filters for list view\r\n    const [filterOverdue, setFilterOverdue] = useState(false);\r\n    const [filterThisWeek, setFilterThisWeek] = useState(false);\r\n    const [filterBlocked, setFilterBlocked] = useState(false);\r\n\r\n    const parentTasks = tasks.filter(t => !t.parentId);\r\n    const legacyMilestoneTasks = tasks.filter(t => t.isMilestone); // Keep for backwards compatibility\r\n\r\n    const defaultNewTask = {\r\n        title: '',\r\n        startDate: '',\r\n        dueDate: '',\r\n        priority: 'P2' as Task['priority'],\r\n        description: '',\r\n        parentId: '',\r\n        dependencies: '',\r\n        isMilestone: false,\r\n        workstream: '',\r\n        relatedMilestoneId: '',\r\n        ownerId: '',\r\n    };\r\n    const [newTask, setNewTask] = useState(defaultNewTask);\r\n\r\n    const [isMilestoneAddOpen, setIsMilestoneAddOpen] = useState(false);\r\n    const [newMilestone, setNewMilestone] = useState({ title: '', description: '', date: '', status: 'Pending' as MilestoneStatus, ownerId: '' });\r\n\r\n    const handleAdd = () => {\r\n        if (!newTask.title || !newTask.startDate || !newTask.dueDate) return;\r\n        const task: Task = {\r\n            id: generateId('t'),\r\n            title: newTask.title,\r\n            startDate: newTask.startDate,\r\n            dueDate: newTask.dueDate,\r\n            status: 'Not Started',\r\n            priority: newTask.priority,\r\n            progress: 0,\r\n            dependencies: newTask.dependencies ? newTask.dependencies.split(',').map(s => s.trim()).filter(Boolean) : [],\r\n            tags: [],\r\n            description: newTask.description,\r\n            parentId: newTask.parentId || undefined,\r\n            isMilestone: newTask.isMilestone,\r\n            workstream: newTask.workstream || undefined,\r\n            relatedMilestoneId: newTask.relatedMilestoneId || undefined,\r\n            ownerId: newTask.ownerId || undefined,\r\n        };\r\n        addTask(task);\r\n        if (newTask.isMilestone) {\r\n            addActivity({ id: generateId('act'), timestamp: new Date().toISOString(), action: 'Milestone created', detail: `\"${newTask.title}\"`, category: 'milestone' });\r\n        }\r\n        setNewTask(defaultNewTask);\r\n        setIsAddOpen(false);\r\n    };\r\n\r\n    const handleEditSave = () => {\r\n        if (!editTask) return;\r\n        updateTask(editTask.id, {\r\n            title: editTask.title,\r\n            startDate: editTask.startDate,\r\n            dueDate: editTask.dueDate,\r\n            priority: editTask.priority,\r\n            progress: editTask.progress,\r\n            dependencies: editTask.dependencies,\r\n            description: editTask.description,\r\n            parentId: editTask.parentId || undefined,\r\n            isMilestone: editTask.isMilestone,\r\n            workstream: editTask.workstream || undefined,\r\n            relatedMilestoneId: editTask.relatedMilestoneId || undefined,\r\n            ownerId: editTask.ownerId || undefined,\r\n        });\r\n        // Cascade: if due date changed, shift dependent tasks\r\n        const originalTask = tasks.find(t => t.id === editTask.id);\r\n        if (originalTask && originalTask.dueDate !== editTask.dueDate) {\r\n            const diffDays = Math.round((new Date(editTask.dueDate).getTime() - new Date(originalTask.dueDate).getTime()) / (86400000));\r\n            if (diffDays !== 0) {\r\n                tasks.forEach(t => {\r\n                    if (t.dependencies?.includes(editTask.id)) {\r\n                        const newStart = new Date(new Date(t.startDate).getTime() + diffDays * 86400000).toISOString().split('T')[0];\r\n                        const newDue = new Date(new Date(t.dueDate).getTime() + diffDays * 86400000).toISOString().split('T')[0];\r\n                        updateTask(t.id, { startDate: newStart, dueDate: newDue });\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        setEditTask(null);\r\n    };\r\n\r\n    const exportCSV = () => {\r\n        const header = 'Title,Status,Priority,Start,Due,Progress,Milestone\\n';\r\n        const rows = tasks.map(t =>\r\n            `\"${t.title}\",${t.status},${t.priority},${t.startDate},${t.dueDate},${t.progress}%,${t.isMilestone ? 'Yes' : 'No'}`\r\n        ).join('\\n');\r\n        const blob = new Blob([header + rows], { type: 'text/csv' });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = 'tasks.csv';\r\n        a.click();\r\n        URL.revokeObjectURL(url);\r\n    };\r\n\r\n    const handleAddMilestone = () => {\r\n        if (!newMilestone.title || !newMilestone.date) return;\r\n        addMilestone({\r\n            id: generateId('ms'),\r\n            title: newMilestone.title,\r\n            description: newMilestone.description,\r\n            date: newMilestone.date,\r\n            status: newMilestone.status,\r\n            ownerId: newMilestone.ownerId,\r\n            createdAt: new Date().toISOString(),\r\n            updatedAt: new Date().toISOString()\r\n        });\r\n        setNewMilestone({ title: '', description: '', date: '', status: 'Pending', ownerId: '' });\r\n        setIsMilestoneAddOpen(false);\r\n    };\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <header className={styles.header}>\r\n                <div className={styles.headerLeft}>\r\n                    <h1 className={styles.title}>Schedule</h1>\r\n                    <p className={styles.subtitle}>{tasks.length} tasks ¬∑ {milestones.length} milestones</p>\r\n                </div>\r\n                <div className={styles.controls}>\r\n                    <div className={styles.viewToggle}>\r\n                        <button className={view === 'list' ? 'active' : ''} onClick={() => setView('list')}>\r\n                            <List size={14} /> List\r\n                        </button>\r\n                        <button className={view === 'gantt' ? 'active' : ''} onClick={() => setView('gantt')}>\r\n                            <BarChart3 size={14} /> Gantt\r\n                        </button>\r\n                        <button className={view === 'milestones' ? 'active' : ''} onClick={() => setView('milestones')}>\r\n                            <Target size={14} /> Milestones\r\n                        </button>\r\n                    </div>\r\n                    <Button variant=\"ghost\" size=\"sm\" onClick={exportCSV}>\r\n                        <Download size={14} /> CSV\r\n                    </Button>\r\n                    <Button size=\"sm\" onClick={() => {\r\n                        if (view === 'milestones') setIsMilestoneAddOpen(true);\r\n                        else setIsAddOpen(true);\r\n                    }}>\r\n                        <Plus size={14} /> {view === 'milestones' ? 'Add Milestone' : 'Add Task'}\r\n                    </Button>\r\n                </div>\r\n            </header>\r\n\r\n            {view === 'list' && (\r\n                <div className={styles.filterBar} style={{ marginBottom: '1rem', display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>\r\n                    <Button variant={filterOverdue ? 'default' : 'outline'} size=\"sm\" onClick={() => setFilterOverdue(!filterOverdue)}>\r\n                        <Filter size={12} style={{ marginRight: 4 }} /> Overdue\r\n                    </Button>\r\n                    <Button variant={filterThisWeek ? 'default' : 'outline'} size=\"sm\" onClick={() => setFilterThisWeek(!filterThisWeek)}>\r\n                        <Filter size={12} style={{ marginRight: 4 }} /> This Week\r\n                    </Button>\r\n                    <Button variant={filterBlocked ? 'default' : 'outline'} size=\"sm\" onClick={() => setFilterBlocked(!filterBlocked)}>\r\n                        <Filter size={12} style={{ marginRight: 4 }} /> Blocked\r\n                    </Button>\r\n                </div>\r\n            )}\r\n\r\n            {view === 'list' && <ListView onEditTask={(task) => setEditTask(task)} filters={{ overdue: filterOverdue, thisWeek: filterThisWeek, blocked: filterBlocked }} />}\r\n            {view === 'gantt' && <GanttView />}\r\n            {view === 'milestones' && <MilestonesView />}\r\n\r\n            {/* Add Task Modal */}\r\n            <Modal isOpen={isAddOpen} onClose={() => setIsAddOpen(false)} title=\"Add New Task\">\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Task Name *</label>\r\n                        <input className={styles.input} value={newTask.title} onChange={e => setNewTask({ ...newTask, title: e.target.value })} placeholder=\"Enter task name\" />\r\n                    </div>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Description</label>\r\n                        <textarea className={styles.textarea} value={newTask.description} onChange={e => setNewTask({ ...newTask, description: e.target.value })} placeholder=\"Optional description\" />\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Start Date *</label>\r\n                            <input className={styles.input} type=\"date\" value={newTask.startDate} onChange={e => setNewTask({ ...newTask, startDate: e.target.value })} />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Due Date *</label>\r\n                            <input className={styles.input} type=\"date\" value={newTask.dueDate} onChange={e => setNewTask({ ...newTask, dueDate: e.target.value })} />\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Priority</label>\r\n                            <select className={styles.select} value={newTask.priority} onChange={e => setNewTask({ ...newTask, priority: e.target.value as Task['priority'] })}>\r\n                                <option value=\"P0\">P0 ‚Äî Critical</option>\r\n                                <option value=\"P1\">P1 ‚Äî High</option>\r\n                                <option value=\"P2\">P2 ‚Äî Medium</option>\r\n                                <option value=\"P3\">P3 ‚Äî Low</option>\r\n                            </select>\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Owner</label>\r\n                            <select className={styles.select} value={newTask.ownerId} onChange={e => setNewTask({ ...newTask, ownerId: e.target.value })}>\r\n                                <option value=\"\">‚Äî Unassigned ‚Äî</option>\r\n                                {members.map(m => <option key={m.id} value={m.id}>{m.name}</option>)}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Workstream</label>\r\n                            <input className={styles.input} value={newTask.workstream} onChange={e => setNewTask({ ...newTask, workstream: e.target.value })} placeholder=\"e.g. Design, Backend\" />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Related Milestone</label>\r\n                            <select className={styles.select} value={newTask.relatedMilestoneId} onChange={e => setNewTask({ ...newTask, relatedMilestoneId: e.target.value })}>\r\n                                <option value=\"\">‚Äî None ‚Äî</option>\r\n                                {milestones.map(m => (\r\n                                    <option key={m.id} value={m.id}>{m.title}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Parent Task (Sub-task)</label>\r\n                            <select className={styles.select} value={newTask.parentId} onChange={e => setNewTask({ ...newTask, parentId: e.target.value })}>\r\n                                <option value=\"\">‚Äî None (Top-level) ‚Äî</option>\r\n                                {parentTasks.map(t => (\r\n                                    <option key={t.id} value={t.id}>{t.title}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Dependencies (must finish first)</label>\r\n                            <select className={styles.select} value={newTask.dependencies || ''} onChange={e => setNewTask({ ...newTask, dependencies: e.target.value })}>\r\n                                <option value=\"\">‚Äî None ‚Äî</option>\r\n                                {tasks.map(t => (\r\n                                    <option key={t.id} value={t.id}>{t.title}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formGroup}>\r\n                        <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n                            <input\r\n                                type=\"checkbox\"\r\n                                checked={newTask.isMilestone}\r\n                                onChange={e => setNewTask({ ...newTask, isMilestone: e.target.checked })}\r\n                                style={{ accentColor: 'var(--primary)', width: '16px', height: '16px' }}\r\n                            />\r\n                            <span>üèÅ Mark as internal Task Milestone flag (Legacy)</span>\r\n                        </label>\r\n                    </div>\r\n                    <div className={styles.formActions}>\r\n                        <Button variant=\"ghost\" onClick={() => setIsAddOpen(false)}>Cancel</Button>\r\n                        <Button onClick={handleAdd}>Create Task</Button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* Edit Task Modal */}\r\n            <Modal isOpen={!!editTask} onClose={() => setEditTask(null)} title=\"Edit Task\">\r\n                {editTask && (\r\n                    <div className={styles.form}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Task Name</label>\r\n                            <input className={styles.input} value={editTask.title} onChange={e => setEditTask({ ...editTask, title: e.target.value })} />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Description</label>\r\n                            <textarea className={styles.textarea} value={editTask.description || ''} onChange={e => setEditTask({ ...editTask, description: e.target.value })} />\r\n                        </div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Start Date</label>\r\n                                <input className={styles.input} type=\"date\" value={editTask.startDate} onChange={e => setEditTask({ ...editTask, startDate: e.target.value })} />\r\n                            </div>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Due Date</label>\r\n                                <input className={styles.input} type=\"date\" value={editTask.dueDate} onChange={e => setEditTask({ ...editTask, dueDate: e.target.value })} />\r\n                            </div>\r\n                        </div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Priority</label>\r\n                                <select className={styles.select} value={editTask.priority} onChange={e => setEditTask({ ...editTask, priority: e.target.value as Task['priority'] })}>\r\n                                    <option value=\"P0\">P0 ‚Äî Critical</option>\r\n                                    <option value=\"P1\">P1 ‚Äî High</option>\r\n                                    <option value=\"P2\">P2 ‚Äî Medium</option>\r\n                                    <option value=\"P3\">P3 ‚Äî Low</option>\r\n                                </select>\r\n                            </div>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Owner</label>\r\n                                <select className={styles.select} value={editTask.ownerId || ''} onChange={e => setEditTask({ ...editTask, ownerId: e.target.value })}>\r\n                                    <option value=\"\">‚Äî Unassigned ‚Äî</option>\r\n                                    {members.map(m => <option key={m.id} value={m.id}>{m.name}</option>)}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Workstream</label>\r\n                                <input className={styles.input} value={editTask.workstream || ''} onChange={e => setEditTask({ ...editTask, workstream: e.target.value })} placeholder=\"e.g. Design, Backend\" />\r\n                            </div>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Related Milestone</label>\r\n                                <select className={styles.select} value={editTask.relatedMilestoneId || ''} onChange={e => setEditTask({ ...editTask, relatedMilestoneId: e.target.value })}>\r\n                                    <option value=\"\">‚Äî None ‚Äî</option>\r\n                                    {milestones.map(m => (\r\n                                        <option key={m.id} value={m.id}>{m.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <div className={styles.formRow}>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Parent Task</label>\r\n                                <select className={styles.select} value={editTask.parentId || ''} onChange={e => setEditTask({ ...editTask, parentId: e.target.value || undefined })}>\r\n                                    <option value=\"\">‚Äî None ‚Äî</option>\r\n                                    {parentTasks.filter(t => t.id !== editTask.id).map(t => (\r\n                                        <option key={t.id} value={t.id}>{t.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Dependencies (must finish first)</label>\r\n                                <select className={styles.select} value={editTask.dependencies?.[0] || ''} onChange={e => setEditTask({ ...editTask, dependencies: e.target.value ? [e.target.value] : [] })}>\r\n                                    <option value=\"\">‚Äî None ‚Äî</option>\r\n                                    {tasks.filter(t => t.id !== editTask.id).map(t => (\r\n                                        <option key={t.id} value={t.id}>{t.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Progress: {editTask.progress}%</label>\r\n                            <input type=\"range\" min=\"0\" max=\"100\" step=\"5\" value={editTask.progress} onChange={e => setEditTask({ ...editTask, progress: parseInt(e.target.value) })} style={{ width: '100%', accentColor: 'var(--primary)' }} />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    checked={editTask.isMilestone || false}\r\n                                    onChange={e => setEditTask({ ...editTask, isMilestone: e.target.checked })}\r\n                                    style={{ accentColor: 'var(--primary)', width: '16px', height: '16px' }}\r\n                                />\r\n                                <span>üèÅ Mark as internal Task Milestone flag (Legacy)</span>\r\n                            </label>\r\n                        </div>\r\n                        <div className={styles.formActions}>\r\n                            <Button variant=\"ghost\" onClick={() => setEditTask(null)}>Cancel</Button>\r\n                            <Button onClick={handleEditSave}>Save Changes</Button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n\r\n            {/* Add Milestone Modal */}\r\n            <Modal isOpen={isMilestoneAddOpen} onClose={() => setIsMilestoneAddOpen(false)} title=\"Add Milestone\">\r\n                <div className={styles.form}>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Milestone Title *</label>\r\n                            <input className={styles.input} value={newMilestone.title} onChange={e => setNewMilestone({ ...newMilestone, title: e.target.value })} placeholder=\"e.g. Design Freeze\" autoFocus />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Target Date *</label>\r\n                            <input type=\"date\" className={styles.input} value={newMilestone.date} onChange={e => setNewMilestone({ ...newMilestone, date: e.target.value })} />\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Description</label>\r\n                        <textarea className={styles.textarea} value={newMilestone.description} onChange={e => setNewMilestone({ ...newMilestone, description: e.target.value })} rows={2} />\r\n                    </div>\r\n                    <div className={styles.formActions}>\r\n                        <Button variant=\"ghost\" onClick={() => setIsMilestoneAddOpen(false)}>Cancel</Button>\r\n                        <Button onClick={handleAddMilestone}>Create Milestone</Button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\team\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isEdit' is assigned a value but never used.","line":110,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":110,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Card } from '@/app/components/ui/Card';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Modal } from '@/app/components/ui/Modal';\r\nimport { Plus, Mail, Pencil, Trash2 } from 'lucide-react';\r\nimport { generateId } from '@/lib/utils';\r\nimport { Member } from '@/types';\r\nimport styles from './page.module.css';\r\nimport { cn } from '@/lib/utils';\r\n\r\nconst ROLES = ['Project Manager', 'Lead Developer', 'Backend Engineer', 'Frontend Engineer', 'UI/UX Designer', 'QA Engineer', 'DevOps Engineer', 'Data Engineer', 'Business Analyst'];\r\nconst TEAMS = ['PMO', 'Engineering', 'Design', 'QA', 'Infrastructure', 'Data', 'Management'];\r\n\r\nconst COUNTRIES: { name: string; tz: string; offset: string }[] = [\r\n    { name: 'South Korea', tz: 'Asia/Seoul', offset: 'UTC+9' },\r\n    { name: 'Japan', tz: 'Asia/Tokyo', offset: 'UTC+9' },\r\n    { name: 'China', tz: 'Asia/Shanghai', offset: 'UTC+8' },\r\n    { name: 'Singapore', tz: 'Asia/Singapore', offset: 'UTC+8' },\r\n    { name: 'India', tz: 'Asia/Kolkata', offset: 'UTC+5:30' },\r\n    { name: 'UAE', tz: 'Asia/Dubai', offset: 'UTC+4' },\r\n    { name: 'Saudi Arabia', tz: 'Asia/Riyadh', offset: 'UTC+3' },\r\n    { name: 'Germany', tz: 'Europe/Berlin', offset: 'UTC+1' },\r\n    { name: 'UK', tz: 'Europe/London', offset: 'UTC+0' },\r\n    { name: 'France', tz: 'Europe/Paris', offset: 'UTC+1' },\r\n    { name: 'Netherlands', tz: 'Europe/Amsterdam', offset: 'UTC+1' },\r\n    { name: 'Italy', tz: 'Europe/Rome', offset: 'UTC+1' },\r\n    { name: 'US (East)', tz: 'America/New_York', offset: 'UTC-5' },\r\n    { name: 'US (Pacific)', tz: 'America/Los_Angeles', offset: 'UTC-8' },\r\n    { name: 'Australia', tz: 'Australia/Sydney', offset: 'UTC+11' },\r\n    { name: 'Brazil', tz: 'America/Sao_Paulo', offset: 'UTC-3' },\r\n    { name: 'Canada', tz: 'America/Toronto', offset: 'UTC-5' },\r\n    { name: 'Mexico', tz: 'America/Mexico_City', offset: 'UTC-6' },\r\n];\r\n\r\nconst getLocalTime = (tz: string) => {\r\n    try {\r\n        return new Date().toLocaleTimeString('en-US', { timeZone: tz, hour: '2-digit', minute: '2-digit', hour12: true });\r\n    } catch {\r\n        return '';\r\n    }\r\n};\r\n\r\nexport default function TeamPage() {\r\n    const { members, addMember, updateMember, deleteMember } = useProject();\r\n    const [isAddOpen, setIsAddOpen] = useState(false);\r\n    const [editMember, setEditMember] = useState<Member | null>(null);\r\n\r\n    const defaultNew = {\r\n        name: '',\r\n        role: ROLES[0],\r\n        email: '',\r\n        team: TEAMS[0],\r\n        country: 'South Korea',\r\n    };\r\n    const [newMember, setNewMember] = useState(defaultNew);\r\n\r\n    const getCountryInfo = (countryName: string) => COUNTRIES.find(c => c.name === countryName) || COUNTRIES[0];\r\n\r\n    const handleAdd = () => {\r\n        if (!newMember.name || !newMember.email) return;\r\n        let tz: string;\r\n        if (newMember.country === 'Other') {\r\n            tz = (newMember as typeof newMember & { timezone?: string }).timezone || 'UTC';\r\n        } else {\r\n            const ci = getCountryInfo(newMember.country);\r\n            tz = `${ci.name} (${ci.offset})`;\r\n        }\r\n        addMember({\r\n            id: generateId('m'),\r\n            name: newMember.name,\r\n            role: newMember.role,\r\n            email: newMember.email,\r\n            team: newMember.team,\r\n            timezone: tz,\r\n            status: 'online',\r\n        });\r\n        setNewMember(defaultNew);\r\n        setIsAddOpen(false);\r\n    };\r\n\r\n    const handleEditSave = () => {\r\n        if (!editMember) return;\r\n        updateMember(editMember.id, {\r\n            name: editMember.name,\r\n            role: editMember.role,\r\n            email: editMember.email,\r\n            team: editMember.team,\r\n            timezone: editMember.timezone,\r\n        });\r\n        setEditMember(null);\r\n    };\r\n\r\n    const getInitials = (name: string) => name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);\r\n\r\n    // Extract country from timezone string like \"South Korea (UTC+9)\"\r\n    const extractCountry = (tz: string) => {\r\n        const match = tz.match(/^(.+?)\\s*\\(/);\r\n        return match ? match[1] : 'South Korea';\r\n    };\r\n\r\n    const renderForm = (\r\n        data: { name: string; role: string; email: string; team: string; country: string; timezone?: string },\r\n        onChange: (d: { name: string; role: string; email: string; team: string; country: string; timezone?: string }) => void,\r\n        onSave: () => void,\r\n        onCancel: () => void,\r\n        saveLabel: string,\r\n        isEdit = false,\r\n    ) => {\r\n        const selectedCountry = data.country || 'South Korea';\r\n        const countryInfo = getCountryInfo(selectedCountry);\r\n        const localTime = getLocalTime(countryInfo.tz);\r\n\r\n        return (\r\n            <div className={styles.form}>\r\n                <div className={styles.formGroup}>\r\n                    <label>Name *</label>\r\n                    <input className={styles.input} value={data.name} onChange={e => onChange({ ...data, name: e.target.value })} placeholder=\"Full name\" />\r\n                </div>\r\n                <div className={styles.formGroup}>\r\n                    <label>Email *</label>\r\n                    <input className={styles.input} type=\"email\" value={data.email} onChange={e => onChange({ ...data, email: e.target.value })} placeholder=\"email@company.com\" />\r\n                </div>\r\n                <div className={styles.formRow}>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Role</label>\r\n                        <select className={styles.select} value={data.role} onChange={e => onChange({ ...data, role: e.target.value })}>\r\n                            {ROLES.map(r => <option key={r} value={r}>{r}</option>)}\r\n                        </select>\r\n                    </div>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Team</label>\r\n                        <select className={styles.select} value={data.team} onChange={e => onChange({ ...data, team: e.target.value })}>\r\n                            {TEAMS.map(t => <option key={t} value={t}>{t}</option>)}\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                <div className={styles.formGroup}>\r\n                    <label>Country / Timezone</label>\r\n                    <select className={styles.select} value={selectedCountry} onChange={e => onChange({ ...data, country: e.target.value })}>\r\n                        {COUNTRIES.map(c => <option key={c.name} value={c.name}>{c.name} ({c.offset})</option>)}\r\n                        <option value=\"Other\">Other (manual input)</option>\r\n                    </select>\r\n                    {selectedCountry === 'Other' ? (\r\n                        <input className={styles.input} value={data.timezone || ''} onChange={e => onChange({ ...data, timezone: e.target.value })} placeholder=\"e.g. UTC+5:30 or Asia/Kolkata\" style={{ marginTop: '0.375rem' }} />\r\n                    ) : localTime ? (\r\n                        <span style={{ fontSize: '0.75rem', color: 'var(--foreground-muted)', marginTop: '0.25rem' }}>\r\n                            üïê Current local time: {localTime}\r\n                        </span>\r\n                    ) : null}\r\n                </div>\r\n                <div className={styles.formActions}>\r\n                    <Button variant=\"ghost\" onClick={onCancel}>Cancel</Button>\r\n                    <Button onClick={onSave}>{saveLabel}</Button>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <header className={styles.header}>\r\n                <div className={styles.headerLeft}>\r\n                    <h1 className={styles.title}>Team Directory</h1>\r\n                    <p className={styles.subtitle}>{members.length} members</p>\r\n                </div>\r\n                <Button size=\"sm\" onClick={() => setIsAddOpen(true)}>\r\n                    <Plus size={14} /> Add Member\r\n                </Button>\r\n            </header>\r\n\r\n            {members.length === 0 ? (\r\n                <Card>\r\n                    <div className={styles.emptyState}>No team members yet. Click &quot;Add Member&quot; to register your team.</div>\r\n                </Card>\r\n            ) : (\r\n                <div className={styles.grid}>\r\n                    {members.map((member, i) => {\r\n                        const country = extractCountry(member.timezone);\r\n                        const ci = getCountryInfo(country);\r\n                        const localTime = getLocalTime(ci.tz);\r\n                        return (\r\n                            <Card key={member.id} className={styles.memberCard} style={{ animationDelay: `${i * 0.05}s` }}>\r\n                                <div className={styles.cardHeader}>\r\n                                    <div className={styles.avatarWrapper}>\r\n                                        <div className={styles.avatar}>{getInitials(member.name)}</div>\r\n                                        <div className={cn(\r\n                                            styles.statusDot,\r\n                                            member.status === 'online' && styles.online,\r\n                                            member.status === 'away' && styles.away,\r\n                                            member.status === 'offline' && styles.offline,\r\n                                        )} />\r\n                                    </div>\r\n                                    <div className={styles.cardActions}>\r\n                                        <button className={styles.actionBtn} onClick={() => setEditMember({ ...member, timezone: member.timezone })} title=\"Edit\">\r\n                                            <Pencil size={13} />\r\n                                        </button>\r\n                                        <button className={cn(styles.actionBtn, styles.deleteBtn)} onClick={() => deleteMember(member.id)} title=\"Delete\">\r\n                                            <Trash2 size={13} />\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                                <h3 className={styles.name}>{member.name}</h3>\r\n                                <p className={styles.role}>{member.role}</p>\r\n                                <div className={styles.info}>\r\n                                    <span className={styles.teamBadge}>{member.team}</span>\r\n                                    <span className={styles.tz}>{member.timezone}</span>\r\n                                </div>\r\n                                {localTime && (\r\n                                    <div style={{ fontSize: '0.6875rem', color: 'var(--foreground-muted)', marginTop: '0.25rem' }}>\r\n                                        üïê {localTime}\r\n                                    </div>\r\n                                )}\r\n                                <a className={styles.emailBtn} href={`mailto:${member.email}`}>\r\n                                    <Mail size={14} /> {member.email}\r\n                                </a>\r\n                            </Card>\r\n                        );\r\n                    })}\r\n                </div>\r\n            )}\r\n\r\n            {/* Add Modal */}\r\n            <Modal isOpen={isAddOpen} onClose={() => setIsAddOpen(false)} title=\"Add Team Member\">\r\n                {renderForm(newMember, setNewMember, handleAdd, () => setIsAddOpen(false), 'Add Member')}\r\n            </Modal>\r\n\r\n            {/* Edit Modal */}\r\n            <Modal isOpen={!!editMember} onClose={() => setEditMember(null)} title=\"Edit Team Member\">\r\n                {editMember && renderForm(\r\n                    { ...editMember, country: extractCountry(editMember.timezone) },\r\n                    (d) => {\r\n                        const ci = getCountryInfo(d.country || 'South Korea');\r\n                        setEditMember({ ...editMember, ...d, timezone: `${ci.name} (${ci.offset})` });\r\n                    },\r\n                    handleEditSave,\r\n                    () => setEditMember(null),\r\n                    'Save Changes',\r\n                    true\r\n                )}\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\app\\vendors\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used.","line":9,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":49,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ExternalLink"},"fix":{"range":[351,365],"text":""},"desc":"Remove unused variable \"ExternalLink\"."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":154,"column":62,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6264,6375],"text":"\r\n                            No vendors registered yet. Click &quot;Add Vendor\" to start.\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6264,6375],"text":"\r\n                            No vendors registered yet. Click &ldquo;Add Vendor\" to start.\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6264,6375],"text":"\r\n                            No vendors registered yet. Click &#34;Add Vendor\" to start.\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6264,6375],"text":"\r\n                            No vendors registered yet. Click &rdquo;Add Vendor\" to start.\r\n                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":154,"column":73,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6264,6375],"text":"\r\n                            No vendors registered yet. Click \"Add Vendor&quot; to start.\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6264,6375],"text":"\r\n                            No vendors registered yet. Click \"Add Vendor&ldquo; to start.\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6264,6375],"text":"\r\n                            No vendors registered yet. Click \"Add Vendor&#34; to start.\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6264,6375],"text":"\r\n                            No vendors registered yet. Click \"Add Vendor&rdquo; to start.\r\n                        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { useProject } from '@/hooks/useProject';\r\nimport { Card } from '@/app/components/ui/Card';\r\nimport { Button } from '@/app/components/ui/Button';\r\nimport { Modal } from '@/app/components/ui/Modal';\r\nimport { Badge } from '@/app/components/ui/Badge';\r\nimport { Briefcase, FileText, Plus, ExternalLink, Calendar as CalendarIcon, Edit2, Trash2, Mail, Phone, DollarSign } from 'lucide-react';\r\nimport styles from './page.module.css';\r\nimport { cn, generateId } from '@/lib/utils';\r\nimport { Vendor, Procurement, VendorStatus, ProcurementStatus } from '@/types';\r\n\r\ntype TabView = 'vendors' | 'procurement';\r\n\r\nexport default function VendorsPage() {\r\n    const {\r\n        vendors = [],\r\n        procurements = [],\r\n        addVendor,\r\n        updateVendor,\r\n        deleteVendor,\r\n        addProcurement,\r\n        updateProcurement,\r\n        deleteProcurement,\r\n        milestones = []\r\n    } = useProject();\r\n\r\n    const [activeTab, setActiveTab] = useState<TabView>('vendors');\r\n\r\n    // Vendor Modal\r\n    const [isVendorModalOpen, setIsVendorModalOpen] = useState(false);\r\n    const [editVendorId, setEditVendorId] = useState<string | null>(null);\r\n    const [vendorForm, setVendorForm] = useState<Partial<Vendor>>({\r\n        name: '', serviceType: '', contactName: '', contactEmail: '', contactPhone: '', status: 'Active', notes: ''\r\n    });\r\n\r\n    // Procurement Modal\r\n    const [isProcModalOpen, setIsProcModalOpen] = useState(false);\r\n    const [editProcId, setEditProcId] = useState<string | null>(null);\r\n    const [procForm, setProcForm] = useState<Partial<Procurement>>({\r\n        title: '', vendorId: '', contractAmount: 0, description: '', startDate: '', endDate: '', status: 'Planned', relatedMilestoneId: ''\r\n    });\r\n\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    // --- Vendor Handlers ---\r\n    const openVendorModal = (vendor?: Vendor) => {\r\n        if (vendor) {\r\n            setEditVendorId(vendor.id);\r\n            setVendorForm(vendor);\r\n        } else {\r\n            setEditVendorId(null);\r\n            setVendorForm({ name: '', serviceType: '', contactName: '', contactEmail: '', contactPhone: '', status: 'Active', notes: '' });\r\n        }\r\n        setIsVendorModalOpen(true);\r\n    };\r\n\r\n    const handleSaveVendor = () => {\r\n        if (!vendorForm.name || !vendorForm.serviceType) return;\r\n        if (editVendorId) {\r\n            updateVendor(editVendorId, { ...vendorForm, updatedAt: today });\r\n        } else {\r\n            addVendor({\r\n                id: generateId('ven'),\r\n                name: vendorForm.name,\r\n                serviceType: vendorForm.serviceType,\r\n                contactName: vendorForm.contactName,\r\n                contactEmail: vendorForm.contactEmail,\r\n                contactPhone: vendorForm.contactPhone,\r\n                status: vendorForm.status as VendorStatus || 'Active',\r\n                notes: vendorForm.notes,\r\n                createdAt: today,\r\n                updatedAt: today\r\n            });\r\n        }\r\n        setIsVendorModalOpen(false);\r\n    };\r\n\r\n    // --- Procurement Handlers ---\r\n    const openProcModal = (proc?: Procurement) => {\r\n        if (proc) {\r\n            setEditProcId(proc.id);\r\n            setProcForm(proc);\r\n        } else {\r\n            setEditProcId(null);\r\n            setProcForm({ title: '', vendorId: '', contractAmount: 0, description: '', startDate: '', endDate: '', status: 'Planned', relatedMilestoneId: '' });\r\n        }\r\n        setIsProcModalOpen(true);\r\n    };\r\n\r\n    const handleSaveProcurement = () => {\r\n        if (!procForm.title || !procForm.vendorId) return;\r\n        if (editProcId) {\r\n            updateProcurement(editProcId, { ...procForm, updatedAt: today });\r\n        } else {\r\n            addProcurement({\r\n                id: generateId('proc'),\r\n                title: procForm.title,\r\n                vendorId: procForm.vendorId,\r\n                contractAmount: Number(procForm.contractAmount) || 0,\r\n                description: procForm.description,\r\n                startDate: procForm.startDate,\r\n                endDate: procForm.endDate,\r\n                status: procForm.status as ProcurementStatus || 'Planned',\r\n                relatedMilestoneId: procForm.relatedMilestoneId,\r\n                createdAt: today,\r\n                updatedAt: today\r\n            });\r\n        }\r\n        setIsProcModalOpen(false);\r\n    };\r\n\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <header className={styles.header}>\r\n                <div>\r\n                    <h1 className={styles.title}>Vendors & Procurement</h1>\r\n                    <p className={styles.subtitle}>Manage external vendors and related contracts</p>\r\n                </div>\r\n                <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                    <Button onClick={() => openVendorModal()}>\r\n                        <Plus size={16} /> Add Vendor\r\n                    </Button>\r\n                    <Button variant=\"outline\" onClick={() => openProcModal()}>\r\n                        <Plus size={16} /> New Contract\r\n                    </Button>\r\n                </div>\r\n            </header>\r\n\r\n            <div className={styles.tabs}>\r\n                <button\r\n                    className={cn(styles.tabBtn, activeTab === 'vendors' && styles.tabActive)}\r\n                    onClick={() => setActiveTab('vendors')}\r\n                >\r\n                    <Briefcase size={14} style={{ display: 'inline', marginRight: '6px' }} />\r\n                    Vendors ({vendors.length})\r\n                </button>\r\n                <button\r\n                    className={cn(styles.tabBtn, activeTab === 'procurement' && styles.tabActive)}\r\n                    onClick={() => setActiveTab('procurement')}\r\n                >\r\n                    <FileText size={14} style={{ display: 'inline', marginRight: '6px' }} />\r\n                    Procurements ({procurements.length})\r\n                </button>\r\n            </div>\r\n\r\n            {/* Vendors View */}\r\n            {activeTab === 'vendors' && (\r\n                <div className={styles.list}>\r\n                    {vendors.length === 0 ? (\r\n                        <div className={styles.emptyState}>\r\n                            No vendors registered yet. Click \"Add Vendor\" to start.\r\n                        </div>\r\n                    ) : (\r\n                        vendors.map(v => (\r\n                            <Card key={v.id} className={styles.card}>\r\n                                <div className={styles.cardHeader}>\r\n                                    <div>\r\n                                        <h3 className={styles.cardTitle}>\r\n                                            {v.name}\r\n                                            <span style={{ marginLeft: '0.5rem' }}>\r\n                                                <Badge variant={v.status === 'Active' ? 'success' : 'neutral'}>{v.status}</Badge>\r\n                                            </span>\r\n                                        </h3>\r\n                                        <div className={styles.cardMeta}>\r\n                                            <span><Briefcase size={14} /> {v.serviceType}</span>\r\n                                            {v.contactEmail && <span><Mail size={14} /> {v.contactEmail}</span>}\r\n                                            {v.contactPhone && <span><Phone size={14} /> {v.contactPhone}</span>}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className={styles.actions}>\r\n                                        <button className={styles.iconBtn} onClick={() => openVendorModal(v)} title=\"Edit Vendor\">\r\n                                            <Edit2 size={16} />\r\n                                        </button>\r\n                                        <button className={cn(styles.iconBtn, styles.deleteBtn)} onClick={() => deleteVendor(v.id)} title=\"Delete Vendor\">\r\n                                            <Trash2 size={16} />\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                                {v.notes && <p style={{ fontSize: '0.875rem', color: 'var(--foreground-muted)', margin: 0, marginTop: '0.5rem' }}>{v.notes}</p>}\r\n                            </Card>\r\n                        ))\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Procurements View */}\r\n            {activeTab === 'procurement' && (\r\n                <div className={styles.list}>\r\n                    {procurements.length === 0 ? (\r\n                        <div className={styles.emptyState}>\r\n                            No procurements or contracts registered.\r\n                        </div>\r\n                    ) : (\r\n                        procurements.map(p => {\r\n                            const relatedVendor = vendors.find(v => v.id === p.vendorId);\r\n                            return (\r\n                                <Card key={p.id} className={styles.card}>\r\n                                    <div className={styles.cardHeader}>\r\n                                        <div>\r\n                                            <h3 className={styles.cardTitle}>\r\n                                                {p.title}\r\n                                                <span style={{ marginLeft: '0.5rem' }}>\r\n                                                    <Badge variant={p.status === 'Awarded' || p.status === 'Closed' ? 'success' : 'neutral'}>{p.status}</Badge>\r\n                                                </span>\r\n                                            </h3>\r\n                                            <div className={styles.cardMeta}>\r\n                                                <span><Briefcase size={14} /> Vendor: {relatedVendor?.name || 'Unknown'}</span>\r\n                                                <span><DollarSign size={14} /> ${p.contractAmount.toLocaleString()}</span>\r\n                                                {(p.startDate || p.endDate) && <span><CalendarIcon size={14} /> {p.startDate || '?'} ~ {p.endDate || '?'}</span>}\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className={styles.actions}>\r\n                                            <button className={styles.iconBtn} onClick={() => openProcModal(p)} title=\"Edit Procurement\">\r\n                                                <Edit2 size={16} />\r\n                                            </button>\r\n                                            <button className={cn(styles.iconBtn, styles.deleteBtn)} onClick={() => deleteProcurement(p.id)} title=\"Delete Procurement\">\r\n                                                <Trash2 size={16} />\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                    {p.description && <p style={{ fontSize: '0.875rem', color: 'var(--foreground-muted)', margin: 0, marginTop: '0.5rem' }}>{p.description}</p>}\r\n                                </Card>\r\n                            )\r\n                        })\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Vendor Modal */}\r\n            <Modal isOpen={isVendorModalOpen} onClose={() => setIsVendorModalOpen(false)} title={editVendorId ? \"Edit Vendor\" : \"Add Vendor\"}>\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Vendor Name *</label>\r\n                        <input className={styles.input} value={vendorForm.name} onChange={e => setVendorForm({ ...vendorForm, name: e.target.value })} placeholder=\"e.g. Acme Corp\" />\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Service Type *</label>\r\n                            <input className={styles.input} value={vendorForm.serviceType} onChange={e => setVendorForm({ ...vendorForm, serviceType: e.target.value })} placeholder=\"e.g. Cloud Hosting\" />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Status</label>\r\n                            <select className={styles.select} value={vendorForm.status} onChange={e => setVendorForm({ ...vendorForm, status: e.target.value as VendorStatus })}>\r\n                                <option value=\"Active\">Active</option>\r\n                                <option value=\"Inactive\">Inactive</option>\r\n                                <option value=\"Pending\">Pending</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Contact Name</label>\r\n                            <input className={styles.input} value={vendorForm.contactName} onChange={e => setVendorForm({ ...vendorForm, contactName: e.target.value })} placeholder=\"Primary contact\" />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Contact Email</label>\r\n                            <input className={styles.input} type=\"email\" value={vendorForm.contactEmail} onChange={e => setVendorForm({ ...vendorForm, contactEmail: e.target.value })} placeholder=\"email@example.com\" />\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Notes</label>\r\n                        <textarea className={styles.textarea} value={vendorForm.notes} onChange={e => setVendorForm({ ...vendorForm, notes: e.target.value })} placeholder=\"Additional information...\" />\r\n                    </div>\r\n                    <div className={styles.formActions}>\r\n                        <Button variant=\"ghost\" onClick={() => setIsVendorModalOpen(false)}>Cancel</Button>\r\n                        <Button onClick={handleSaveVendor}>Save Vendor</Button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* Procurement Modal */}\r\n            <Modal isOpen={isProcModalOpen} onClose={() => setIsProcModalOpen(false)} title={editProcId ? \"Edit Procurement\" : \"New Contract\"}>\r\n                <div className={styles.form}>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Contract Title *</label>\r\n                        <input className={styles.input} value={procForm.title} onChange={e => setProcForm({ ...procForm, title: e.target.value })} placeholder=\"e.g. Server Licensing 2026\" />\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Vendor *</label>\r\n                            <select className={styles.select} value={procForm.vendorId} onChange={e => setProcForm({ ...procForm, vendorId: e.target.value })}>\r\n                                <option value=\"\">‚Äî Select Vendor ‚Äî</option>\r\n                                {vendors.map(v => <option key={v.id} value={v.id}>{v.name}</option>)}\r\n                            </select>\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Contract Amount ($)</label>\r\n                            <input className={styles.input} type=\"number\" value={procForm.contractAmount} onChange={e => setProcForm({ ...procForm, contractAmount: Number(e.target.value) })} placeholder=\"0\" />\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Status</label>\r\n                            <select className={styles.select} value={procForm.status} onChange={e => setProcForm({ ...procForm, status: e.target.value as ProcurementStatus })}>\r\n                                <option value=\"Planned\">Planned</option>\r\n                                <option value=\"In Progress\">In Progress</option>\r\n                                <option value=\"Awarded\">Awarded</option>\r\n                                <option value=\"Closed\">Closed</option>\r\n                                <option value=\"Cancelled\">Cancelled</option>\r\n                            </select>\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Related Milestone</label>\r\n                            <select className={styles.select} value={procForm.relatedMilestoneId} onChange={e => setProcForm({ ...procForm, relatedMilestoneId: e.target.value })}>\r\n                                <option value=\"\">‚Äî None ‚Äî</option>\r\n                                {milestones.map(m => <option key={m.id} value={m.id}>{m.title}</option>)}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formRow}>\r\n                        <div className={styles.formGroup}>\r\n                            <label>Start Date</label>\r\n                            <input className={styles.input} type=\"date\" value={procForm.startDate} onChange={e => setProcForm({ ...procForm, startDate: e.target.value })} />\r\n                        </div>\r\n                        <div className={styles.formGroup}>\r\n                            <label>End Date</label>\r\n                            <input className={styles.input} type=\"date\" value={procForm.endDate} onChange={e => setProcForm({ ...procForm, endDate: e.target.value })} />\r\n                        </div>\r\n                    </div>\r\n                    <div className={styles.formGroup}>\r\n                        <label>Description</label>\r\n                        <textarea className={styles.textarea} value={procForm.description} onChange={e => setProcForm({ ...procForm, description: e.target.value })} placeholder=\"Scope details...\" />\r\n                    </div>\r\n                    <div className={styles.formActions}>\r\n                        <Button variant=\"ghost\" onClick={() => setIsProcModalOpen(false)}>Cancel</Button>\r\n                        <Button onClick={handleSaveProcurement}>Save Contract</Button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\hooks\\useProject.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\hooks\\useSupabaseSync.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\lib\\templates.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\store\\useStore.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Member' is defined but never used.","line":3,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":48,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Member"},"fix":{"range":[140,148],"text":""},"desc":"Remove unused variable \"Member\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DocumentLink' is defined but never used.","line":3,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":62,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"DocumentLink"},"fix":{"range":[148,162],"text":""},"desc":"Remove unused variable \"DocumentLink\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ProjectPolicy' is defined but never used.","line":3,"column":64,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":77,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ProjectPolicy"},"fix":{"range":[162,177],"text":""},"desc":"Remove unused variable \"ProjectPolicy\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ProjectInfo' is defined but never used.","line":3,"column":79,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":90,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ProjectInfo"},"fix":{"range":[177,190],"text":""},"desc":"Remove unused variable \"ProjectInfo\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BudgetEntry' is defined but never used.","line":3,"column":92,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":103,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"BudgetEntry"},"fix":{"range":[190,203],"text":""},"desc":"Remove unused variable \"BudgetEntry\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ActivityEntry' is defined but never used.","line":3,"column":105,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":118,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ActivityEntry"},"fix":{"range":[203,218],"text":""},"desc":"Remove unused variable \"ActivityEntry\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Risk' is defined but never used.","line":3,"column":120,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":124,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Risk"},"fix":{"range":[218,224],"text":""},"desc":"Remove unused variable \"Risk\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChangeRequest' is defined but never used.","line":3,"column":126,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":139,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChangeRequest"},"fix":{"range":[224,239],"text":""},"desc":"Remove unused variable \"ChangeRequest\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ActionItem' is defined but never used.","line":3,"column":141,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":151,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ActionItem"},"fix":{"range":[239,251],"text":""},"desc":"Remove unused variable \"ActionItem\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Decision' is defined but never used.","line":3,"column":153,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":161,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Decision"},"fix":{"range":[251,261],"text":""},"desc":"Remove unused variable \"Decision\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Meeting' is defined but never used.","line":3,"column":163,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":170,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Meeting"},"fix":{"range":[261,270],"text":""},"desc":"Remove unused variable \"Meeting\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Communication' is defined but never used.","line":3,"column":172,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":185,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Communication"},"fix":{"range":[270,285],"text":""},"desc":"Remove unused variable \"Communication\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Milestone' is defined but never used.","line":3,"column":187,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":196,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Milestone"},"fix":{"range":[285,296],"text":""},"desc":"Remove unused variable \"Milestone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Deployment' is defined but never used.","line":3,"column":198,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":208,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Deployment"},"fix":{"range":[296,308],"text":""},"desc":"Remove unused variable \"Deployment\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Vendor' is defined but never used.","line":3,"column":210,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":216,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Vendor"},"fix":{"range":[308,316],"text":""},"desc":"Remove unused variable \"Vendor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Procurement' is defined but never used.","line":3,"column":218,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":229,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Procurement"},"fix":{"range":[316,329],"text":""},"desc":"Remove unused variable \"Procurement\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Asset' is defined but never used.","line":3,"column":231,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":236,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Asset"},"fix":{"range":[329,336],"text":""},"desc":"Remove unused variable \"Asset\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SystemRegister' is defined but never used.","line":3,"column":238,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":252,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SystemRegister"},"fix":{"range":[336,352],"text":""},"desc":"Remove unused variable \"SystemRegister\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SiteLog' is defined but never used.","line":3,"column":254,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":261,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SiteLog"},"fix":{"range":[352,361],"text":""},"desc":"Remove unused variable \"SiteLog\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":260,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":260,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12362,12365],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12362,12365],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":334,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16482,16485],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16482,16485],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":19,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\r\nimport { persist, createJSONStorage } from 'zustand/middleware';\r\nimport { AppState, Project, Task, Issue, Member, DocumentLink, ProjectPolicy, ProjectInfo, BudgetEntry, ActivityEntry, Risk, ChangeRequest, ActionItem, Decision, Meeting, Communication, Milestone, Deployment, Vendor, Procurement, Asset, SystemRegister, SiteLog, AppNotification } from '@/types';\r\nimport { getInitialTasks, getDefaultPolicies } from '@/lib/templates';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { generateId } from '@/lib/utils';\r\n\r\n\r\n// ‚îÄ‚îÄ‚îÄ Default Project ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\nconst DEFAULT_PROJECT: Project = {\r\n    id: 'proj-1',\r\n    info: {\r\n        name: 'AGS Project',\r\n        description: '',\r\n        client: '',\r\n        startDate: '2026-01-20',\r\n        endDate: '2026-03-31',\r\n        manager: '',\r\n    },\r\n    tasks: getInitialTasks('2026-01-20'),\r\n    issues: [],\r\n    members: [],\r\n    documents: [],\r\n    policies: getDefaultPolicies(),\r\n    budget: {\r\n        contractAmount: 0,\r\n        entries: [],\r\n    },\r\n    activities: [],\r\n    // New collections\r\n    risks: [],\r\n    changeRequests: [],\r\n    actionItems: [],\r\n    decisions: [],\r\n    meetings: [],\r\n    communications: [],\r\n    milestones: [],\r\n    deployments: [],\r\n    vendors: [],\r\n    procurements: [],\r\n    assets: [],\r\n    systems: [],\r\n    siteLogs: [],\r\n    notifications: [],\r\n};\r\n\r\n// ‚îÄ‚îÄ‚îÄ Helper: update active project ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\nconst updateActiveProject = (\r\n    projects: Project[],\r\n    activeId: string,\r\n    updater: (p: Project) => Partial<Project>\r\n): Project[] =>\r\n    projects.map((p) => (p.id === activeId ? { ...p, ...updater(p) } : p));\r\n\r\n// ‚îÄ‚îÄ‚îÄ Generic CRUD helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\nfunction addToCollection<T>(collection: T[], item: T): T[] {\r\n    return [...collection, item];\r\n}\r\nfunction updateInCollection<T extends { id: string }>(collection: T[], id: string, updates: Partial<T>): T[] {\r\n    return collection.map((item) => (item.id === id ? { ...item, ...updates } : item));\r\n}\r\nfunction deleteFromCollection<T extends { id: string }>(collection: T[], id: string): T[] {\r\n    return collection.filter((item) => item.id !== id);\r\n}\r\n\r\n// ‚îÄ‚îÄ‚îÄ Store ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\nexport const useStore = create<AppState>()(\r\n    persist(\r\n        (set, get) => ({\r\n            projects: [DEFAULT_PROJECT],\r\n            activeProjectId: 'proj-1',\r\n\r\n            // ‚îÄ‚îÄ Supabase Sync ‚îÄ‚îÄ\r\n            fetchSupabaseData: async () => {\r\n                try {\r\n                    // Fetch projects, tasks, issues concurrently for MVP\r\n                    const [resProj, resTasks, resIssues] = await Promise.all([\r\n                        supabase.from('projects').select('*'),\r\n                        supabase.from('tasks').select('*'),\r\n                        supabase.from('issues').select('*')\r\n                    ]);\r\n\r\n                    if (resProj.data && resProj.data.length > 0) {\r\n                        set((state) => {\r\n                            const newProjects = [...state.projects];\r\n                            // Merge database projects\r\n                            resProj.data?.forEach(dbProj => {\r\n                                const localIndex = newProjects.findIndex(p => p.id === dbProj.id);\r\n                                const dbTasks = resTasks.data?.filter(t => t.project_id === dbProj.id).map(t => ({\r\n                                    id: t.id,\r\n                                    title: t.title,\r\n                                    description: t.description || '',\r\n                                    ownerId: t.owner_id || '',\r\n                                    startDate: t.start_date || '',\r\n                                    dueDate: t.due_date || '',\r\n                                    status: t.status,\r\n                                    priority: t.priority,\r\n                                    progress: t.progress || 0,\r\n                                    dependencies: t.dependencies || [],\r\n                                    tags: t.tags || [],\r\n                                    parentId: t.parent_id || '',\r\n                                    isMilestone: t.is_milestone || false,\r\n                                    workstream: t.workstream || '',\r\n                                    relatedMilestoneId: t.related_milestone_id || '',\r\n                                })) as Task[] || [];\r\n\r\n                                const dbIssues = resIssues.data?.filter(i => i.project_id === dbProj.id).map(i => ({\r\n                                    id: i.id,\r\n                                    title: i.title,\r\n                                    description: i.description || '',\r\n                                    severity: i.severity,\r\n                                    ownerId: i.owner_id || '',\r\n                                    dueDate: i.due_date || '',\r\n                                    status: i.status,\r\n                                    relatedTaskId: i.related_task_id || '',\r\n                                    relatedReleaseId: i.related_release_id || '',\r\n                                    createdAt: i.created_at || '',\r\n                                })) as Issue[] || [];\r\n\r\n                                if (localIndex >= 0) {\r\n                                    newProjects[localIndex] = {\r\n                                        ...newProjects[localIndex],\r\n                                        info: {\r\n                                            ...newProjects[localIndex].info,\r\n                                            name: dbProj.name,\r\n                                            description: dbProj.description || '',\r\n                                            client: dbProj.client || '',\r\n                                            startDate: dbProj.start_date || '',\r\n                                            endDate: dbProj.end_date || '',\r\n                                            manager: dbProj.manager || ''\r\n                                        },\r\n                                        tasks: dbTasks.length > 0 ? dbTasks : newProjects[localIndex].tasks,\r\n                                        issues: dbIssues.length > 0 ? dbIssues : newProjects[localIndex].issues,\r\n                                    };\r\n                                } else {\r\n                                    // New project from DB\r\n                                    const newP: Project = {\r\n                                        ...DEFAULT_PROJECT,\r\n                                        id: dbProj.id,\r\n                                        info: {\r\n                                            name: dbProj.name,\r\n                                            description: dbProj.description || '',\r\n                                            client: dbProj.client || '',\r\n                                            startDate: dbProj.start_date || '',\r\n                                            endDate: dbProj.end_date || '',\r\n                                            manager: dbProj.manager || '',\r\n                                        },\r\n                                        tasks: dbTasks,\r\n                                        issues: dbIssues,\r\n                                        notifications: [],\r\n                                    };\r\n                                    newProjects.push(newP);\r\n                                }\r\n                            });\r\n\r\n                            // Make sure activeProjectId isn't pointing to a non-existent project\r\n                            const activeId = newProjects.some(p => p.id === state.activeProjectId) ? state.activeProjectId : (newProjects[0]?.id || 'proj-1');\r\n\r\n                            return { projects: newProjects, activeProjectId: activeId };\r\n                        });\r\n                    }\r\n                } catch (error) {\r\n                    console.error(\"Error fetching from Supabase:\", error);\r\n                }\r\n            },\r\n\r\n            // ‚îÄ‚îÄ Project Management ‚îÄ‚îÄ\r\n            addProject: async (project) => {\r\n                set((s) => ({ projects: [...s.projects, project], activeProjectId: project.id }));\r\n                await supabase.from('projects').insert([{\r\n                    id: project.id,\r\n                    name: project.info.name,\r\n                    description: project.info.description,\r\n                    client: project.info.client,\r\n                    start_date: project.info.startDate,\r\n                    end_date: project.info.endDate,\r\n                    manager: project.info.manager,\r\n                }]);\r\n            },\r\n            switchProject: (id) => set({ activeProjectId: id }),\r\n            deleteProject: (id) =>\r\n                set((s) => {\r\n                    const remaining = s.projects.filter((p) => p.id !== id);\r\n                    if (remaining.length === 0) return s;\r\n                    return {\r\n                        projects: remaining,\r\n                        activeProjectId: s.activeProjectId === id ? remaining[0].id : s.activeProjectId,\r\n                    };\r\n                }),\r\n            updateProjectInfo: (updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        info: { ...p.info, ...updates },\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Budget ‚îÄ‚îÄ\r\n            setContractAmount: (amount) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        budget: { ...p.budget, contractAmount: amount },\r\n                    })),\r\n                })),\r\n            addBudgetEntry: (entry) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        budget: { ...p.budget, entries: [...p.budget.entries, entry] },\r\n                    })),\r\n                })),\r\n            deleteBudgetEntry: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        budget: { ...p.budget, entries: p.budget.entries.filter((e) => e.id !== id) },\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Activity ‚îÄ‚îÄ\r\n            addActivity: (entry) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        activities: [entry, ...p.activities].slice(0, 100),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Task CRUD ‚îÄ‚îÄ\r\n            addTask: async (task) => {\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        tasks: addToCollection(p.tasks, task),\r\n                    })),\r\n                }));\r\n                const state = get();\r\n                await supabase.from('tasks').insert([{\r\n                    id: task.id,\r\n                    project_id: state.activeProjectId,\r\n                    title: task.title,\r\n                    description: task.description,\r\n                    owner_id: task.ownerId,\r\n                    start_date: task.startDate,\r\n                    due_date: task.dueDate,\r\n                    status: task.status,\r\n                    priority: task.priority,\r\n                    progress: task.progress,\r\n                    dependencies: task.dependencies,\r\n                    tags: task.tags,\r\n                    parent_id: task.parentId,\r\n                    is_milestone: task.isMilestone,\r\n                    workstream: task.workstream,\r\n                    related_milestone_id: task.relatedMilestoneId,\r\n                }]);\r\n            },\r\n            updateTask: async (id, updates) => {\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        tasks: updateInCollection(p.tasks, id, updates),\r\n                    })),\r\n                }));\r\n\r\n                // Map camelCase to snake_case for Supabase\r\n                const dbUpdates: any = {};\r\n                if (updates.title !== undefined) dbUpdates.title = updates.title;\r\n                if (updates.description !== undefined) dbUpdates.description = updates.description;\r\n                if (updates.ownerId !== undefined) dbUpdates.owner_id = updates.ownerId;\r\n                if (updates.startDate !== undefined) dbUpdates.start_date = updates.startDate;\r\n                if (updates.dueDate !== undefined) dbUpdates.due_date = updates.dueDate;\r\n                if (updates.status !== undefined) dbUpdates.status = updates.status;\r\n                if (updates.priority !== undefined) dbUpdates.priority = updates.priority;\r\n                if (updates.progress !== undefined) dbUpdates.progress = updates.progress;\r\n                if (updates.dependencies !== undefined) dbUpdates.dependencies = updates.dependencies;\r\n                if (updates.tags !== undefined) dbUpdates.tags = updates.tags;\r\n                if (updates.parentId !== undefined) dbUpdates.parent_id = updates.parentId;\r\n                if (updates.isMilestone !== undefined) dbUpdates.is_milestone = updates.isMilestone;\r\n                if (updates.workstream !== undefined) dbUpdates.workstream = updates.workstream;\r\n                if (updates.relatedMilestoneId !== undefined) dbUpdates.related_milestone_id = updates.relatedMilestoneId;\r\n\r\n                if (Object.keys(dbUpdates).length > 0) {\r\n                    await supabase.from('tasks').update(dbUpdates).eq('id', id);\r\n                }\r\n            },\r\n            deleteTask: async (id) => {\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        tasks: p.tasks.filter((t) => t.id !== id && t.parentId !== id),\r\n                    })),\r\n                }));\r\n                await supabase.from('tasks').delete().eq('id', id);\r\n            },\r\n\r\n            // ‚îÄ‚îÄ Issue CRUD ‚îÄ‚îÄ\r\n            addIssue: async (issue) => {\r\n                set((s) => {\r\n                    let newNotifications = s.projects.find(p => p.id === s.activeProjectId)?.notifications || [];\r\n                    if (issue.severity === 'S1' || issue.severity === 'S2') {\r\n                        const notif: AppNotification = {\r\n                            id: generateId('notif'),\r\n                            title: 'Critical Issue Reported',\r\n                            message: `[${issue.severity}] ${issue.title}`,\r\n                            read: false,\r\n                            timestamp: new Date().toISOString(),\r\n                            type: 'alert',\r\n                            link: '/issues'\r\n                        };\r\n                        newNotifications = [notif, ...newNotifications];\r\n                    }\r\n                    return {\r\n                        projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                            issues: addToCollection(p.issues, issue),\r\n                            notifications: newNotifications,\r\n                        })),\r\n                    };\r\n                });\r\n                const state = get();\r\n                await supabase.from('issues').insert([{\r\n                    id: issue.id,\r\n                    project_id: state.activeProjectId,\r\n                    title: issue.title,\r\n                    description: issue.description,\r\n                    severity: issue.severity,\r\n                    owner_id: issue.ownerId,\r\n                    due_date: issue.dueDate,\r\n                    status: issue.status,\r\n                    related_task_id: issue.relatedTaskId,\r\n                    related_release_id: issue.relatedReleaseId,\r\n                    created_at: issue.createdAt,\r\n                }]);\r\n            },\r\n            updateIssue: async (id, updates) => {\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        issues: updateInCollection(p.issues, id, updates),\r\n                    })),\r\n                }));\r\n\r\n                const dbUpdates: any = {};\r\n                if (updates.title !== undefined) dbUpdates.title = updates.title;\r\n                if (updates.description !== undefined) dbUpdates.description = updates.description;\r\n                if (updates.severity !== undefined) dbUpdates.severity = updates.severity;\r\n                if (updates.ownerId !== undefined) dbUpdates.owner_id = updates.ownerId;\r\n                if (updates.dueDate !== undefined) dbUpdates.due_date = updates.dueDate;\r\n                if (updates.status !== undefined) dbUpdates.status = updates.status;\r\n                if (updates.relatedTaskId !== undefined) dbUpdates.related_task_id = updates.relatedTaskId;\r\n                if (updates.relatedReleaseId !== undefined) dbUpdates.related_release_id = updates.relatedReleaseId;\r\n\r\n                if (Object.keys(dbUpdates).length > 0) {\r\n                    await supabase.from('issues').update(dbUpdates).eq('id', id);\r\n                }\r\n            },\r\n            deleteIssue: async (id) => {\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        issues: deleteFromCollection(p.issues, id),\r\n                    })),\r\n                }));\r\n                await supabase.from('issues').delete().eq('id', id);\r\n            },\r\n\r\n            // ‚îÄ‚îÄ Member CRUD ‚îÄ‚îÄ\r\n            addMember: (member) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        members: addToCollection(p.members, member),\r\n                    })),\r\n                })),\r\n            updateMember: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        members: updateInCollection(p.members, id, updates),\r\n                    })),\r\n                })),\r\n            deleteMember: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        members: deleteFromCollection(p.members, id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Document CRUD ‚îÄ‚îÄ\r\n            addDocument: (doc) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        documents: addToCollection(p.documents, doc),\r\n                    })),\r\n                })),\r\n            deleteDocument: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        documents: deleteFromCollection(p.documents, id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Policy CRUD ‚îÄ‚îÄ\r\n            addPolicy: (policy) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        policies: addToCollection(p.policies, policy),\r\n                    })),\r\n                })),\r\n            updatePolicy: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        policies: updateInCollection(p.policies, id, updates),\r\n                    })),\r\n                })),\r\n            deletePolicy: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        policies: deleteFromCollection(p.policies, id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\r\n            // ‚îÄ‚îÄ NEW ENTITY CRUD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n            // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\r\n\r\n            addRisk: (risk) =>\r\n                set((s) => {\r\n                    let newNotifications = s.projects.find(p => p.id === s.activeProjectId)?.notifications || [];\r\n                    if (risk.probability === 'High' && risk.impact === 'High') {\r\n                        const notif: AppNotification = {\r\n                            id: generateId('notif'),\r\n                            title: 'High Risk Identified',\r\n                            message: `Critical risk added: ${risk.title}`,\r\n                            read: false,\r\n                            timestamp: new Date().toISOString(),\r\n                            type: 'warning',\r\n                            link: '/issues'\r\n                        };\r\n                        newNotifications = [notif, ...newNotifications];\r\n                    }\r\n                    return {\r\n                        projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                            risks: addToCollection(p.risks || [], risk),\r\n                            notifications: newNotifications\r\n                        })),\r\n                    };\r\n                }),\r\n            updateRisk: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        risks: updateInCollection(p.risks || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteRisk: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        risks: deleteFromCollection(p.risks || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Change Request CRUD ‚îÄ‚îÄ\r\n            addChangeRequest: (cr) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        changeRequests: addToCollection(p.changeRequests || [], cr),\r\n                    })),\r\n                })),\r\n            updateChangeRequest: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        changeRequests: updateInCollection(p.changeRequests || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteChangeRequest: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        changeRequests: deleteFromCollection(p.changeRequests || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Action Item CRUD ‚îÄ‚îÄ\r\n            addActionItem: (item) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        actionItems: addToCollection(p.actionItems || [], item),\r\n                    })),\r\n                })),\r\n            updateActionItem: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        actionItems: updateInCollection(p.actionItems || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteActionItem: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        actionItems: deleteFromCollection(p.actionItems || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Decision CRUD ‚îÄ‚îÄ\r\n            addDecision: (decision) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        decisions: addToCollection(p.decisions || [], decision),\r\n                    })),\r\n                })),\r\n            updateDecision: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        decisions: updateInCollection(p.decisions || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteDecision: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        decisions: deleteFromCollection(p.decisions || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Meeting CRUD ‚îÄ‚îÄ\r\n            addMeeting: (meeting) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        meetings: addToCollection(p.meetings || [], meeting),\r\n                    })),\r\n                })),\r\n            updateMeeting: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        meetings: updateInCollection(p.meetings || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteMeeting: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        meetings: deleteFromCollection(p.meetings || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Communication CRUD ‚îÄ‚îÄ\r\n            addCommunication: (comm) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        communications: addToCollection(p.communications || [], comm),\r\n                    })),\r\n                })),\r\n            updateCommunication: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        communications: updateInCollection(p.communications || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteCommunication: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        communications: deleteFromCollection(p.communications || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Milestone CRUD ‚îÄ‚îÄ\r\n            addMilestone: (milestone) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        milestones: addToCollection(p.milestones || [], milestone),\r\n                    })),\r\n                })),\r\n            updateMilestone: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        milestones: updateInCollection(p.milestones || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteMilestone: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        milestones: deleteFromCollection(p.milestones || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Deployment CRUD ‚îÄ‚îÄ\r\n            addDeployment: (deployment) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        deployments: addToCollection(p.deployments || [], deployment),\r\n                    })),\r\n                })),\r\n            updateDeployment: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        deployments: updateInCollection(p.deployments || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteDeployment: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        deployments: deleteFromCollection(p.deployments || [], id),\r\n                    })),\r\n                })),\r\n            // ‚îÄ‚îÄ Vendor CRUD ‚îÄ‚îÄ\r\n            addVendor: (vendor) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        vendors: addToCollection(p.vendors || [], vendor),\r\n                    })),\r\n                })),\r\n            updateVendor: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        vendors: updateInCollection(p.vendors || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteVendor: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        vendors: deleteFromCollection(p.vendors || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Procurement CRUD ‚îÄ‚îÄ\r\n            addProcurement: (proc) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        procurements: addToCollection(p.procurements || [], proc),\r\n                    })),\r\n                })),\r\n            updateProcurement: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        procurements: updateInCollection(p.procurements || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteProcurement: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        procurements: deleteFromCollection(p.procurements || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Asset CRUD ‚îÄ‚îÄ\r\n            addAsset: (asset) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        assets: addToCollection(p.assets || [], asset),\r\n                    })),\r\n                })),\r\n            updateAsset: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        assets: updateInCollection(p.assets || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteAsset: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        assets: deleteFromCollection(p.assets || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ System Register CRUD ‚îÄ‚îÄ\r\n            addSystem: (system) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        systems: addToCollection(p.systems || [], system),\r\n                    })),\r\n                })),\r\n            updateSystem: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        systems: updateInCollection(p.systems || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteSystem: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        systems: deleteFromCollection(p.systems || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Site Log CRUD ‚îÄ‚îÄ\r\n            addSiteLog: (log) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        siteLogs: addToCollection(p.siteLogs || [], log),\r\n                    })),\r\n                })),\r\n            updateSiteLog: (id, updates) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        siteLogs: updateInCollection(p.siteLogs || [], id, updates),\r\n                    })),\r\n                })),\r\n            deleteSiteLog: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        siteLogs: deleteFromCollection(p.siteLogs || [], id),\r\n                    })),\r\n                })),\r\n\r\n            // ‚îÄ‚îÄ Notifications CRUD ‚îÄ‚îÄ\r\n            addNotification: (notification) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        notifications: [notification, ...(p.notifications || [])],\r\n                    })),\r\n                })),\r\n            markNotificationAsRead: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        notifications: (p.notifications || []).map(n => n.id === id ? { ...n, read: true } : n),\r\n                    })),\r\n                })),\r\n            markAllNotificationsAsRead: () =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        notifications: (p.notifications || []).map(n => ({ ...n, read: true })),\r\n                    })),\r\n                })),\r\n            deleteNotification: (id) =>\r\n                set((s) => ({\r\n                    projects: updateActiveProject(s.projects, s.activeProjectId, (p) => ({\r\n                        notifications: deleteFromCollection(p.notifications || [], id),\r\n                    })),\r\n                })),\r\n        }),\r\n        {\r\n            name: 'ags-project-hub-v5',\r\n            storage: createJSONStorage(() => localStorage),\r\n        }\r\n    )\r\n);\r\n\r\n// ‚îÄ‚îÄ‚îÄ Convenience Selectors (hook-safe) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\nexport const useActiveProject = () =>\r\n    useStore((s) => s.projects.find((p) => p.id === s.activeProjectId));\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\F1324\\Desktop\\Antigrativiy\\project-hub-ai\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]